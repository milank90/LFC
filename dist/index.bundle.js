/*! For license information please see index.bundle.js.LICENSE.txt */
(()=>{"use strict";var t={376:(t,e,n)=>{function r(t,e,n){var r=document.getElementById("fighterGrid"),i=Math.ceil(t.length/n);function o(e){r.innerHTML="";var i=(e-1)*n,o=i+n;t.slice(i,o).forEach((function(t){var e=document.createElement("div");e.classList.add("fighter-card");var n=t.img1;if(n&&null!==n.match(/\.(jpeg|jpg|gif|png)$/)){var i=document.createElement("img");i.src=n,i.alt="Fighter Image",i.classList.add("fighter-image"),e.appendChild(i)}var o=document.createElement("p");o.textContent=t.name,e.appendChild(o);var a=document.createElement("table");a.classList.add("fighter-table");var u=a.insertRow(0),s=a.insertRow(1),c={rank:"Rank",points:"Points",totalfights:"Fights"};Object.keys(c).forEach((function(e,n){var r=u.insertCell(n);r.textContent=c[e],r.style.border="none",r.style.textAlign="center",r.style.paddingBottom="0px";var i=s.insertCell(n);i.textContent=t[e],i.style.border="none",i.style.textAlign="center",i.style.paddingBottom="0px",1===n?(i.style.paddingRight="25px",i.style.paddingLeft="25px"):(i.style.paddingRight="0",i.style.paddingLeft="0"),i.style.paddingBottom="0px"})),a.style.margin="0 auto",e.appendChild(a);var l=document.createElement("p");l.textContent="W - L - D",l.style.marginTop="15px",l.style.marginBottom="0px",e.appendChild(l);var h=document.createElement("p");h.textContent="".concat(t.wins," - ").concat(t.losses," - ").concat(t.draws),h.style.marginTop="0px",h.style.textAlign="center",e.appendChild(h),r.appendChild(e)}))}function a(){[document.getElementById("pagination-t"),document.getElementById("pagination-b")].forEach((function(t){t.innerHTML="";var n=Math.max(1,e-Math.floor(1.5)),r=Math.min(n+3-1,i);n=Math.max(1,r-3+1);var u=document.createElement("button");u.textContent="<<",u.addEventListener("click",(function(){e>1&&(o(--e),a())})),t.appendChild(u);for(var s=function(n){var r=document.createElement("button");r.textContent=n,r.addEventListener("click",(function(){o(e=n),a()})),n===e&&(r.style.fontWeight="bold",r.style.textDecoration="underline"),t.appendChild(r)},c=n;c<=r;c++)s(c);var l=document.createElement("button");l.textContent=">>",l.addEventListener("click",(function(){e<i&&(o(++e),a())})),t.appendChild(l)}))}a(),o(e),a()}n.d(e,{y:()=>r})}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r)}}function r(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function i(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:String(n)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(e,n,r){return n=f(n),function(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(e,l()?Reflect.construct(n,r||[],f(e).constructor):n.apply(e,r))}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}function c(t){var e="function"==typeof Map?new Map:void 0;return c=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(l())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(t.bind.apply(t,r));return n&&h(i,n.prototype),i}(t,arguments,f(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),h(n,t)},c(t)}function l(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(l=function(){return!!t})()}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}var d=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},v={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,u=a?t[i+1]:0,s=i+2<t.length,c=s?t[i+2]:0,l=o>>2,h=(3&o)<<4|u>>4,f=(15&u)<<2|c>>6,d=63&c;s||(d=64,a||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(d(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{var u=t[n++],s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&u)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,u=++i<t.length?n[t.charAt(i)]:64,s=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==u||null==s)throw new p;var c=o<<2|a>>4;if(r.push(c),64!==u){var l=a<<4&240|u>>2;if(r.push(l),64!==s){var h=u<<6&192|s;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},p=function(t){function e(){var t;return o(this,e),(t=a(this,e,arguments)).name="DecodeBase64StringError",t}return s(e,t),r(e)}(c(Error)),y=function(t){return function(t){var e=d(t);return v.encodeByteArray(e,!0)}(t).replace(/\./g,"")},g=function(){try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||function(){if("undefined"!=typeof process&&void 0!==process.env){var t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0}}()||function(){if("undefined"!=typeof document){var t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}var e=t&&function(t){try{return v.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(t[1]);return e&&JSON.parse(e)}}()}catch(t){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(t))}},m=function(){var t;return null===(t=g())||void 0===t?void 0:t.config},w=function(){function t(){var e=this;o(this,t),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return r(t,[{key:"wrapCallback",value:function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}}}]),t}();function k(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function b(){try{return"object"===("undefined"==typeof indexedDB?"undefined":t(indexedDB))}catch(t){return!1}}var E=function(t){function e(t,n,r){var i;return o(this,e),(i=a(this,e,[n])).code=t,i.customData=r,i.name="FirebaseError",Object.setPrototypeOf(u(i),e.prototype),Error.captureStackTrace&&Error.captureStackTrace(u(i),_.prototype.create),i}return s(e,t),r(e)}(c(Error)),_=function(){function t(e,n,r){o(this,t),this.service=e,this.serviceName=n,this.errors=r}return r(t,[{key:"create",value:function(t){var e=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(t),r=this.errors[t],i=r?function(t,e){return t.replace(S,(function(t,n){var r=e[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,e):"Error",o="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new E(n,o,e)}}]),t}(),S=/\{\$([^}]+)}/g;function T(t,e){if(t===e)return!0;for(var n=Object.keys(t),r=Object.keys(e),i=0,o=n;i<o.length;i++){var a=o[i];if(!r.includes(a))return!1;var u=t[a],s=e[a];if(x(u)&&x(s)){if(!T(u,s))return!1}else if(u!==s)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function x(e){return null!==e&&"object"===t(e)}function I(t){return t&&t._delegate?t._delegate:t}function C(){C=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new O(r||[]);return i(a,"_invoke",{value:x(t,n,u)}),a}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",d="suspendedYield",v="executing",p="completed",y={};function g(){}function m(){}function w(){}var k={};c(k,a,(function(){return this}));var b=Object.getPrototypeOf,E=b&&b(b(N([])));E&&E!==n&&r.call(E,a)&&(k=E);var _=w.prototype=g.prototype=Object.create(k);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(i,o,a,u){var s=h(t[i],t,o);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==R(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function x(e,n,r){var i=f;return function(o,a){if(i===v)throw new Error("Generator is already running");if(i===p){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var s=I(u,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var c=h(e,n,r);if("normal"===c.type){if(i=r.done?p:d,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=p,r.method="throw",r.arg=c.arg)}}}function I(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(R(e)+" is not iterable")}return m.prototype=w,i(_,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:m,configurable:!0}),m.displayName=c(w,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,s,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(T.prototype),c(T.prototype,u,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new T(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(_),c(_,s,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;D(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function A(t){return function(t){if(Array.isArray(t))return P(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||L(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,i)}function O(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){c=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||L(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=L(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function L(t,e){if(t){if("string"==typeof t)return P(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(t,e):void 0}}function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function M(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,V(r.key),r)}}function F(t,e,n){return e&&j(t.prototype,e),n&&j(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function V(t){var e=function(t,e){if("object"!=R(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==R(e)?e:String(e)}var U=function(){function t(e,n,r){M(this,t),this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return F(t,[{key:"setInstantiationMode",value:function(t){return this.instantiationMode=t,this}},{key:"setMultipleInstances",value:function(t){return this.multipleInstances=t,this}},{key:"setServiceProps",value:function(t){return this.serviceProps=t,this}},{key:"setInstanceCreatedCallback",value:function(t){return this.onInstanceCreated=t,this}}]),t}(),B="[DEFAULT]",q=function(){function t(e,n){M(this,t),this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}var e,n;return F(t,[{key:"get",value:function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new w;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise}},{key:"getImmediate",value:function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(t){if(t.name!==this.name)throw Error("Mismatching Component ".concat(t.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:B})}catch(t){}var e,n=N(this.instancesDeferred.entries());try{for(n.s();!(e=n.n()).done;){var r=O(e.value,2),i=r[0],o=r[1],a=this.normalizeInstanceIdentifier(i);try{var u=this.getOrInitializeService({instanceIdentifier:a});o.resolve(u)}catch(t){}}}catch(t){n.e(t)}finally{n.f()}}}},{key:"clearInstance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B;this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}},{key:"delete",value:(e=C().mark((function t(){var e;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Array.from(this.instances.values()),t.next=3,Promise.all([].concat(A(e.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()}))),A(e.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))));case 3:case"end":return t.stop()}}),t,this)})),n=function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(t){D(o,r,i,a,u,"next",t)}function u(t){D(o,r,i,a,u,"throw",t)}a(void 0)}))},function(){return n.apply(this,arguments)})},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B;return this.instances.has(t)}},{key:"getOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B;return this.instancesOptions.get(t)||{}}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.options,n=void 0===e?{}:e,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,o=this.getOrInitializeService({instanceIdentifier:r,options:n}),a=N(this.instancesDeferred.entries());try{for(a.s();!(i=a.n()).done;){var u=O(i.value,2),s=u[0],c=u[1];r===this.normalizeInstanceIdentifier(s)&&c.resolve(o)}}catch(t){a.e(t)}finally{a.f()}return o}},{key:"onInit",value:function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}}},{key:"invokeOnInitCallbacks",value:function(t,e){var n=this.onInitCallbacks.get(e);if(n){var r,i=N(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;try{o(t,e)}catch(t){}}}catch(t){i.e(t)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===B?void 0:e),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null}},{key:"normalizeInstanceIdentifier",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B;return this.component?this.component.multipleInstances?t:B:t}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),t}(),z=function(){function t(e){M(this,t),this.name=e,this.providers=new Map}return F(t,[{key:"addComponent",value:function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component ".concat(t.name," has already been registered with ").concat(this.name));e.setComponent(t)}},{key:"addOrOverwriteComponent",value:function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}},{key:"getProvider",value:function(t){if(this.providers.has(t))return this.providers.get(t);var e=new q(t,this);return this.providers.set(t,e),e}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),t}();function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function K(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Q(r.key),r)}}function H(t,e,n){return(e=Q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q(t){var e=function(t,e){if("object"!=G(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=G(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==G(e)?e:String(e)}var W,X,Y=[];(X=W||(W={}))[X.DEBUG=0]="DEBUG",X[X.VERBOSE=1]="VERBOSE",X[X.INFO=2]="INFO",X[X.WARN=3]="WARN",X[X.ERROR=4]="ERROR",X[X.SILENT=5]="SILENT";var J,$,Z={debug:W.DEBUG,verbose:W.VERBOSE,info:W.INFO,warn:W.WARN,error:W.ERROR,silent:W.SILENT},tt=W.INFO,et=H(H(H(H(H({},W.DEBUG,"log"),W.VERBOSE,"log"),W.INFO,"info"),W.WARN,"warn"),W.ERROR,"error"),nt=function(t,e){if(!(e<t.logLevel)){var n=(new Date).toISOString(),r=et[e];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(e,")"));for(var i,o=arguments.length,a=new Array(o>2?o-2:0),u=2;u<o;u++)a[u-2]=arguments[u];(i=console)[r].apply(i,["[".concat(n,"]  ").concat(t.name,":")].concat(a))}},rt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this._logLevel=tt,this._logHandler=nt,this._userLogHandler=null,Y.push(this)}var e,n;return e=t,n=[{key:"logLevel",get:function(){return this._logLevel},set:function(t){if(!(t in W))throw new TypeError('Invalid value "'.concat(t,'" assigned to `logLevel`'));this._logLevel=t}},{key:"setLogLevel",value:function(t){this._logLevel="string"==typeof t?Z[t]:t}},{key:"logHandler",get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t}},{key:"debug",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,W.DEBUG].concat(e)),this._logHandler.apply(this,[this,W.DEBUG].concat(e))}},{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,W.VERBOSE].concat(e)),this._logHandler.apply(this,[this,W.VERBOSE].concat(e))}},{key:"info",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,W.INFO].concat(e)),this._logHandler.apply(this,[this,W.INFO].concat(e))}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,W.WARN].concat(e)),this._logHandler.apply(this,[this,W.WARN].concat(e))}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,W.ERROR].concat(e)),this._logHandler.apply(this,[this,W.ERROR].concat(e))}}],n&&K(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),it=function(t,e){return e.some((function(e){return t instanceof e}))},ot=new WeakMap,at=new WeakMap,ut=new WeakMap,st=new WeakMap,ct=new WeakMap,lt={get:function(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return at.get(t);if("objectStoreNames"===e)return t.objectStoreNames||ut.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ft(t[e])},set:function(t,e,n){return t[e]=n,!0},has:function(t,e){return t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t}};function ht(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?($||($=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(dt(this),n),ft(ot.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ft(e.apply(dt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=e.call.apply(e,[dt(this),t].concat(r));return ut.set(o,t.sort?t.sort():[t]),ft(o)}:(t instanceof IDBTransaction&&function(t){if(!at.has(t)){var e=new Promise((function(e,n){var r=function(){t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=function(){e(),r()},o=function(){n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)}));at.set(t,e)}}(t),it(t,J||(J=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,lt):t);var e}function ft(t){if(t instanceof IDBRequest)return e=t,(n=new Promise((function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",o)},i=function(){t(ft(e.result)),r()},o=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}))).then((function(t){t instanceof IDBCursor&&ot.set(t,e)})).catch((function(){})),ct.set(n,e),n;var e,n;if(st.has(t))return st.get(t);var r=ht(t);return r!==t&&(st.set(t,r),ct.set(r,t)),r}var dt=function(t){return ct.get(t)};function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function pt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pt(Object(n),!0).forEach((function(e){var r,i,o,a;r=t,i=e,o=n[e],a=function(t,e){if("object"!=vt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=vt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i),(i="symbol"==vt(a)?a:String(a))in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function gt(){gt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new D(r||[]);return i(a,"_invoke",{value:x(t,n,u)}),a}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",d="suspendedYield",v="executing",p="completed",y={};function g(){}function m(){}function w(){}var k={};c(k,a,(function(){return this}));var b=Object.getPrototypeOf,E=b&&b(b(O([])));E&&E!==n&&r.call(E,a)&&(k=E);var _=w.prototype=g.prototype=Object.create(k);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(i,o,a,u){var s=h(t[i],t,o);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==vt(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function x(e,n,r){var i=f;return function(o,a){if(i===v)throw new Error("Generator is already running");if(i===p){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var s=I(u,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var c=h(e,n,r);if("normal"===c.type){if(i=r.done?p:d,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=p,r.method="throw",r.arg=c.arg)}}}function I(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function D(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(vt(e)+" is not iterable")}return m.prototype=w,i(_,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:m,configurable:!0}),m.displayName=c(w,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,s,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(T.prototype),c(T.prototype,u,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new T(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(_),c(_,s,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function mt(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,i)}var wt,kt,bt,Et=["get","getKey","getAll","getAllKeys","count"],_t=["put","add","delete","clear"],St=new Map;function Tt(t,e){if(t instanceof IDBDatabase&&!(e in t)&&"string"==typeof e){if(St.get(e))return St.get(e);var n=e.replace(/FromIndex$/,""),r=e!==n,i=_t.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||Et.includes(n))){var o=function(){var t,e=(t=gt().mark((function t(e){var o,a,u,s,c,l,h=arguments;return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a=this.transaction(e,i?"readwrite":"readonly"),u=a.store,s=h.length,c=new Array(s>1?s-1:0),l=1;l<s;l++)c[l-1]=h[l];return r&&(u=u.index(c.shift())),t.next=6,Promise.all([(o=u)[n].apply(o,c),i&&a.done]);case 6:return t.abrupt("return",t.sent[0]);case 7:case"end":return t.stop()}}),t,this)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){mt(o,r,i,a,u,"next",t)}function u(t){mt(o,r,i,a,u,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}();return St.set(e,o),o}}}function xt(t){return function(t){if(Array.isArray(t))return Nt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ot(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(){It=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new D(r||[]);return i(a,"_invoke",{value:x(t,n,u)}),a}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",d="suspendedYield",v="executing",p="completed",y={};function g(){}function m(){}function w(){}var k={};c(k,a,(function(){return this}));var b=Object.getPrototypeOf,E=b&&b(b(O([])));E&&E!==n&&r.call(E,a)&&(k=E);var _=w.prototype=g.prototype=Object.create(k);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(i,o,a,u){var s=h(t[i],t,o);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Pt(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function x(e,n,r){var i=f;return function(o,a){if(i===v)throw new Error("Generator is already running");if(i===p){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var s=I(u,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var c=h(e,n,r);if("normal"===c.type){if(i=r.done?p:d,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=p,r.method="throw",r.arg=c.arg)}}}function I(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function D(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Pt(e)+" is not iterable")}return m.prototype=w,i(_,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:m,configurable:!0}),m.displayName=c(w,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,s,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(T.prototype),c(T.prototype,u,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new T(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(_),c(_,s,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function Ct(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,i)}function At(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){Ct(o,r,i,a,u,"next",t)}function u(t){Ct(o,r,i,a,u,"throw",t)}a(void 0)}))}}function Dt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Ot(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Ot(t,e){if(t){if("string"==typeof t)return Nt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nt(t,e):void 0}}function Nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Lt(t,e,n){return(e=Ft(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function Rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ft(r.key),r)}}function jt(t,e,n){return e&&Mt(t.prototype,e),n&&Mt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ft(t){var e=function(t,e){if("object"!=Pt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pt(e)?e:String(e)}lt=yt(yt({},bt=lt),{},{get:function(t,e,n){return Tt(t,e)||bt.get(t,e,n)},has:function(t,e){return!!Tt(t,e)||bt.has(t,e)}});var Vt=function(){function t(e){Rt(this,t),this.container=e}return jt(t,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return"".concat(e.library,"/").concat(e.version)}return null})).filter((function(t){return t})).join(" ")}}]),t}(),Ut="@firebase/app",Bt="0.9.27",qt=new rt("@firebase/app"),zt="[DEFAULT]",Gt=(Lt(Lt(Lt(Lt(Lt(Lt(Lt(Lt(Lt(Lt(wt={},Ut,"fire-core"),"@firebase/app-compat","fire-core-compat"),"@firebase/analytics","fire-analytics"),"@firebase/analytics-compat","fire-analytics-compat"),"@firebase/app-check","fire-app-check"),"@firebase/app-check-compat","fire-app-check-compat"),"@firebase/auth","fire-auth"),"@firebase/auth-compat","fire-auth-compat"),"@firebase/database","fire-rtdb"),"@firebase/database-compat","fire-rtdb-compat"),Lt(Lt(Lt(Lt(Lt(Lt(Lt(Lt(Lt(Lt(wt,"@firebase/functions","fire-fn"),"@firebase/functions-compat","fire-fn-compat"),"@firebase/installations","fire-iid"),"@firebase/installations-compat","fire-iid-compat"),"@firebase/messaging","fire-fcm"),"@firebase/messaging-compat","fire-fcm-compat"),"@firebase/performance","fire-perf"),"@firebase/performance-compat","fire-perf-compat"),"@firebase/remote-config","fire-rc"),"@firebase/remote-config-compat","fire-rc-compat"),Lt(Lt(Lt(Lt(Lt(Lt(wt,"@firebase/storage","fire-gcs"),"@firebase/storage-compat","fire-gcs-compat"),"@firebase/firestore","fire-fst"),"@firebase/firestore-compat","fire-fst-compat"),"fire-js","fire-js"),"firebase","fire-js-all")),Kt=new Map,Ht=new Map;function Qt(t,e){try{t.container.addComponent(e)}catch(n){qt.debug("Component ".concat(e.name," failed to register with FirebaseApp ").concat(t.name),n)}}function Wt(t){var e=t.name;if(Ht.has(e))return qt.debug("There were multiple attempts to register component ".concat(e,".")),!1;Ht.set(e,t);var n,r=Dt(Kt.values());try{for(r.s();!(n=r.n()).done;)Qt(n.value,t)}catch(t){r.e(t)}finally{r.f()}return!0}var Xt=(Lt(Lt(Lt(Lt(Lt(Lt(Lt(Lt(Lt(Lt(kt={},"no-app","No Firebase App '{$appName}' has been created - call initializeApp() first"),"bad-app-name","Illegal App name: '{$appName}"),"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),"app-deleted","Firebase App named '{$appName}' already deleted"),"no-options","Need to provide options, when not being deployed to hosting via source."),"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),"invalid-log-argument","First argument to `onLog` must be null or a function."),"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),Lt(kt,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.")),Yt=new _("app","Firebase",Xt),Jt=function(){function t(e,n,r){var i=this;Rt(this,t),this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new U("app",(function(){return i}),"PUBLIC"))}return jt(t,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(t){this._isDeleted=t}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Yt.create("app-deleted",{appName:this._name})}}]),t}();function $t(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t;"object"!==Pt(e)&&(e={name:e});var r=Object.assign({name:zt,automaticDataCollectionEnabled:!1},e),i=r.name;if("string"!=typeof i||!i)throw Yt.create("bad-app-name",{appName:String(i)});if(n||(n=m()),!n)throw Yt.create("no-options");var o=Kt.get(i);if(o){if(T(n,o.options)&&T(r,o.config))return o;throw Yt.create("duplicate-app",{appName:i})}var a,u=new z(i),s=Dt(Ht.values());try{for(s.s();!(a=s.n()).done;){var c=a.value;u.addComponent(c)}}catch(t){s.e(t)}finally{s.f()}var l=new Jt(n,r,u);return Kt.set(i,l),l}function Zt(t,e,n){var r,i=null!==(r=Gt[t])&&void 0!==r?r:t;n&&(i+="-".concat(n));var o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){var u=['Unable to register library "'.concat(i,'" with version "').concat(e,'":')];return o&&u.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),o&&a&&u.push("and"),a&&u.push('version name "'.concat(e,'" contains illegal characters (whitespace or "/")')),void qt.warn(u.join(" "))}Wt(new U("".concat(i,"-version"),(function(){return{library:i,version:e}}),"VERSION"))}var te="firebase-heartbeat-database",ee=1,ne="firebase-heartbeat-store",re=null;function ie(){return re||(re=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,o=n.blocking,a=n.terminated,u=indexedDB.open(t,e),s=ft(u);return i&&u.addEventListener("upgradeneeded",(function(t){i(ft(u.result),t.oldVersion,t.newVersion,ft(u.transaction),t)})),r&&u.addEventListener("blocked",(function(t){return r(t.oldVersion,t.newVersion,t)})),s.then((function(t){a&&t.addEventListener("close",(function(){return a()})),o&&t.addEventListener("versionchange",(function(t){return o(t.oldVersion,t.newVersion,t)}))})).catch((function(){})),s}(te,ee,{upgrade:function(t,e){if(0===e)try{t.createObjectStore(ne)}catch(t){console.warn(t)}}}).catch((function(t){throw Yt.create("idb-open",{originalErrorMessage:t.message})}))),re}function oe(t){return ae.apply(this,arguments)}function ae(){return ae=At(It().mark((function t(e){var n,r,i,o;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ie();case 3:return n=t.sent,r=n.transaction(ne),t.next=7,r.objectStore(ne).get(ce(e));case 7:return i=t.sent,t.next=10,r.done;case 10:return t.abrupt("return",i);case 13:t.prev=13,t.t0=t.catch(0),t.t0 instanceof E?qt.warn(t.t0.message):(o=Yt.create("idb-get",{originalErrorMessage:null===t.t0||void 0===t.t0?void 0:t.t0.message}),qt.warn(o.message));case 16:case"end":return t.stop()}}),t,null,[[0,13]])}))),ae.apply(this,arguments)}function ue(t,e){return se.apply(this,arguments)}function se(){return se=At(It().mark((function t(e,n){var r,i,o,a;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ie();case 3:return r=t.sent,i=r.transaction(ne,"readwrite"),o=i.objectStore(ne),t.next=8,o.put(n,ce(e));case 8:return t.next=10,i.done;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),t.t0 instanceof E?qt.warn(t.t0.message):(a=Yt.create("idb-set",{originalErrorMessage:null===t.t0||void 0===t.t0?void 0:t.t0.message}),qt.warn(a.message));case 15:case"end":return t.stop()}}),t,null,[[0,12]])}))),se.apply(this,arguments)}function ce(t){return"".concat(t.name,"!").concat(t.options.appId)}var le=function(){function t(e){var n=this;Rt(this,t),this.container=e,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new de(r),this._heartbeatsCachePromise=this._storage.read().then((function(t){return n._heartbeatsCache=t,t}))}var e,n;return jt(t,[{key:"triggerHeartbeat",value:(n=At(It().mark((function t(){var e,n,r,i,o;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.container.getProvider("platform-logger").getImmediate(),i=r.getPlatformInfoString(),o=he(),null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)){t.next=9;break}return t.next=6,this._heartbeatsCachePromise;case 6:if(this._heartbeatsCache=t.sent,null!=(null===(n=this._heartbeatsCache)||void 0===n?void 0:n.heartbeats)){t.next=9;break}return t.abrupt("return");case 9:if(this._heartbeatsCache.lastSentHeartbeatDate!==o&&!this._heartbeatsCache.heartbeats.some((function(t){return t.date===o}))){t.next=13;break}return t.abrupt("return");case 13:this._heartbeatsCache.heartbeats.push({date:o,agent:i});case 14:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(t){var e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),t.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 16:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"getHeartbeatsHeader",value:(e=At(It().mark((function t(){var e,n,r,i,o,a;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==this._heartbeatsCache){t.next=3;break}return t.next=3,this._heartbeatsCachePromise;case 3:if(null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&0!==this._heartbeatsCache.heartbeats.length){t.next=5;break}return t.abrupt("return","");case 5:if(n=he(),r=fe(this._heartbeatsCache.heartbeats),i=r.heartbeatsToSend,o=r.unsentEntries,a=y(JSON.stringify({version:2,heartbeats:i})),this._heartbeatsCache.lastSentHeartbeatDate=n,!(o.length>0)){t.next=15;break}return this._heartbeatsCache.heartbeats=o,t.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:t.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return t.abrupt("return",a);case 18:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}();function he(){return(new Date).toISOString().substring(0,10)}function fe(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=t.slice(),o=Dt(t);try{var a=function(){var t=e.value,o=r.find((function(e){return e.agent===t.agent}));if(o){if(o.dates.push(t.date),ve(r)>n)return o.dates.pop(),0}else if(r.push({agent:t.agent,dates:[t.date]}),ve(r)>n)return r.pop(),0;i=i.slice(1)};for(o.s();!(e=o.n()).done&&0!==a(););}catch(t){o.e(t)}finally{o.f()}return{heartbeatsToSend:r,unsentEntries:i}}var de=function(){function t(e){Rt(this,t),this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}var e,n,r,i;return jt(t,[{key:"runIndexedDBEnvironmentCheck",value:(i=At(It().mark((function t(){return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(b()){t.next=4;break}return t.abrupt("return",!1);case 4:return t.abrupt("return",new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"read",value:(r=At(It().mark((function t(){var e;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._canUseIndexedDBPromise;case 2:if(t.sent){t.next=7;break}return t.abrupt("return",{heartbeats:[]});case 7:return t.next=9,oe(this.app);case 9:if(!(null==(e=t.sent)?void 0:e.heartbeats)){t.next=14;break}return t.abrupt("return",e);case 14:return t.abrupt("return",{heartbeats:[]});case 15:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"overwrite",value:(n=At(It().mark((function t(e){var n,r;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._canUseIndexedDBPromise;case 2:if(t.sent){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,this.read();case 9:return r=t.sent,t.abrupt("return",ue(this.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats}));case 11:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"add",value:(e=At(It().mark((function t(e){var n,r;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._canUseIndexedDBPromise;case 2:if(t.sent){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,this.read();case 9:return r=t.sent,t.abrupt("return",ue(this.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat(xt(r.heartbeats),xt(e.heartbeats))}));case 11:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}();function ve(t){return y(JSON.stringify({version:2,heartbeats:t})).length}function pe(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=ye(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function ye(t,e){if(t){if("string"==typeof t)return ge(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(t,e):void 0}}function ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function me(t,e,n){return e=be(e),function(t,e){if(e&&("object"===Ie(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,we()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function we(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(we=function(){return!!t})()}function ke(){return ke="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=be(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ke.apply(this,arguments)}function be(t){return be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},be(t)}function Ee(t,e){return Ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ee(t,e)}function _e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xe(r.key),r)}}function Te(t,e,n){return e&&Se(t.prototype,e),n&&Se(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function xe(t){var e=function(t,e){if("object"!=Ie(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ie(e)?e:String(e)}function Ie(t){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ie(t)}Wt(new U("platform-logger",(function(t){return new Vt(t)}),"PRIVATE")),Wt(new U("heartbeat",(function(t){return new le(t)}),"PRIVATE")),Zt(Ut,Bt,""),Zt(Ut,Bt,"esm2017"),Zt("fire-js",""),Zt("firebase","10.8.0","app");var Ce,Ae="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},De={},Oe=Oe||{},Ne=Ae||self;function Le(t){var e=Ie(t);return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Pe(t){var e=Ie(t);return"object"==e&&null!=t||"function"==e}var Re="closure_uid_"+(1e9*Math.random()>>>0),Me=0;function je(t,e,n){return t.call.apply(t.bind,arguments)}function Fe(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Ve(t,e,n){return(Ve=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?je:Fe).apply(null,arguments)}function Ue(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Be(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function qe(){this.s=this.s,this.o=this.o}qe.prototype.s=!1,qe.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Re)&&t[Re]||(t[Re]=++Me))},qe.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var ze=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Ge(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Ke(t,e){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(Le(r)){var i=t.length||0,o=r.length||0;t.length=i+o;for(var a=0;a<o;a++)t[i+a]=r[a]}else t.push(r)}}function He(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}He.prototype.h=function(){this.defaultPrevented=!0};var Qe=function(){if(!Ne.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{var n=function(){};Ne.addEventListener("test",n,e),Ne.removeEventListener("test",n,e)}catch(n){}return t}();function We(t){return/^[\s\xa0]*$/.test(t)}function Xe(){var t=Ne.navigator;return t&&(t=t.userAgent)?t:""}function Ye(t){return-1!=Xe().indexOf(t)}function Je(t){return Je[" "](t),t}Je[" "]=function(){};var $e,Ze,tn,en=Ye("Opera"),nn=Ye("Trident")||Ye("MSIE"),rn=Ye("Edge"),on=rn||nn,an=Ye("Gecko")&&!(-1!=Xe().toLowerCase().indexOf("webkit")&&!Ye("Edge"))&&!(Ye("Trident")||Ye("MSIE"))&&!Ye("Edge"),un=-1!=Xe().toLowerCase().indexOf("webkit")&&!Ye("Edge");function sn(){var t=Ne.document;return t?t.documentMode:void 0}t:{var cn="",ln=(Ze=Xe(),an?/rv:([^\);]+)(\)|;)/.exec(Ze):rn?/Edge\/([\d\.]+)/.exec(Ze):nn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ze):un?/WebKit\/(\S+)/.exec(Ze):en?/(?:Version)[ \/]?(\S+)/.exec(Ze):void 0);if(ln&&(cn=ln?ln[1]:""),nn){var hn=sn();if(null!=hn&&hn>parseFloat(cn)){$e=String(hn);break t}}$e=cn}Ne.document&&nn?tn=sn()||parseInt($e,10)||void 0:tn=void 0;var fn=tn;function dn(t,e){if(He.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(an){t:{try{Je(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vn[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&dn.$.h.call(this)}}Be(dn,He);var vn={2:"touch",3:"pen",4:"mouse"};dn.prototype.h=function(){dn.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var pn="closure_listenable_"+(1e6*Math.random()|0),yn=0;function gn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++yn,this.fa=this.ia=!1}function mn(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function wn(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function kn(t){var e={};for(var n in t)e[n]=t[n];return e}var bn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function En(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<bn.length;o++)n=bn[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function _n(t){this.src=t,this.g={},this.h=0}function Sn(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=ze(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(mn(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Tn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.fa&&o.listener==e&&o.capture==!!n&&o.la==r)return i}return-1}_n.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var a=Tn(t,e,r,i);return-1<a?(e=t[a],n||(e.ia=!1)):((e=new gn(e,this.src,o,!!r,i)).ia=n,t.push(e)),e};var xn="closure_lm_"+(1e6*Math.random()|0),In={};function Cn(t,e,n,r,i){if(r&&r.once)return Dn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Cn(t,e[o],n,r,i);return null}return n=jn(n),t&&t[pn]?t.O(e,n,Pe(r)?!!r.capture:!!r,i):An(t,e,n,!1,r,i)}function An(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=Pe(i)?!!i.capture:!!i,u=Rn(t);if(u||(t[xn]=u=new _n(t)),(n=u.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=Pn;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Qe||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ln(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Dn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Dn(t,e[o],n,r,i);return null}return n=jn(n),t&&t[pn]?t.P(e,n,Pe(r)?!!r.capture:!!r,i):An(t,e,n,!0,r,i)}function On(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)On(t,e[o],n,r,i);else r=Pe(r)?!!r.capture:!!r,n=jn(n),t&&t[pn]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Tn(o=t.g[e],n,r,i))&&(mn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--))):t&&(t=Rn(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Tn(e,n,r,i)),(n=-1<t?e[t]:null)&&Nn(n))}function Nn(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[pn])Sn(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ln(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Rn(e))?(Sn(n,t),0==n.h&&(n.src=null,e[xn]=null)):mn(t)}}}function Ln(t){return t in In?In[t]:In[t]="on"+t}function Pn(t,e){if(t.fa)t=!0;else{e=new dn(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Nn(t),t=n.call(r,e)}return t}function Rn(t){return(t=t[xn])instanceof _n?t:null}var Mn="__closure_events_fn_"+(1e9*Math.random()>>>0);function jn(t){return"function"==typeof t?t:(t[Mn]||(t[Mn]=function(e){return t.handleEvent(e)}),t[Mn])}function Fn(){qe.call(this),this.i=new _n(this),this.S=this,this.J=null}function Vn(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,"string"==typeof e)e=new He(e,t);else if(e instanceof He)e.target=e.target||t;else{var i=e;En(e=new He(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=e.g=n[o];i=Un(a,r,!0,e)&&i}if(i=Un(a=e.g=t,r,!0,e)&&i,i=Un(a,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Un(a=e.g=n[o],r,!1,e)&&i}function Un(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.fa&&a.capture==n){var u=a.listener,s=a.la||a.src;a.ia&&Sn(t.i,a),i=!1!==u.call(s,r)&&i}}return i&&!r.defaultPrevented}Be(Fn,qe),Fn.prototype[pn]=!0,Fn.prototype.removeEventListener=function(t,e,n,r){On(this,t,e,n,r)},Fn.prototype.N=function(){if(Fn.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)mn(n[r]);delete e.g[t],e.h--}}this.J=null},Fn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Fn.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Bn=Ne.JSON.stringify,qn=function(){function t(e,n){_e(this,t),this.i=e,this.j=n,this.h=0,this.g=null}return Te(t,[{key:"get",value:function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}]),t}();function zn(){var t=Jn,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Gn=function(){function t(){_e(this,t),this.h=this.g=null}return Te(t,[{key:"add",value:function(t,e){var n=Kn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}}]),t}(),Kn=new qn((function(){return new Hn}),(function(t){return t.reset()})),Hn=function(){function t(){_e(this,t),this.next=this.g=this.h=null}return Te(t,[{key:"set",value:function(t,e){this.h=t,this.g=e,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),t}();function Qn(t){var e=1;t=t.split(":");for(var n=[];0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Wn(t){Ne.setTimeout((function(){throw t}),0)}var Xn,Yn=!1,Jn=new Gn,$n=function(){var t=Ne.Promise.resolve(void 0);Xn=function(){t.then(Zn)}},Zn=function(){for(var t;t=zn();){try{t.h.call(t.g)}catch(t){Wn(t)}var e=Kn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Yn=!1};function tr(t,e){Fn.call(this),this.h=t||1,this.g=e||Ne,this.j=Ve(this.qb,this),this.l=Date.now()}function er(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function nr(t,e,n){if("function"==typeof t)n&&(t=Ve(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Ve(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ne.setTimeout(t,e||0)}function rr(t){t.g=nr((function(){t.g=null,t.i&&(t.i=!1,rr(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}Be(tr,Fn),(Ce=tr.prototype).ga=!1,Ce.T=null,Ce.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Vn(this,"tick"),this.ga&&(er(this),this.start()))}},Ce.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ce.N=function(){tr.$.N.call(this),er(this),delete this.g};var ir=function(t){function e(t,n){var r;return _e(this,e),(r=me(this,e)).m=t,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ee(t,e)}(e,t),Te(e,[{key:"l",value:function(t){this.h=arguments,this.g?this.i=!0:rr(this)}},{key:"N",value:function(){ke(be(e.prototype),"N",this).call(this),this.g&&(Ne.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),e}(qe);function or(t){qe.call(this),this.h=t,this.g={}}Be(or,qe);var ar=[];function ur(t,e,n,r){Array.isArray(n)||(n&&(ar[0]=n.toString()),n=ar);for(var i=0;i<n.length;i++){var o=Cn(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function sr(t){wn(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Nn(t)}),t),t.g={}}function cr(){this.g=!0}function lr(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return Bn(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}or.prototype.N=function(){or.$.N.call(this),sr(this)},or.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},cr.prototype.Ea=function(){this.g=!1},cr.prototype.info=function(){};var hr={},fr=null;function dr(){return fr=fr||new Fn}function vr(t){He.call(this,hr.Ta,t)}function pr(t){var e=dr();Vn(e,new vr(e))}function yr(t,e){He.call(this,hr.STAT_EVENT,t),this.stat=e}function gr(t){var e=dr();Vn(e,new yr(e,t))}function mr(t,e){He.call(this,hr.Ua,t),this.size=e}function wr(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Ne.setTimeout((function(){t()}),e)}hr.Ta="serverreachability",Be(vr,He),hr.STAT_EVENT="statevent",Be(yr,He),hr.Ua="timingevent",Be(mr,He);var kr={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},br={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Er(){}function _r(t){return t.h||(t.h=t.i())}function Sr(){}Er.prototype.h=null;var Tr,xr={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Ir(){He.call(this,"d")}function Cr(){He.call(this,"c")}function Ar(){}function Dr(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new or(this),this.P=Nr,t=on?125:void 0,this.V=new tr(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Or}function Or(){this.i=null,this.g="",this.h=!1}Be(Ir,He),Be(Cr,He),Be(Ar,Er),Ar.prototype.g=function(){return new XMLHttpRequest},Ar.prototype.i=function(){return{}},Tr=new Ar;var Nr=45e3,Lr={},Pr={};function Rr(t,e,n){t.L=1,t.A=ti(Xr(e)),t.u=n,t.S=!0,Mr(t,null)}function Mr(t,e){t.G=Date.now(),Ur(t),t.B=Xr(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),di(n.i,"t",r),t.o=0,n=t.l.J,t.h=new Or,t.g=vo(t.l,n?e:null,!t.u),0<t.O&&(t.M=new ir(Ve(t.Pa,t,t.g),t.O)),ur(t.U,t.g,"readystatechange",t.nb),e=t.I?kn(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),pr(),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var a="",u=o.split("&"),s=0;s<u.length;s++){var c=u[s].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");a=2<=h.length&&"type"==h[1]?a+(l+"=")+c+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function jr(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function Fr(t,e,n){for(var r,i=!0;!t.J&&t.o<n.length;){if((r=Vr(t,n))==Pr){4==e&&(t.s=4,gr(14),i=!1),lr(t.j,t.m,null,"[Incomplete Response]");break}if(r==Lr){t.s=4,gr(15),lr(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}lr(t.j,t.m,r,null),Kr(t,r)}jr(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,gr(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),oo(e),e.M=!0,gr(11))):(lr(t.j,t.m,n,"[Invalid Chunked Response]"),Gr(t),zr(t))}function Vr(t,e){var n=t.o,r=e.indexOf("\n",n);return-1==r?Pr:(n=Number(e.substring(n,r)),isNaN(n)?Lr:(r+=1)+n>e.length?Pr:(e=e.slice(r,r+n),t.o=r+n,e))}function Ur(t){t.Y=Date.now()+t.P,Br(t,t.P)}function Br(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=wr(Ve(t.lb,t),e)}function qr(t){t.C&&(Ne.clearTimeout(t.C),t.C=null)}function zr(t){0==t.l.H||t.J||so(t.l,t)}function Gr(t){qr(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,er(t.V),sr(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Kr(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||ki(n.i,t)))if(!t.K&&ki(n.i,t)&&3==n.H){try{var r=n.Ja.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;uo(n),Ji(n)}io(n),gr(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=wr(Ve(n.ib,n),6e3));if(1>=wi(n.i)&&n.oa){try{n.oa()}catch(o){}n.oa=void 0}}else lo(n,11)}else if((t.K||n.g==t)&&uo(n),!We(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.V=o[0],o=o[1],2==n.H)if("c"==o[0]){n.K=o[1],n.pa=o[2];var a=o[3];null!=a&&(n.ra=a,n.l.info("VER="+n.ra));var u=o[4];null!=u&&(n.Ga=u,n.l.info("SVER="+n.Ga));var s=o[5];null!=s&&"number"==typeof s&&0<s&&(r=1.5*s,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(bi(h,h.h),h.h=null))}if(r.F){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.Da=f,Zr(r.I,r.F,f))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var d=t;if((r=n).wa=fo(r,r.J?r.pa:null,r.Y),d.K){Ei(r.i,d);var v=d,p=r.L;p&&v.setTimeout(p),v.C&&(qr(v),Ur(v)),r.g=d}else ro(r);0<n.j.length&&Zi(n)}else"stop"!=o[0]&&"close"!=o[0]||lo(n,7);else 3==n.H&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?lo(n,7):Yi(n):"noop"!=o[0]&&n.h&&n.h.Aa(o),n.A=0)}pr()}catch(o){}}function Hr(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Le(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Le(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}}(t),r=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Le(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(Ce=Dr.prototype).setTimeout=function(t){this.P=t},Ce.nb=function(t){t=t.target;var e=this.M;e&&3==Gi(t)?e.l():this.Pa(t)},Ce.Pa=function(t){try{if(t==this.g)t:{var e=Gi(this.g),n=this.g.Ia();if(this.g.da(),!(3>e)&&(3!=e||on||this.g&&(this.h.h||this.g.ja()||Ki(this.g)))){this.J||4!=e||7==n||pr(),qr(this);var r=this.g.da();this.ca=r;e:if(jr(this)){var i=Ki(this.g);t="";var o=i.length,a=4==Gi(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Gr(this),zr(this);var u="";break e}this.h.i=new Ne.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,t+=this.h.i.decode(i[n],{stream:a&&n==o-1});i.length=0,this.h.g+=t,this.o=0,u=this.h.g}else u=this.g.ja();if(this.i=200==r,function(t,e,n,r,i,o,a){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a}))}(this.j,this.v,this.B,this.m,this.W,e,r),this.i){if(this.aa&&!this.K){e:{if(this.g){var s,c=this.g;if((s=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!We(s)){var l=s;break e}}l=null}if(!(r=l)){this.i=!1,this.s=3,gr(12),Gr(this),zr(this);break t}lr(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Kr(this,r)}this.S?(Fr(this,e,u),on&&this.i&&3==e&&(ur(this.U,this.V,"tick",this.mb),this.V.start())):(lr(this.j,this.m,u,null),Kr(this,u)),4==e&&Gr(this),this.i&&!this.J&&(4==e?so(this.l,this):(this.i=!1,Ur(this)))}else(function(t){var e={};t=(t.g&&2<=Gi(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(var n=0;n<t.length;n++)if(!We(t[n])){var r=Qn(t[n]),i=r[0];if("string"==typeof(r=r[1])){r=r.trim();var o=e[i]||[];e[i]=o,o.push(r)}}!function(t,e){for(var n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==r&&0<u.indexOf("Unknown SID")?(this.s=3,gr(12)):(this.s=0,gr(13)),Gr(this),zr(this)}}}catch(e){}},Ce.mb=function(){if(this.g){var t=Gi(this.g),e=this.g.ja();this.o<e.length&&(qr(this),Fr(this,t,e),this.i&&4!=t&&Ur(this))}},Ce.cancel=function(){this.J=!0,Gr(this)},Ce.lb=function(){this.C=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(pr(),gr(17)),Gr(this),this.s=2,zr(this)):Br(this,this.Y-t)};var Qr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wr(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Wr){this.h=t.h,Yr(this,t.j),this.s=t.s,this.g=t.g,Jr(this,t.m),this.l=t.l;var e=t.i,n=new ci;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),$r(this,n),this.o=t.o}else t&&(e=String(t).match(Qr))?(this.h=!1,Yr(this,e[1]||"",!0),this.s=ei(e[2]||""),this.g=ei(e[3]||"",!0),Jr(this,e[4]),this.l=ei(e[5]||"",!0),$r(this,e[6]||"",!0),this.o=ei(e[7]||"")):(this.h=!1,this.i=new ci(null,this.h))}function Xr(t){return new Wr(t)}function Yr(t,e,n){t.j=n?ei(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Jr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function $r(t,e,n){e instanceof ci?(t.i=e,function(t,e){e&&!t.j&&(li(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(hi(this,e),di(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=ni(e,ui)),t.i=new ci(e,t.h))}function Zr(t,e,n){t.i.set(e,n)}function ti(t){return Zr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function ei(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ni(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,ri),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ri(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Wr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ni(e,ii,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(ni(e,ii,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(ni(n,"/"==n.charAt(0)?ai:oi,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ni(n,si)),t.join("")};var ii=/[#\/\?@]/g,oi=/[#\?:]/g,ai=/[#\?]/g,ui=/[#\?@]/g,si=/#/g;function ci(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function li(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function hi(t,e){li(t),e=vi(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function fi(t,e){return li(t),e=vi(t,e),t.g.has(e)}function di(t,e,n){hi(t,e),0<n.length&&(t.i=null,t.g.set(vi(t,e),Ge(n)),t.h+=n.length)}function vi(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Ce=ci.prototype).add=function(t,e){li(this),this.i=null,t=vi(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Ce.forEach=function(t,e){li(this),this.g.forEach((function(n,r){n.forEach((function(n){t.call(e,n,r,this)}),this)}),this)},Ce.ta=function(){li(this);for(var t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Ce.Z=function(t){li(this);var e=[];if("string"==typeof t)fi(this,t)&&(e=e.concat(this.g.get(vi(this,t))));else{t=Array.from(this.g.values());for(var n=0;n<t.length;n++)e=e.concat(t[n])}return e},Ce.set=function(t,e){return li(this),this.i=null,fi(this,t=vi(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Ce.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},Ce.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=Array.from(this.g.keys()),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var a=i;""!==o[r]&&(a+="="+encodeURIComponent(String(o[r]))),t.push(a)}}return this.i=t.join("&")};var pi=Te((function t(e,n){_e(this,t),this.g=e,this.map=n}));function yi(t){this.l=t||gi,t=Ne.PerformanceNavigationTiming?0<(t=Ne.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Ne.g&&Ne.g.Ka&&Ne.g.Ka()&&Ne.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var gi=10;function mi(t){return!!t.h||!!t.g&&t.g.size>=t.j}function wi(t){return t.h?1:t.g?t.g.size:0}function ki(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function bi(t,e){t.g?t.g.add(e):t.h=e}function Ei(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function _i(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){var e,n=t.i,r=pe(t.g.values());try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i.F)}}catch(t){r.e(t)}finally{r.f()}return n}return Ge(t.i)}yi.prototype.cancel=function(){if(this.i=_i(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var t,e=pe(this.g.values());try{for(e.s();!(t=e.n()).done;)t.value.cancel()}catch(t){e.e(t)}finally{e.f()}this.g.clear()}};var Si=function(){function t(){_e(this,t)}return Te(t,[{key:"stringify",value:function(t){return Ne.JSON.stringify(t,void 0)}},{key:"parse",value:function(t){return Ne.JSON.parse(t,void 0)}}]),t}();function Ti(){this.g=new Si}function xi(t,e,n){var r=n||"";try{Hr(t,(function(t,n){var i=t;Pe(t)&&(i=Bn(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Ii(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Ci(t){this.l=t.ec||null,this.j=t.ob||!1}function Ai(t,e){Fn.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Di,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Be(Ci,Er),Ci.prototype.g=function(){return new Ai(this.l,this.j)},Ci.prototype.i=function(t){return function(){return t}}({}),Be(Ai,Fn);var Di=0;function Oi(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function Ni(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Li(t)}function Li(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Ce=Ai.prototype).open=function(t,e){if(this.readyState!=Di)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Li(this)},Ce.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Ne).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Ce.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ni(this)),this.readyState=Di},Ce.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Li(this)),this.g&&(this.readyState=3,Li(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Ne.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Oi(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},Ce.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ni(this):Li(this),3==this.readyState&&Oi(this)}},Ce.Za=function(t){this.g&&(this.response=this.responseText=t,Ni(this))},Ce.Ya=function(t){this.g&&(this.response=t,Ni(this))},Ce.ka=function(){this.g&&Ni(this)},Ce.setRequestHeader=function(t,e){this.v.append(t,e)},Ce.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Ce.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ai.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Pi=Ne.JSON.parse;function Ri(t){Fn.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Mi,this.L=this.M=!1}Be(Ri,Fn);var Mi="",ji=/^https?$/i,Fi=["POST","PUT"];function Vi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ui(t),qi(t)}function Ui(t){t.F||(t.F=!0,Vn(t,"complete"),Vn(t,"error"))}function Bi(t){if(t.h&&void 0!==Oe&&(!t.C[1]||4!=Gi(t)||2!=t.da()))if(t.v&&4==Gi(t))nr(t.La,0,t);else if(Vn(t,"readystatechange"),4==Gi(t)){t.h=!1;try{var e,n=t.da();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.I).match(Qr)[1]||null;!o&&Ne.self&&Ne.self.location&&(o=Ne.self.location.protocol.slice(0,-1)),i=!ji.test(o?o.toLowerCase():"")}e=i}if(e)Vn(t,"complete"),Vn(t,"success");else{t.m=6;try{var a=2<Gi(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.da()+"]",Ui(t)}}finally{qi(t)}}}function qi(t,e){if(t.g){zi(t);var n=t.g,r=t.C[0]?function(){}:null;t.g=null,t.C=null,e||Vn(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function zi(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Ne.clearTimeout(t.A),t.A=null)}function Gi(t){return t.g?t.g.readyState:0}function Ki(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Mi:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Hi(t){var e="";return wn(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Qi(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Hi(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Zr(t,e,n))}function Wi(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xi(t){this.Ga=0,this.j=[],this.l=new cr,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Wi("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Wi("baseRetryDelayMs",5e3,t),this.hb=Wi("retryDelaySeedMs",1e4,t),this.eb=Wi("forwardChannelMaxRetries",2,t),this.xa=Wi("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new yi(t&&t.concurrentRequestLimit),this.Ja=new Ti,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Yi(t){if($i(t),3==t.H){var e=t.W++,n=Xr(t.I);if(Zr(n,"SID",t.K),Zr(n,"RID",e),Zr(n,"TYPE","terminate"),eo(t,n),(e=new Dr(t,t.l,e)).L=2,e.A=ti(Xr(n)),n=!1,Ne.navigator&&Ne.navigator.sendBeacon)try{n=Ne.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&Ne.Image&&((new Image).src=e.A,n=!0),n||(e.g=vo(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Ur(e)}ho(t)}function Ji(t){t.g&&(oo(t),t.g.cancel(),t.g=null)}function $i(t){Ji(t),t.u&&(Ne.clearTimeout(t.u),t.u=null),uo(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Ne.clearTimeout(t.m),t.m=null)}function Zi(t){if(!mi(t.i)&&!t.m){t.m=!0;var e=t.Na;Xn||$n(),Yn||(Xn(),Yn=!0),Jn.add(e,t),t.C=0}}function to(t,e){var n;n=e?e.m:t.W++;var r=Xr(t.I);Zr(r,"SID",t.K),Zr(r,"RID",n),Zr(r,"AID",t.V),eo(t,r),t.o&&t.s&&Qi(r,t.o,t.s),n=new Dr(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=no(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),bi(t.i,n),Rr(n,r,e)}function eo(t,e){t.na&&wn(t.na,(function(t,n){Zr(e,n,t)})),t.h&&Hr({},(function(t,n){Zr(e,n,t)}))}function no(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Ve(t.h.Va,t.h,t):null;t:for(var i=t.j,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].g,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var u=!0,s=0;s<n;s++){var c=i[s].g,l=i[s].map;if(0>(c-=o))o=Math.max(0,i[s].g-100),u=!1;else try{xi(l,a,"req"+c+"_")}catch(t){r&&r(l)}}if(u){r=a.join("&");break t}}return t=t.j.splice(0,n),e.F=t,r}function ro(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Xn||$n(),Yn||(Xn(),Yn=!0),Jn.add(e,t),t.A=0}}function io(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=wr(Ve(t.Ma,t),co(t,t.A)),t.A++,0))}function oo(t){null!=t.B&&(Ne.clearTimeout(t.B),t.B=null)}function ao(t){t.g=new Dr(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=Xr(t.wa);Zr(e,"RID","rpc"),Zr(e,"SID",t.K),Zr(e,"AID",t.V),Zr(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Zr(e,"TO",t.qa),Zr(e,"TYPE","xmlhttp"),eo(t,e),t.o&&t.s&&Qi(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=ti(Xr(e)),n.u=null,n.S=!0,Mr(n,t)}function uo(t){null!=t.v&&(Ne.clearTimeout(t.v),t.v=null)}function so(t,e){var n=null;if(t.g==e){uo(t),oo(t),t.g=null;var r=2}else{if(!ki(t.i,e))return;n=e.F,Ei(t.i,e),r=1}if(0!=t.H)if(e.i)if(1==r){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;Vn(r=dr(),new mr(r,n)),Zi(t)}else ro(t);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==r&&function(t,e){return!(wi(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=wr(Ve(t.Na,t,e),co(t,t.C)),t.C++,0)))}(t,e)||2==r&&io(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:lo(t,5);break;case 4:lo(t,10);break;case 3:lo(t,6);break;default:lo(t,2)}}function co(t,e){var n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function lo(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var r=Ve(t.pb,t);n||(n=new Wr("//www.google.com/images/cleardot.gif"),Ne.location&&"http"==Ne.location.protocol||Yr(n,"https"),ti(n)),function(t,e){var n=new cr;if(Ne.Image){var r=new Image;r.onload=Ue(Ii,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Ue(Ii,n,r,"TestLoadImage: error",!1,e),r.onabort=Ue(Ii,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ue(Ii,n,r,"TestLoadImage: timeout",!1,e),Ne.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else gr(2);t.H=0,t.h&&t.h.za(e),ho(t),$i(t)}function ho(t){if(t.H=0,t.ma=[],t.h){var e=_i(t.i);0==e.length&&0==t.j.length||(Ke(t.ma,e),Ke(t.ma,t.j),t.i.i.length=0,Ge(t.j),t.j.length=0),t.h.ya()}}function fo(t,e,n){var r=n instanceof Wr?Xr(n):new Wr(n);if(""!=r.g)e&&(r.g=e+"."+r.g),Jr(r,r.m);else{var i=Ne.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var o=new Wr(null);r&&Yr(o,r),e&&(o.g=e),i&&Jr(o,i),n&&(o.l=n),r=o}return n=t.F,e=t.Da,n&&e&&Zr(r,n,e),Zr(r,"VER",t.ra),eo(t,r),r}function vo(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new Ri(new Ci({ob:n})):new Ri(t.va)).Oa(t.J),e}function po(){}function yo(){if(nn&&!(10<=Number(fn)))throw Error("Environmental error: no available transport.")}function go(t,e){Fn.call(this),this.g=new Xi(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!We(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!We(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new ko(this)}function mo(t){Ir.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function wo(){Cr.call(this),this.status=1}function ko(t){this.g=t}function bo(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Eo(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var o=t.g[3],a=e+(o^n&(i^o))+r[0]+3614090360&4294967295;a=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=(n=(i=(o=(e=n+(a<<7&4294967295|a>>>25))+((a=o+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^o&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(e^i&(o^e))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=e+(o^n&(i^o))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=o+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^o&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(e^i&(o^e))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=e+(o^n&(i^o))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=o+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^o&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(e^i&(o^e))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=e+(o^n&(i^o))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=o+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^o&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(e^i&(o^e))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=e+(i^o&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=o+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^n&(o^e))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(o^e&(i^o))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^o&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=o+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^n&(o^e))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(o^e&(i^o))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^o&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=o+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^n&(o^e))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(o^e&(i^o))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^o&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=o+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^n&(o^e))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(o^e&(i^o))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=e+(n^i^o)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=o+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(o^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^o^e)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=e+(n^i^o)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=o+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(o^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^o^e)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=e+(n^i^o)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=o+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(o^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^o^e)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=e+(n^i^o)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=o+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(o^e^n)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^o^e)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=e+(i^(n|~o))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=o+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(o|~n))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(o^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=e+(i^(n|~o))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=o+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(o|~n))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(o^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=e+(i^(n|~o))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=o+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(o|~n))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(o^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((o=(e=n+((a=e+(i^(n|~o))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=o+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=o+((a=i+(e^(o|~n))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+o&4294967295}function _o(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var o=0|t[i];r&&o==e||(n[i]=o,r=!1)}this.g=n}(Ce=Ri.prototype).Oa=function(t){this.M=t},Ce.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Tr.g(),this.C=this.u?_r(this.u):_r(Tr),this.g.onreadystatechange=Ve(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(u){return void Vi(this,u)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));var o,a=pe(r.keys());try{for(a.s();!(o=a.n()).done;){var u=o.value;n.set(u,r.get(u))}}catch(t){a.e(t)}finally{a.f()}}r=Array.from(n.keys()).find((function(t){return"content-type"==t.toLowerCase()})),i=Ne.FormData&&t instanceof Ne.FormData,!(0<=ze(Fi,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var s,c,l,h=pe(n);try{for(h.s();!(s=h.n()).done;){var f=(c=s.value,l=2,function(t){if(Array.isArray(t))return t}(c)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){c=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(c,l)||ye(c,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=f[0],v=f[1];this.g.setRequestHeader(d,v)}}catch(t){h.e(t)}finally{h.f()}this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{zi(this),0<this.B&&((this.L=function(t){return nn&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ve(this.ua,this)):this.A=nr(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(u){Vi(this,u)}},Ce.ua=function(){void 0!==Oe&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Vn(this,"timeout"),this.abort(8))},Ce.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Vn(this,"complete"),Vn(this,"abort"),qi(this))},Ce.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),qi(this,!0)),Ri.$.N.call(this)},Ce.La=function(){this.s||(this.G||this.v||this.l?Bi(this):this.kb())},Ce.kb=function(){Bi(this)},Ce.isActive=function(){return!!this.g},Ce.da=function(){try{return 2<Gi(this)?this.g.status:-1}catch(t){return-1}},Ce.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Ce.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pi(e)}},Ce.Ia=function(){return this.m},Ce.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ce=Xi.prototype).ra=8,Ce.H=1,Ce.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;var e=new Dr(this,this.l,t),n=this.s;if(this.U&&(n?En(n=kn(n),this.U):n=this.U),null!==this.o||this.O||(e.I=n,n=null),this.P)t:{for(var r=0,i=0;i<this.j.length;i++){var o=this.j[i];if(void 0===(o="__data__"in o.map&&"string"==typeof(o=o.map.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.j.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=no(this,e,r),Zr(i=Xr(this.I),"RID",t),Zr(i,"CVER",22),this.F&&Zr(i,"X-HTTP-Session-Id",this.F),eo(this,i),n&&(this.O?r="headers="+encodeURIComponent(String(Hi(n)))+"&"+r:this.o&&Qi(i,this.o,n)),bi(this.i,e),this.bb&&Zr(i,"TYPE","init"),this.P?(Zr(i,"$req",r),Zr(i,"SID","null"),e.aa=!0,Rr(e,i,null)):Rr(e,i,r),this.H=2}}else 3==this.H&&(t?to(this,t):0==this.j.length||mi(this.i)||to(this))},Ce.Ma=function(){if(this.u=null,ao(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=wr(Ve(this.jb,this),t)}},Ce.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,gr(10),Ji(this),ao(this))},Ce.ib=function(){null!=this.v&&(this.v=null,Ji(this),io(this),gr(19))},Ce.pb=function(t){t?(this.l.info("Successfully pinged google.com"),gr(2)):(this.l.info("Failed to ping google.com"),gr(1))},Ce.isActive=function(){return!!this.h&&this.h.isActive(this)},(Ce=po.prototype).Ba=function(){},Ce.Aa=function(){},Ce.za=function(){},Ce.ya=function(){},Ce.isActive=function(){return!0},Ce.Va=function(){},yo.prototype.g=function(t,e){return new go(t,e)},Be(go,Fn),go.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;gr(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=fo(t,null,t.Y),Zi(t)},go.prototype.close=function(){Yi(this.g)},go.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Bn(t),t=n);e.j.push(new pi(e.fb++,t)),3==e.H&&Zi(e)},go.prototype.N=function(){this.g.h=null,delete this.j,Yi(this.g),delete this.g,go.$.N.call(this)},Be(mo,Ir),Be(wo,Cr),Be(ko,po),ko.prototype.Ba=function(){Vn(this.g,"a")},ko.prototype.Aa=function(t){Vn(this.g,new mo(t))},ko.prototype.za=function(t){Vn(this.g,new wo)},ko.prototype.ya=function(){Vn(this.g,"b")},Be(bo,(function(){this.blockSize=-1})),bo.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},bo.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,o=0;o<e;){if(0==i)for(;o<=n;)Eo(this,t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(r[i++]=t.charCodeAt(o++),i==this.blockSize){Eo(this,r),i=0;break}}else for(;o<e;)if(r[i++]=t[o++],i==this.blockSize){Eo(this,r),i=0;break}}this.h=i,this.i+=e},bo.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var So={};function To(t){return-128<=t&&128>t?function(t,e){var n=So;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new _o([0|t],0>t?-1:0)}(t)}(t):new _o([0|t],0>t?-1:0)}function xo(t){if(isNaN(t)||!isFinite(t))return Co;if(0>t)return Lo(xo(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Io;return new _o(e,0)}var Io=4294967296,Co=To(0),Ao=To(1),Do=To(16777216);function Oo(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function No(t){return-1==t.h}function Lo(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new _o(n,~t.h).add(Ao)}function Po(t,e){return t.add(Lo(e))}function Ro(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Mo(t,e){this.g=t,this.h=e}function jo(t,e){if(Oo(e))throw Error("division by zero");if(Oo(t))return new Mo(Co,Co);if(No(t))return e=jo(Lo(t),e),new Mo(Lo(e.g),Lo(e.h));if(No(e))return e=jo(t,Lo(e)),new Mo(Lo(e.g),e.h);if(30<t.g.length){if(No(t)||No(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Ao,r=e;0>=r.X(t);)n=Fo(n),r=Fo(r);var i=Vo(n,1),o=Vo(r,1);for(r=Vo(r,2),n=Vo(n,2);!Oo(r);){var a=o.add(r);0>=a.X(t)&&(i=i.add(n),o=a),r=Vo(r,1),n=Vo(n,1)}return e=Po(t,i.R(e)),new Mo(i,e)}for(i=Co;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),a=(o=xo(n)).R(e);No(a)||0<a.X(t);)a=(o=xo(n-=r)).R(e);Oo(o)&&(o=Ao),i=i.add(o),t=Po(t,a)}return new Mo(i,t)}function Fo(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new _o(n,t.h)}function Vo(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],o=0;o<r;o++)i[o]=0<e?t.D(o+n)>>>e|t.D(o+n+1)<<32-e:t.D(o+n);return new _o(i,t.h)}(Ce=_o.prototype).ea=function(){if(No(this))return-Lo(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Io+r)*e,e*=Io}return t},Ce.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(Oo(this))return"0";if(No(this))return"-"+Lo(this).toString(t);for(var e=xo(Math.pow(t,6)),n=this,r="";;){var i=jo(n,e).g,o=((0<(n=Po(n,i.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(Oo(n=i))return o+r;for(;6>o.length;)o="0"+o;r=o+r}},Ce.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},Ce.X=function(t){return No(t=Po(this,t))?-1:Oo(t)?0:1},Ce.abs=function(){return No(this)?Lo(this):this},Ce.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var o=r+(65535&this.D(i))+(65535&t.D(i)),a=(o>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=a>>>16,o&=65535,a&=65535,n[i]=a<<16|o}return new _o(n,-2147483648&n[n.length-1]?-1:0)},Ce.R=function(t){if(Oo(this)||Oo(t))return Co;if(No(this))return No(t)?Lo(this).R(Lo(t)):Lo(Lo(this).R(t));if(No(t))return Lo(this.R(Lo(t)));if(0>this.X(Do)&&0>t.X(Do))return xo(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var o=this.D(r)>>>16,a=65535&this.D(r),u=t.D(i)>>>16,s=65535&t.D(i);n[2*r+2*i]+=a*s,Ro(n,2*r+2*i),n[2*r+2*i+1]+=o*s,Ro(n,2*r+2*i+1),n[2*r+2*i+1]+=a*u,Ro(n,2*r+2*i+1),n[2*r+2*i+2]+=o*u,Ro(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new _o(n,0)},Ce.gb=function(t){return jo(this,t).h},Ce.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new _o(n,this.h&t.h)},Ce.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new _o(n,this.h|t.h)},Ce.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new _o(n,this.h^t.h)},yo.prototype.createWebChannel=yo.prototype.g,go.prototype.send=go.prototype.u,go.prototype.open=go.prototype.m,go.prototype.close=go.prototype.close,kr.NO_ERROR=0,kr.TIMEOUT=8,kr.HTTP_ERROR=6,br.COMPLETE="complete",Sr.EventType=xr,xr.OPEN="a",xr.CLOSE="b",xr.ERROR="c",xr.MESSAGE="d",Fn.prototype.listen=Fn.prototype.O,Ri.prototype.listenOnce=Ri.prototype.P,Ri.prototype.getLastError=Ri.prototype.Sa,Ri.prototype.getLastErrorCode=Ri.prototype.Ia,Ri.prototype.getStatus=Ri.prototype.da,Ri.prototype.getResponseJson=Ri.prototype.Wa,Ri.prototype.getResponseText=Ri.prototype.ja,Ri.prototype.send=Ri.prototype.ha,Ri.prototype.setWithCredentials=Ri.prototype.Oa,bo.prototype.digest=bo.prototype.l,bo.prototype.reset=bo.prototype.reset,bo.prototype.update=bo.prototype.j,_o.prototype.add=_o.prototype.add,_o.prototype.multiply=_o.prototype.R,_o.prototype.modulo=_o.prototype.gb,_o.prototype.compare=_o.prototype.X,_o.prototype.toNumber=_o.prototype.ea,_o.prototype.toString=_o.prototype.toString,_o.prototype.getBits=_o.prototype.D,_o.fromNumber=xo,_o.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return Lo(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=xo(Math.pow(n,8)),i=Co,o=0;o<e.length;o+=8){var a=Math.min(8,e.length-o),u=parseInt(e.substring(o,o+a),n);8>a?(a=xo(Math.pow(n,a)),i=i.R(a).add(xo(u))):i=(i=i.R(r)).add(xo(u))}return i};var Uo=De.createWebChannelTransport=function(){return new yo},Bo=De.getStatEventTarget=function(){return dr()},qo=De.ErrorCode=kr,zo=De.EventType=br,Go=De.Event=hr,Ko=De.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Ho=(De.FetchXmlHttpFactory=Ci,De.WebChannel=Sr),Qo=De.XhrIo=Ri,Wo=De.Md5=bo,Xo=De.Integer=_o;function Yo(){return Yo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=aa(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Yo.apply(this,arguments)}function Jo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){c=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||la(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $o(t){var e="function"==typeof Map?new Map:void 0;return $o=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return Zo(t,arguments,aa(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),sa(n,t)},$o(t)}function Zo(t,e,n){if(oa())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(t.bind.apply(t,r));return n&&sa(i,n.prototype),i}function ta(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=la(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function ea(){ea=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new D(r||[]);return i(a,"_invoke",{value:x(t,n,u)}),a}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",d="suspendedYield",v="executing",p="completed",y={};function g(){}function m(){}function w(){}var k={};c(k,a,(function(){return this}));var b=Object.getPrototypeOf,E=b&&b(b(O([])));E&&E!==n&&r.call(E,a)&&(k=E);var _=w.prototype=g.prototype=Object.create(k);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(i,o,a,u){var s=h(t[i],t,o);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==fa(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function x(e,n,r){var i=f;return function(o,a){if(i===v)throw new Error("Generator is already running");if(i===p){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var s=I(u,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var c=h(e,n,r);if("normal"===c.type){if(i=r.done?p:d,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=p,r.method="throw",r.arg=c.arg)}}}function I(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function D(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(fa(e)+" is not iterable")}return m.prototype=w,i(_,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:m,configurable:!0}),m.displayName=c(w,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,s,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},S(T.prototype),c(T.prototype,u,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new T(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(_),c(_,s,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function na(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,i)}function ra(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){na(o,r,i,a,u,"next",t)}function u(t){na(o,r,i,a,u,"throw",t)}a(void 0)}))}}function ia(t,e,n){return e=aa(e),function(t,e){if(e&&("object"===fa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,oa()?Reflect.construct(e,n||[],aa(t).constructor):e.apply(t,n))}function oa(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(oa=function(){return!!t})()}function aa(t){return aa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},aa(t)}function ua(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sa(t,e)}function sa(t,e){return sa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},sa(t,e)}function ca(t){return function(t){if(Array.isArray(t))return ha(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||la(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function la(t,e){if(t){if("string"==typeof t)return ha(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ha(t,e):void 0}}function ha(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function fa(t){return fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fa(t)}function da(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function va(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ya(r.key),r)}}function pa(t,e,n){return e&&va(t.prototype,e),n&&va(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ya(t){var e=function(t,e){if("object"!=fa(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=fa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==fa(e)?e:String(e)}var ga="@firebase/firestore",ma=function(){function t(e){da(this,t),this.uid=e}return pa(t,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(t){return t.uid===this.uid}}]),t}();ma.UNAUTHENTICATED=new ma(null),ma.GOOGLE_CREDENTIALS=new ma("google-credentials-uid"),ma.FIRST_PARTY=new ma("first-party-uid"),ma.MOCK_USER=new ma("mock-user");var wa="10.8.0",ka=new rt("@firebase/firestore");function ba(){return ka.logLevel}function Ea(t){if(ka.logLevel<=W.DEBUG){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.map(Ta);ka.debug.apply(ka,["Firestore (".concat(wa,"): ").concat(t)].concat(ca(i)))}}function _a(t){if(ka.logLevel<=W.ERROR){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.map(Ta);ka.error.apply(ka,["Firestore (".concat(wa,"): ").concat(t)].concat(ca(i)))}}function Sa(t){if(ka.logLevel<=W.WARN){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.map(Ta);ka.warn.apply(ka,["Firestore (".concat(wa,"): ").concat(t)].concat(ca(i)))}}function Ta(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function xa(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",e="FIRESTORE (".concat(wa,") INTERNAL ASSERTION FAILED: ")+t;throw _a(e),new Error(e)}function Ia(t,e){t||xa()}function Ca(t,e){return t}var Aa={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Da=function(t){function e(t,n){var r;return da(this,e),(r=ia(this,e,[t,n])).code=t,r.message=n,r.toString=function(){return"".concat(r.name,": [code=").concat(r.code,"]: ").concat(r.message)},r}return ua(e,t),pa(e)}(E),Oa=pa((function t(){var e=this;da(this,t),this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))})),Na=pa((function t(e,n){da(this,t),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))})),La=function(){function t(){da(this,t)}return pa(t,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(t,e){t.enqueueRetryable((function(){return e(ma.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),t}(),Pa=function(){function t(e){da(this,t),this.token=e,this.changeListener=null}return pa(t,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),t}(),Ra=function(){function t(e){da(this,t),this.t=e,this.currentUser=ma.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return pa(t,[{key:"start",value:function(t,e){var n=this,r=this.i,i=function(t){return n.i!==r?(r=n.i,e(t)):Promise.resolve()},o=new Oa;this.o=function(){n.i++,n.currentUser=n.u(),o.resolve(),o=new Oa,t.enqueueRetryable((function(){return i(n.currentUser)}))};var a=function(){var e=o;t.enqueueRetryable(ra(ea().mark((function t(){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.promise;case 2:return t.next=4,i(n.currentUser);case 4:case"end":return t.stop()}}),t)}))))},u=function(t){Ea("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=t,n.auth.addAuthTokenListener(n.o),a()};this.t.onInit((function(t){return u(t)})),setTimeout((function(){if(!n.auth){var t=n.t.getImmediate({optional:!0});t?u(t):(Ea("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Oa)}}),0),a()}},{key:"getToken",value:function(){var t=this,e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.i!==e?(Ea("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Ia("string"==typeof n.accessToken),new Na(n.accessToken,t.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var t=this.auth&&this.auth.getUid();return Ia(null===t||"string"==typeof t),new ma(t)}}]),t}(),Ma=function(){function t(e,n,r){da(this,t),this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=ma.FIRST_PARTY,this.I=new Map}return pa(t,[{key:"T",value:function(){return this.P?this.P():null}},{key:"headers",get:function(){this.I.set("X-Goog-AuthUser",this.l);var t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}]),t}(),ja=function(){function t(e,n,r){da(this,t),this.l=e,this.h=n,this.P=r}return pa(t,[{key:"getToken",value:function(){return Promise.resolve(new Ma(this.l,this.h,this.P))}},{key:"start",value:function(t,e){t.enqueueRetryable((function(){return e(ma.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),t}(),Fa=pa((function t(e){da(this,t),this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),Va=function(){function t(e){da(this,t),this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}return pa(t,[{key:"start",value:function(t,e){var n=this,r=function(t){null!=t.error&&Ea("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(t.error.message));var r=t.token!==n.R;return n.R=t.token,Ea("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?e(t.token):Promise.resolve()};this.o=function(e){t.enqueueRetryable((function(){return r(e)}))};var i=function(t){Ea("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=t,n.appCheck.addTokenListener(n.o)};this.A.onInit((function(t){return i(t)})),setTimeout((function(){if(!n.appCheck){var t=n.A.getImmediate({optional:!0});t?i(t):Ea("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var t=this,e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((function(e){return e?(Ia("string"==typeof e.token),t.R=e.token,new Fa(e.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),t}();function Ua(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Ba=function(){function t(){da(this,t)}return pa(t,null,[{key:"newId",value:function(){for(var t=62*Math.floor(256/62),e="";e.length<20;)for(var n=Ua(40),r=0;r<n.length;++r)e.length<20&&n[r]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62));return e}}]),t}();function qa(t,e){return t<e?-1:t>e?1:0}function za(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}var Ga=function(){function t(e,n){if(da(this,t),this.seconds=e,this.nanoseconds=n,n<0)throw new Da(Aa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Da(Aa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Da(Aa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Da(Aa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return pa(t,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(t){return this.seconds===t.seconds?qa(this.nanoseconds,t.nanoseconds):qa(this.seconds,t.seconds)}},{key:"isEqual",value:function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return t.fromMillis(Date.now())}},{key:"fromDate",value:function(e){return t.fromMillis(e.getTime())}},{key:"fromMillis",value:function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))}}]),t}(),Ka=function(){function t(e){da(this,t),this.timestamp=e}return pa(t,[{key:"compareTo",value:function(t){return this.timestamp._compareTo(t.timestamp)}},{key:"isEqual",value:function(t){return this.timestamp.isEqual(t.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(e){return new t(e)}},{key:"min",value:function(){return new t(new Ga(0,0))}},{key:"max",value:function(){return new t(new Ga(253402300799,999999999))}}]),t}(),Ha=function(){function t(e,n,r){da(this,t),void 0===n?n=0:n>e.length&&xa(),void 0===r?r=e.length-n:r>e.length-n&&xa(),this.segments=e,this.offset=n,this.len=r}return pa(t,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(e){return 0===t.comparator(this,e)}},{key:"child",value:function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(t){return this.segments[this.offset+t]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}},{key:"isImmediateParentOf",value:function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}},{key:"forEach",value:function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}]),t}(),Qa=function(t){function e(){return da(this,e),ia(this,e,arguments)}return ua(e,t),pa(e,[{key:"construct",value:function(t,n,r){return new e(t,n,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"toUriEncodedString",value:function(){return this.toArray().map(encodeURIComponent).join("/")}}],[{key:"fromString",value:function(){for(var t=[],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var o=0,a=r;o<a.length;o++){var u=a[o];if(u.indexOf("//")>=0)throw new Da(Aa.INVALID_ARGUMENT,"Invalid segment (".concat(u,"). Paths must not contain // in them."));t.push.apply(t,ca(u.split("/").filter((function(t){return t.length>0}))))}return new e(t)}},{key:"emptyPath",value:function(){return new e([])}}]),e}(Ha),Wa=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xa=function(t){function e(){return da(this,e),ia(this,e,arguments)}return ua(e,t),pa(e,[{key:"construct",value:function(t,n,r){return new e(t,n,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(t){return Wa.test(t)}},{key:"keyField",value:function(){return new e(["__name__"])}},{key:"fromServerFormat",value:function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Da(Aa.INVALID_ARGUMENT,"Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));n.push(r),r=""},a=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Da(Aa.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var s=t[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new Da(Aa.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=s,i+=2}else"`"===u?(a=!a,i++):"."!==u||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new Da(Aa.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)}},{key:"emptyPath",value:function(){return new e([])}}]),e}(Ha),Ya=function(){function t(e){da(this,t),this.path=e}return pa(t,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(t){return null!==t&&0===Qa.comparator(this.path,t.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(e){return new t(Qa.fromString(e))}},{key:"fromName",value:function(e){return new t(Qa.fromString(e).popFirst(5))}},{key:"empty",value:function(){return new t(Qa.emptyPath())}},{key:"comparator",value:function(t,e){return Qa.comparator(t.path,e.path)}},{key:"isDocumentKey",value:function(t){return t.length%2==0}},{key:"fromSegments",value:function(e){return new t(new Qa(e.slice()))}}]),t}(),Ja=pa((function t(e,n,r,i){da(this,t),this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}));function $a(t){return new Za(t.readTime,t.key,-1)}Ja.UNKNOWN_ID=-1;var Za=function(){function t(e,n,r){da(this,t),this.readTime=e,this.documentKey=n,this.largestBatchId=r}return pa(t,null,[{key:"min",value:function(){return new t(Ka.min(),Ya.empty(),-1)}},{key:"max",value:function(){return new t(Ka.max(),Ya.empty(),-1)}}]),t}();function tu(t,e){var n=t.readTime.compareTo(e.readTime);return 0!==n||0!==(n=Ya.comparator(t.documentKey,e.documentKey))?n:qa(t.largestBatchId,e.largestBatchId)}var eu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",nu=function(){function t(){da(this,t),this.onCommittedListeners=[]}return pa(t,[{key:"addOnCommittedListener",value:function(t){this.onCommittedListeners.push(t)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(t){return t()}))}}]),t}();function ru(t){return iu.apply(this,arguments)}function iu(){return(iu=ra(ea().mark((function t(e){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.code===Aa.FAILED_PRECONDITION&&e.message===eu){t.next=2;break}throw e;case 2:Ea("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ou=function(){function t(e){var n=this;da(this,t),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((function(t){n.isDone=!0,n.result=t,n.nextCallback&&n.nextCallback(t)}),(function(t){n.isDone=!0,n.error=t,n.catchCallback&&n.catchCallback(t)}))}return pa(t,[{key:"catch",value:function(t){return this.next(void 0,t)}},{key:"next",value:function(e,n){var r=this;return this.callbackAttached&&xa(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))}},{key:"toPromise",value:function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))}},{key:"wrapUserFunction",value:function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}}},{key:"wrapSuccess",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)}},{key:"wrapFailure",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)}}],[{key:"resolve",value:function(e){return new t((function(t,n){t(e)}))}},{key:"reject",value:function(e){return new t((function(t,n){n(e)}))}},{key:"waitFor",value:function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))}},{key:"or",value:function(e){var n,r=t.resolve(!1),i=ta(e);try{var o=function(){var e=n.value;r=r.next((function(n){return n?t.resolve(n):e()}))};for(i.s();!(n=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}return r}},{key:"forEach",value:function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)}},{key:"mapArray",value:function(e,n){return new t((function(t,r){for(var i=e.length,o=new Array(i),a=0,u=function(){var u=s;n(e[u]).next((function(e){o[u]=e,++a===i&&t(o)}),(function(t){return r(t)}))},s=0;s<i;s++)u()}))}},{key:"doWhile",value:function(e,n){return new t((function(t,r){!function i(){!0===e()?n().next((function(){i()}),r):t()}()}))}}]),t}(),au=function(){function t(e,n){var r=this;da(this,t),this.action=e,this.transaction=n,this.aborted=!1,this.V=new Oa,this.transaction.oncomplete=function(){r.V.resolve()},this.transaction.onabort=function(){n.error?r.V.reject(new cu(e,n.error)):r.V.resolve()},this.transaction.onerror=function(t){var n=vu(t.target.error);r.V.reject(new cu(e,n))}}return pa(t,[{key:"m",get:function(){return this.V.promise}},{key:"abort",value:function(t){t&&this.V.reject(t),this.aborted||(Ea("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"g",value:function(){var t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}},{key:"store",value:function(t){var e=this.transaction.objectStore(t);return new hu(e)}}],[{key:"open",value:function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new cu(n,e)}}}]),t}(),uu=function(){function t(e,n,r){da(this,t),this.name=e,this.version=n,this.p=r,12.2===t.S(k())&&_a("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}var e,n;return pa(t,[{key:"O",value:(n=ra(ea().mark((function t(e){var n=this;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=this.db,t.t0){t.next=6;break}return Ea("SimpleDb","Opening database:",this.name),t.next=5,new Promise((function(t,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(e){var n=e.target.result;t(n)},i.onblocked=function(){r(new cu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var n=t.target.error;"VersionError"===n.name?r(new Da(Aa.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new Da(Aa.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new cu(e,n))},i.onupgradeneeded=function(t){Ea("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.p.N(e,i.transaction,t.oldVersion,n.version).next((function(){Ea("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}));case 5:this.db=t.sent;case 6:return this.B&&(this.db.onversionchange=function(t){return n.B(t)}),t.abrupt("return",this.db);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"L",value:function(t){this.B=t,this.db&&(this.db.onversionchange=function(e){return t(e)})}},{key:"runTransaction",value:(e=ra(ea().mark((function t(e,n,r,i){var o,a,u,s,c=this;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o="readonly"===n,a=0,u=ea().mark((function t(){var n,u,s,l;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return++a,t.prev=1,t.next=4,c.O(e);case 4:return c.db=t.sent,n=au.open(c.db,e,o?"readonly":"readwrite",r),u=i(n).next((function(t){return n.g(),t})).catch((function(t){return n.abort(t),ou.reject(t)})).toPromise(),u.catch((function(){})),t.next=9,n.m;case 9:return t.t0=u,t.abrupt("return",{v:t.t0});case 13:if(t.prev=13,t.t1=t.catch(1),s=t.t1,l="FirebaseError"!==s.name&&a<3,Ea("SimpleDb","Transaction failed with error:",s.message,"Retrying:",l),c.close(),l){t.next=18;break}return t.abrupt("return",{v:Promise.reject(s)});case 18:case"end":return t.stop()}}),t,null,[[1,13]])}));case 3:return t.delegateYield(u(),"t0",4);case 4:if(!(s=t.t0)){t.next=7;break}return t.abrupt("return",s.v);case 7:t.next=3;break;case 9:case"end":return t.stop()}}),t)}))),function(t,n,r,i){return e.apply(this,arguments)})},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(t){return Ea("SimpleDb","Removing database:",t),fu(window.indexedDB.deleteDatabase(t)).toPromise()}},{key:"D",value:function(){if(!b())return!1;if(t.C())return!0;var e=k(),n=t.S(e),r=0<n&&n<10,i=t.v(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}},{key:"C",value:function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}},{key:"M",value:function(t,e){return t.store(e)}},{key:"S",value:function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"v",value:function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),t}(),su=function(){function t(e){da(this,t),this.k=e,this.q=!1,this.K=null}return pa(t,[{key:"isDone",get:function(){return this.q}},{key:"$",get:function(){return this.K}},{key:"cursor",set:function(t){this.k=t}},{key:"done",value:function(){this.q=!0}},{key:"U",value:function(t){this.K=t}},{key:"delete",value:function(){return fu(this.k.delete())}}]),t}(),cu=function(t){function e(t,n){var r;return da(this,e),(r=ia(this,e,[Aa.UNAVAILABLE,"IndexedDB transaction '".concat(t,"' failed: ").concat(n)])).name="IndexedDbTransactionError",r}return ua(e,t),pa(e)}(Da);function lu(t){return"IndexedDbTransactionError"===t.name}var hu=function(){function t(e){da(this,t),this.store=e}return pa(t,[{key:"put",value:function(t,e){var n;return void 0!==e?(Ea("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Ea("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),fu(n)}},{key:"add",value:function(t){return Ea("SimpleDb","ADD",this.store.name,t,t),fu(this.store.add(t))}},{key:"get",value:function(t){var e=this;return fu(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Ea("SimpleDb","GET",e.store.name,t,n),n}))}},{key:"delete",value:function(t){return Ea("SimpleDb","DELETE",this.store.name,t),fu(this.store.delete(t))}},{key:"count",value:function(){return Ea("SimpleDb","COUNT",this.store.name),fu(this.store.count())}},{key:"W",value:function(t,e){var n=this.options(t,e),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){var i=r.getAll(n.range);return new ou((function(t,e){i.onerror=function(t){e(t.target.error)},i.onsuccess=function(e){t(e.target.result)}}))}var o=this.cursor(n),a=[];return this.G(o,(function(t,e){a.push(e)})).next((function(){return a}))}},{key:"j",value:function(t,e){var n=this.store.getAll(t,null===e?void 0:e);return new ou((function(t,e){n.onerror=function(t){e(t.target.error)},n.onsuccess=function(e){t(e.target.result)}}))}},{key:"H",value:function(t,e){Ea("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.J=!1;var r=this.cursor(n);return this.G(r,(function(t,e,n){return n.delete()}))}},{key:"Y",value:function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.G(r,e)}},{key:"Z",value:function(t){var e=this.cursor({});return new ou((function(n,r){e.onerror=function(t){var e=vu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))}},{key:"G",value:function(t,e){var n=[];return new ou((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new su(i),a=e(i.primaryKey,i.value,o);if(a instanceof ou){var u=a.catch((function(t){return o.done(),ou.reject(t)}));n.push(u)}o.isDone?r():null===o.$?i.continue():i.continue(o.$)}else r()}})).next((function(){return ou.waitFor(n)}))}},{key:"options",value:function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}},{key:"cursor",value:function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}]),t}();function fu(t){return new ou((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=vu(t.target.error);n(e)}}))}var du=!1;function vu(t){var e=uu.S(k());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Da("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return du||(du=!0,setTimeout((function(){throw r}),0)),r}}return t}var pu=function(){function t(e,n){var r=this;da(this,t),this.previousValue=e,n&&(n.sequenceNumberHandler=function(t){return r.se(t)},this.oe=function(t){return n.writeSequenceNumber(t)})}return pa(t,[{key:"se",value:function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}},{key:"next",value:function(){var t=++this.previousValue;return this.oe&&this.oe(t),t}}]),t}();function yu(t){return null==t}function gu(t){return 0===t&&1/t==-1/0}pu._e=-1;var mu=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),wu=([].concat(ca(mu),["documentOverlays"]),["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"]);function ku(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function bu(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Eu(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}[].concat(wu,["indexConfiguration","indexState","indexEntries"]);var _u=function(){function t(e,n){da(this,t),this.comparator=e,this.root=n||Tu.EMPTY}return pa(t,[{key:"insert",value:function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Tu.BLACK,null,null))}},{key:"remove",value:function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Tu.BLACK,null,null))}},{key:"get",value:function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}},{key:"indexOf",value:function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(t){return this.root.inorderTraversal(t)}},{key:"forEach",value:function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))}},{key:"toString",value:function(){var t=[];return this.inorderTraversal((function(e,n){return t.push("".concat(e,":").concat(n)),!1})),"{".concat(t.join(", "),"}")}},{key:"reverseTraversal",value:function(t){return this.root.reverseTraversal(t)}},{key:"getIterator",value:function(){return new Su(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(t){return new Su(this.root,t,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new Su(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(t){return new Su(this.root,t,this.comparator,!0)}}]),t}(),Su=function(){function t(e,n,r,i){da(this,t),this.isReverse=i,this.nodeStack=[];for(var o=1;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(0===o){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return pa(t,[{key:"getNext",value:function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}]),t}(),Tu=function(){function t(e,n,r,i,o){da(this,t),this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return pa(t,[{key:"copy",value:function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}},{key:"reverseTraversal",value:function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}},{key:"moveRedLeft",value:function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t}},{key:"moveRedRight",value:function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t}},{key:"rotateLeft",value:function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}},{key:"rotateRight",value:function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}},{key:"colorFlip",value:function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}},{key:"checkMaxDepth",value:function(){var t=this.check();return Math.pow(2,t)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw xa();if(this.right.isRed())throw xa();var t=this.left.check();if(t!==this.right.check())throw xa();return t+(this.isRed()?0:1)}}]),t}();Tu.EMPTY=null,Tu.RED=!0,Tu.BLACK=!1,Tu.EMPTY=new(function(){function t(){da(this,t),this.size=0}return pa(t,[{key:"key",get:function(){throw xa()}},{key:"value",get:function(){throw xa()}},{key:"color",get:function(){throw xa()}},{key:"left",get:function(){throw xa()}},{key:"right",get:function(){throw xa()}},{key:"copy",value:function(t,e,n,r,i){return this}},{key:"insert",value:function(t,e,n){return new Tu(t,e)}},{key:"remove",value:function(t,e){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(t){return!1}},{key:"reverseTraversal",value:function(t){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),t}());var xu=function(){function t(e){da(this,t),this.comparator=e,this.data=new _u(this.comparator)}return pa(t,[{key:"has",value:function(t){return null!==this.data.get(t)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(t){return this.data.indexOf(t)}},{key:"forEach",value:function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))}},{key:"forEachInRange",value:function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}},{key:"forEachWhile",value:function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}},{key:"getIterator",value:function(){return new Iu(this.data.getIterator())}},{key:"getIteratorFrom",value:function(t){return new Iu(this.data.getIteratorFrom(t))}},{key:"add",value:function(t){return this.copy(this.data.remove(t).insert(t,!0))}},{key:"delete",value:function(t){return this.has(t)?this.copy(this.data.remove(t)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0}},{key:"toArray",value:function(){var t=[];return this.forEach((function(e){t.push(e)})),t}},{key:"toString",value:function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"}},{key:"copy",value:function(e){var n=new t(this.comparator);return n.data=e,n}}]),t}(),Iu=function(){function t(e){da(this,t),this.iter=e}return pa(t,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),t}(),Cu=function(){function t(e){da(this,t),this.fields=e,e.sort(Xa.comparator)}return pa(t,[{key:"unionWith",value:function(e){var n,r=new xu(Xa.comparator),i=ta(this.fields);try{for(i.s();!(n=i.n()).done;){var o=n.value;r=r.add(o)}}catch(t){i.e(t)}finally{i.f()}var a,u=ta(e);try{for(u.s();!(a=u.n()).done;){var s=a.value;r=r.add(s)}}catch(t){u.e(t)}finally{u.f()}return new t(r.toArray())}},{key:"covers",value:function(t){var e,n=ta(this.fields);try{for(n.s();!(e=n.n()).done;)if(e.value.isPrefixOf(t))return!0}catch(t){n.e(t)}finally{n.f()}return!1}},{key:"isEqual",value:function(t){return za(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))}}],[{key:"empty",value:function(){return new t([])}}]),t}(),Au=function(t){function e(){var t;return da(this,e),(t=ia(this,e,arguments)).name="Base64DecodeError",t}return ua(e,t),pa(e)}($o(Error)),Du=function(t){function e(t){da(this,e),this.binaryString=t}return pa(e,[{key:Symbol.iterator,value:function(){var t=this,e=0;return{next:function(){return e<t.binaryString.length?{value:t.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return t=this.binaryString,btoa(t);var t}},{key:"toUint8Array",value:function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(t){return qa(this.binaryString,t.binaryString)}},{key:"isEqual",value:function(t){return this.binaryString===t.binaryString}}],[{key:"fromBase64String",value:function(t){var n=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Au("Invalid base64 string: "+t):t}}(t);return new e(n)}},{key:"fromUint8Array",value:function(t){var n=function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new e(n)}}]),e}();Du.EMPTY_BYTE_STRING=new Du("");var Ou=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Nu(t){if(Ia(!!t),"string"==typeof t){var e=0,n=Ou.exec(t);if(Ia(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Lu(t.seconds),nanos:Lu(t.nanos)}}function Lu(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Pu(t){return"string"==typeof t?Du.fromBase64String(t):Du.fromUint8Array(t)}function Ru(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Mu(t){var e=t.mapValue.fields.__previous_value__;return Ru(e)?Mu(e):e}function ju(t){var e=Nu(t.mapValue.fields.__local_write_time__.timestampValue);return new Ga(e.seconds,e.nanos)}var Fu=pa((function t(e,n,r,i,o,a,u,s,c){da(this,t),this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=s,this.useFetchStreams=c})),Vu=function(){function t(e,n){da(this,t),this.projectId=e,this.database=n||"(default)"}return pa(t,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}}],[{key:"empty",value:function(){return new t("","")}}]),t}(),Uu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Bu(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ru(t)?4:ts(t)?9007199254740991:10:xa()}function qu(t,e){if(t===e)return!0;var n=Bu(t);if(n!==Bu(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ju(t).isEqual(ju(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Nu(t.timestampValue),r=Nu(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Pu(t.bytesValue).isEqual(Pu(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Lu(t.geoPointValue.latitude)===Lu(e.geoPointValue.latitude)&&Lu(t.geoPointValue.longitude)===Lu(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Lu(t.integerValue)===Lu(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Lu(t.doubleValue),r=Lu(e.doubleValue);return n===r?gu(n)===gu(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return za(t.arrayValue.values||[],e.arrayValue.values||[],qu);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ku(n)!==ku(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!qu(n[i],r[i])))return!1;return!0}(t,e);default:return xa()}}function zu(t,e){return void 0!==(t.values||[]).find((function(t){return qu(t,e)}))}function Gu(t,e){if(t===e)return 0;var n=Bu(t),r=Bu(e);if(n!==r)return qa(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return qa(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Lu(t.integerValue||t.doubleValue),r=Lu(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Ku(t.timestampValue,e.timestampValue);case 4:return Ku(ju(t),ju(e));case 5:return qa(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Pu(t),r=Pu(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=qa(n[i],r[i]);if(0!==o)return o}return qa(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=qa(Lu(t.latitude),Lu(e.latitude));return 0!==n?n:qa(Lu(t.longitude),Lu(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Gu(n[i],r[i]);if(o)return o}return qa(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===Uu.mapValue&&e===Uu.mapValue)return 0;if(t===Uu.mapValue)return 1;if(e===Uu.mapValue)return-1;var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var u=qa(r[a],o[a]);if(0!==u)return u;var s=Gu(n[r[a]],i[o[a]]);if(0!==s)return s}return qa(r.length,o.length)}(t.mapValue,e.mapValue);default:throw xa()}}function Ku(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return qa(t,e);var n=Nu(t),r=Nu(e),i=qa(n.seconds,r.seconds);return 0!==i?i:qa(n.nanos,r.nanos)}function Hu(t){return Qu(t)}function Qu(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Nu(t);return"time(".concat(e.seconds,",").concat(e.nanos,")")}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return Pu(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return Ya.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return"geo(".concat(t.latitude,",").concat(t.longitude,")")}(t.geoPointValue):"arrayValue"in t?function(t){var e,n="[",r=!0,i=ta(t.values||[]);try{for(i.s();!(e=i.n()).done;){var o=e.value;r?r=!1:n+=",",n+=Qu(o)}}catch(t){i.e(t)}finally{i.f()}return n+"]"}(t.arrayValue):"mapValue"in t?function(t){var e,n="{",r=!0,i=ta(Object.keys(t.fields||{}).sort());try{for(i.s();!(e=i.n()).done;){var o=e.value;r?r=!1:n+=",",n+="".concat(o,":").concat(Qu(t.fields[o]))}}catch(t){i.e(t)}finally{i.f()}return n+"}"}(t.mapValue):xa()}function Wu(t){return!!t&&"integerValue"in t}function Xu(t){return!!t&&"arrayValue"in t}function Yu(t){return!!t&&"nullValue"in t}function Ju(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $u(t){return!!t&&"mapValue"in t}function Zu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==fa(t.timestampValue))return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return bu(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=Zu(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Zu(t.arrayValue.values[r]);return n}return Object.assign({},t)}function ts(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}var es=function(){function t(e){da(this,t),this.value=e}return pa(t,[{key:"field",value:function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!$u(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null}},{key:"set",value:function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Zu(e)}},{key:"setAll",value:function(t){var e=this,n=Xa.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var a=e.getFieldsMap(n);e.applyChanges(a,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Zu(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)}},{key:"delete",value:function(t){var e=this.field(t.popLast());$u(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}},{key:"isEqual",value:function(t){return qu(this.value,t.value)}},{key:"getFieldsMap",value:function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];$u(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}},{key:"applyChanges",value:function(t,e,n){bu(e,(function(e,n){return t[e]=n}));var r,i=ta(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;delete t[o]}}catch(t){i.e(t)}finally{i.f()}}},{key:"clone",value:function(){return new t(Zu(this.value))}}],[{key:"empty",value:function(){return new t({mapValue:{}})}}]),t}();function ns(t){var e=[];return bu(t.fields,(function(t,n){var r=new Xa([t]);if($u(n)){var i=ns(n.mapValue).fields;if(0===i.length)e.push(r);else{var o,a=ta(i);try{for(a.s();!(o=a.n()).done;){var u=o.value;e.push(r.child(u))}}catch(t){a.e(t)}finally{a.f()}}}else e.push(r)})),new Cu(e)}var rs=function(){function t(e,n,r,i,o,a,u){da(this,t),this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}return pa(t,[{key:"convertToFoundDocument",value:function(t,e){return!this.createTime.isEqual(Ka.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}},{key:"convertToNoDocument",value:function(t){return this.version=t,this.documentType=2,this.data=es.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(t){return this.version=t,this.documentType=3,this.data=es.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=Ka.min(),this}},{key:"setReadTime",value:function(t){return this.readTime=t,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}},{key:"mutableCopy",value:function(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(e){return new t(e,0,Ka.min(),Ka.min(),Ka.min(),es.empty(),0)}},{key:"newFoundDocument",value:function(e,n,r,i){return new t(e,1,n,Ka.min(),r,i,0)}},{key:"newNoDocument",value:function(e,n){return new t(e,2,n,Ka.min(),Ka.min(),es.empty(),0)}},{key:"newUnknownDocument",value:function(e,n){return new t(e,3,n,Ka.min(),Ka.min(),es.empty(),2)}}]),t}(),is=pa((function t(e,n){da(this,t),this.position=e,this.inclusive=n}));function os(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],a=t.position[i];if(r=o.field.isKeyField()?Ya.comparator(Ya.fromName(a.referenceValue),n.key):Gu(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return r}function as(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!qu(t.position[n],e.position[n]))return!1;return!0}var us=pa((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";da(this,t),this.field=e,this.dir=n}));function ss(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var cs=pa((function t(){da(this,t)})),ls=function(t){function e(t,n,r){var i;return da(this,e),(i=ia(this,e)).field=t,i.op=n,i.value=r,i}return ua(e,t),pa(e,[{key:"matches",value:function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Gu(e,this.value)):null!==e&&Bu(this.value)===Bu(e)&&this.matchesComparison(Gu(e,this.value))}},{key:"matchesComparison",value:function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return xa()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}}],[{key:"create",value:function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.createKeyFieldInFilter(t,n,r):new gs(t,n,r):"array-contains"===n?new bs(t,r):"in"===n?new Es(t,r):"not-in"===n?new _s(t,r):"array-contains-any"===n?new Ss(t,r):new e(t,n,r)}},{key:"createKeyFieldInFilter",value:function(t,e,n){return"in"===e?new ms(t,n):new ws(t,n)}}]),e}(cs),hs=function(t){function e(t,n){var r;return da(this,e),(r=ia(this,e)).filters=t,r.op=n,r.ue=null,r}return ua(e,t),pa(e,[{key:"matches",value:function(t){return fs(this)?void 0===this.filters.find((function(e){return!e.matches(t)})):void 0!==this.filters.find((function(e){return e.matches(t)}))}},{key:"getFlattenedFilters",value:function(){return null!==this.ue||(this.ue=this.filters.reduce((function(t,e){return t.concat(e.getFlattenedFilters())}),[])),this.ue}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}}],[{key:"create",value:function(t,n){return new e(t,n)}}]),e}(cs);function fs(t){return"and"===t.op}function ds(t){return function(t){var e,n=ta(t.filters);try{for(n.s();!(e=n.n()).done;)if(e.value instanceof hs)return!1}catch(t){n.e(t)}finally{n.f()}return!0}(t)&&fs(t)}function vs(t){if(t instanceof ls)return t.field.canonicalString()+t.op.toString()+Hu(t.value);if(ds(t))return t.filters.map((function(t){return vs(t)})).join(",");var e=t.filters.map((function(t){return vs(t)})).join(",");return"".concat(t.op,"(").concat(e,")")}function ps(t,e){return t instanceof ls?function(t,e){return e instanceof ls&&t.op===e.op&&t.field.isEqual(e.field)&&qu(t.value,e.value)}(t,e):t instanceof hs?function(t,e){return e instanceof hs&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce((function(t,n,r){return t&&ps(n,e.filters[r])}),!0)}(t,e):void xa()}function ys(t){return t instanceof ls?function(t){return"".concat(t.field.canonicalString()," ").concat(t.op," ").concat(Hu(t.value))}(t):t instanceof hs?function(t){return t.op.toString()+" {"+t.getFilters().map(ys).join(" ,")+"}"}(t):"Filter"}var gs=function(t){function e(t,n,r){var i;return da(this,e),(i=ia(this,e,[t,n,r])).key=Ya.fromName(r.referenceValue),i}return ua(e,t),pa(e,[{key:"matches",value:function(t){var e=Ya.comparator(t.key,this.key);return this.matchesComparison(e)}}]),e}(ls),ms=function(t){function e(t,n){var r;return da(this,e),(r=ia(this,e,[t,"in",n])).keys=ks(0,n),r}return ua(e,t),pa(e,[{key:"matches",value:function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))}}]),e}(ls),ws=function(t){function e(t,n){var r;return da(this,e),(r=ia(this,e,[t,"not-in",n])).keys=ks(0,n),r}return ua(e,t),pa(e,[{key:"matches",value:function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))}}]),e}(ls);function ks(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Ya.fromName(t.referenceValue)}))}var bs=function(t){function e(t,n){return da(this,e),ia(this,e,[t,"array-contains",n])}return ua(e,t),pa(e,[{key:"matches",value:function(t){var e=t.data.field(this.field);return Xu(e)&&zu(e.arrayValue,this.value)}}]),e}(ls),Es=function(t){function e(t,n){return da(this,e),ia(this,e,[t,"in",n])}return ua(e,t),pa(e,[{key:"matches",value:function(t){var e=t.data.field(this.field);return null!==e&&zu(this.value.arrayValue,e)}}]),e}(ls),_s=function(t){function e(t,n){return da(this,e),ia(this,e,[t,"not-in",n])}return ua(e,t),pa(e,[{key:"matches",value:function(t){if(zu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!zu(this.value.arrayValue,e)}}]),e}(ls),Ss=function(t){function e(t,n){return da(this,e),ia(this,e,[t,"array-contains-any",n])}return ua(e,t),pa(e,[{key:"matches",value:function(t){var e=this,n=t.data.field(this.field);return!(!Xu(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return zu(e.value.arrayValue,t)}))}}]),e}(ls),Ts=pa((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;da(this,t),this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.ce=null}));function xs(t){return new Ts(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Is(t){var e=Ca(t);if(null===e.ce){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return vs(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),yu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((function(t){return Hu(t)})).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((function(t){return Hu(t)})).join(",")),e.ce=n}return e.ce}function Cs(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!ss(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(!ps(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!as(t.startAt,e.startAt)&&as(t.endAt,e.endAt)}function As(t){return Ya.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ds=pa((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;da(this,t),this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=s,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}));function Os(t){return new Ds(t)}function Ns(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function Ls(t){var e=Ca(t);if(null===e.le){e.le=[];var n,r=new Set,i=ta(e.explicitOrderBy);try{for(i.s();!(n=i.n()).done;){var o=n.value;e.le.push(o),r.add(o.field.canonicalString())}}catch(t){i.e(t)}finally{i.f()}var a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",u=function(t){var e=new xu(Xa.comparator);return t.filters.forEach((function(t){t.getFlattenedFilters().forEach((function(t){t.isInequality()&&(e=e.add(t.field))}))})),e}(e);u.forEach((function(t){r.has(t.canonicalString())||t.isKeyField()||e.le.push(new us(t,a))})),r.has(Xa.keyField().canonicalString())||e.le.push(new us(Xa.keyField(),a))}return e.le}function Ps(t){var e=Ca(t);return e.he||(e.he=function(t,e){if("F"===t.limitType)return xs(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);e=e.map((function(t){var e="desc"===t.dir?"asc":"desc";return new us(t.field,e)}));var n=t.endAt?new is(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new is(t.startAt.position,t.startAt.inclusive):null;return xs(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}(e,Ls(t))),e.he}function Rs(t,e,n){return new Ds(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ms(t,e){return Cs(Ps(t),Ps(e))&&t.limitType===e.limitType}function js(t){return"".concat(Is(Ps(t)),"|lt:").concat(t.limitType)}function Fs(t){return"Query(target=".concat(function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: [".concat(t.filters.map((function(t){return ys(t)})).join(", "),"]")),yu(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: [".concat(t.orderBy.map((function(t){return function(t){return"".concat(t.field.canonicalString()," (").concat(t.dir,")")}(t)})).join(", "),"]")),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((function(t){return Hu(t)})).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((function(t){return Hu(t)})).join(",")),"Target(".concat(e,")")}(Ps(t)),"; limitType=").concat(t.limitType,")")}function Vs(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ya.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){var n,r=ta(Ls(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}}catch(t){r.e(t)}finally{r.f()}return!0}(t,e)&&function(t,e){var n,r=ta(t.filters);try{for(r.s();!(n=r.n()).done;)if(!n.value.matches(e))return!1}catch(t){r.e(t)}finally{r.f()}return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){var r=os(t,e,n);return t.inclusive?r<=0:r<0}(t.startAt,Ls(t),e)||t.endAt&&!function(t,e,n){var r=os(t,e,n);return t.inclusive?r>=0:r>0}(t.endAt,Ls(t),e))}(t,e)}function Us(t){return function(e,n){var r,i=!1,o=ta(Ls(t));try{for(o.s();!(r=o.n()).done;){var a=r.value,u=Bs(a,e,n);if(0!==u)return u;i=i||a.field.isKeyField()}}catch(t){o.e(t)}finally{o.f()}return 0}}function Bs(t,e,n){var r=t.field.isKeyField()?Ya.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Gu(r,i):xa()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return xa()}}var qs=function(){function t(e,n){da(this,t),this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}return pa(t,[{key:"get",value:function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n){var r,i=ta(n);try{for(i.s();!(r=i.n()).done;){var o=Jo(r.value,2),a=o[0],u=o[1];if(this.equalsFn(a,t))return u}}catch(t){i.e(t)}finally{i.f()}}}},{key:"has",value:function(t){return void 0!==this.get(t)}},{key:"set",value:function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return this.inner[n]=[[t,e]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e]),this.innerSize++}},{key:"delete",value:function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(t){bu(this.inner,(function(e,n){var r,i=ta(n);try{for(i.s();!(r=i.n()).done;){var o=Jo(r.value,2),a=o[0],u=o[1];t(a,u)}}catch(t){i.e(t)}finally{i.f()}}))}},{key:"isEmpty",value:function(){return Eu(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),t}(),zs=new _u(Ya.comparator);function Gs(){return zs}var Ks=new _u(Ya.comparator);function Hs(){for(var t=Ks,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];t=t.insert(a.key,a)}return t}function Qs(t){var e=Ks;return t.forEach((function(t,n){return e=e.insert(t,n.overlayedDocument)})),e}function Ws(){return Ys()}function Xs(){return Ys()}function Ys(){return new qs((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)}))}var Js=new _u(Ya.comparator),$s=new xu(Ya.comparator);function Zs(){for(var t=$s,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];t=t.add(a)}return t}var tc=new xu(qa);function ec(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gu(e)?"-0":e}}function nc(t){return{integerValue:""+t}}function rc(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!gu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?nc(e):ec(t,e)}var ic=pa((function t(){da(this,t),this._=void 0}));function oc(t,e,n){return t instanceof sc?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Ru(e)&&(e=Mu(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof cc?lc(t,e):t instanceof hc?fc(t,e):function(t,e){var n=uc(t,e),r=vc(n)+vc(t.Ie);return Wu(n)&&Wu(t.Ie)?nc(r):ec(t.serializer,r)}(t,e)}function ac(t,e,n){return t instanceof cc?lc(t,e):t instanceof hc?fc(t,e):n}function uc(t,e){return t instanceof dc?function(t){return Wu(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}var sc=function(t){function e(){return da(this,e),ia(this,e,arguments)}return ua(e,t),pa(e)}(ic),cc=function(t){function e(t){var n;return da(this,e),(n=ia(this,e)).elements=t,n}return ua(e,t),pa(e)}(ic);function lc(t,e){var n,r=pc(e),i=ta(t.elements);try{var o=function(){var t=n.value;r.some((function(e){return qu(e,t)}))||r.push(t)};for(i.s();!(n=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}return{arrayValue:{values:r}}}var hc=function(t){function e(t){var n;return da(this,e),(n=ia(this,e)).elements=t,n}return ua(e,t),pa(e)}(ic);function fc(t,e){var n,r=pc(e),i=ta(t.elements);try{var o=function(){var t=n.value;r=r.filter((function(e){return!qu(e,t)}))};for(i.s();!(n=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}return{arrayValue:{values:r}}}var dc=function(t){function e(t,n){var r;return da(this,e),(r=ia(this,e)).serializer=t,r.Ie=n,r}return ua(e,t),pa(e)}(ic);function vc(t){return Lu(t.integerValue||t.doubleValue)}function pc(t){return Xu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var yc=pa((function t(e,n){da(this,t),this.version=e,this.transformResults=n})),gc=function(){function t(e,n){da(this,t),this.updateTime=e,this.exists=n}return pa(t,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}],[{key:"none",value:function(){return new t}},{key:"exists",value:function(e){return new t(void 0,e)}},{key:"updateTime",value:function(e){return new t(e)}}]),t}();function mc(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var wc=pa((function t(){da(this,t)}));function kc(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Nc(t.key,gc.none()):new Tc(t.key,t.data,gc.none());var n,r=t.data,i=es.empty(),o=new xu(Xa.comparator),a=ta(e.fields);try{for(a.s();!(n=a.n()).done;){var u=n.value;if(!o.has(u)){var s=r.field(u);null===s&&u.length>1&&(u=u.popLast(),s=r.field(u)),null===s?i.delete(u):i.set(u,s),o=o.add(u)}}}catch(t){a.e(t)}finally{a.f()}return new xc(t.key,i,new Cu(o.toArray()),gc.none())}function bc(t,e,n){t instanceof Tc?function(t,e,n){var r=t.value.clone(),i=Cc(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof xc?function(t,e,n){if(mc(t.precondition,e)){var r=Cc(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Ic(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Ec(t,e,n,r){return t instanceof Tc?function(t,e,n,r){if(!mc(t.precondition,e))return n;var i=t.value.clone(),o=Ac(t.fieldTransforms,r,e);return i.setAll(o),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,r):t instanceof xc?function(t,e,n,r){if(!mc(t.precondition,e))return n;var i=Ac(t.fieldTransforms,r,e),o=e.data;return o.setAll(Ic(t)),o.setAll(i),e.convertToFoundDocument(e.version,o).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((function(t){return t.field})))}(t,e,n,r):function(t,e,n){return mc(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function _c(t,e){var n,r=null,i=ta(t.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=e.data.field(o.field),u=uc(o.transform,a||null);null!=u&&(null===r&&(r=es.empty()),r.set(o.field,u))}}catch(t){i.e(t)}finally{i.f()}return r||null}function Sc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&za(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof cc&&e instanceof cc||t instanceof hc&&e instanceof hc?za(t.elements,e.elements,qu):t instanceof dc&&e instanceof dc?qu(t.Ie,e.Ie):t instanceof sc&&e instanceof sc}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Tc=function(t){function e(t,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return da(this,e),(i=ia(this,e)).key=t,i.value=n,i.precondition=r,i.fieldTransforms=o,i.type=0,i}return ua(e,t),pa(e,[{key:"getFieldMask",value:function(){return null}}]),e}(wc),xc=function(t){function e(t,n,r,i){var o,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return da(this,e),(o=ia(this,e)).key=t,o.data=n,o.fieldMask=r,o.precondition=i,o.fieldTransforms=a,o.type=1,o}return ua(e,t),pa(e,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),e}(wc);function Ic(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Cc(t,e,n){var r=new Map;Ia(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,ac(a,u,n[i]))}return r}function Ac(t,e,n){var r,i=new Map,o=ta(t);try{for(o.s();!(r=o.n()).done;){var a=r.value,u=a.transform,s=n.data.field(a.field);i.set(a.field,oc(u,s,e))}}catch(t){o.e(t)}finally{o.f()}return i}var Dc,Oc,Nc=function(t){function e(t,n){var r;return da(this,e),(r=ia(this,e)).key=t,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return ua(e,t),pa(e,[{key:"getFieldMask",value:function(){return null}}]),e}(wc),Lc=function(t){function e(t,n){var r;return da(this,e),(r=ia(this,e)).key=t,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return ua(e,t),pa(e,[{key:"getFieldMask",value:function(){return null}}]),e}(wc),Pc=function(){function t(e,n,r,i){da(this,t),this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return pa(t,[{key:"applyToRemoteDocument",value:function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&bc(i,t,n[r])}}},{key:"applyToLocalView",value:function(t,e){var n,r=ta(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(t.key)&&(e=Ec(i,t,e,this.localWriteTime))}}catch(t){r.e(t)}finally{r.f()}var o,a=ta(this.mutations);try{for(a.s();!(o=a.n()).done;){var u=o.value;u.key.isEqual(t.key)&&(e=Ec(u,t,e,this.localWriteTime))}}catch(t){a.e(t)}finally{a.f()}return e}},{key:"applyToLocalDocumentSet",value:function(t,e){var n=this,r=Xs();return this.mutations.forEach((function(i){var o=t.get(i.key),a=o.overlayedDocument,u=n.applyToLocalView(a,o.mutatedFields),s=kc(a,u=e.has(i.key)?null:u);null!==s&&r.set(i.key,s),a.isValidDocument()||a.convertToNoDocument(Ka.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Zs())}},{key:"isEqual",value:function(t){return this.batchId===t.batchId&&za(this.mutations,t.mutations,(function(t,e){return Sc(t,e)}))&&za(this.baseMutations,t.baseMutations,(function(t,e){return Sc(t,e)}))}}]),t}(),Rc=function(){function t(e,n,r,i){da(this,t),this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return pa(t,null,[{key:"from",value:function(e,n,r){Ia(e.mutations.length===r.length);for(var i=Js,o=e.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new t(e,n,r,i)}}]),t}(),Mc=function(){function t(e,n){da(this,t),this.largestBatchId=e,this.mutation=n}return pa(t,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(t){return null!==t&&this.mutation===t.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),t}(),jc=pa((function t(e,n){da(this,t),this.count=e,this.unchangedNames=n}));function Fc(t){switch(t){default:return xa();case Aa.CANCELLED:case Aa.UNKNOWN:case Aa.DEADLINE_EXCEEDED:case Aa.RESOURCE_EXHAUSTED:case Aa.INTERNAL:case Aa.UNAVAILABLE:case Aa.UNAUTHENTICATED:return!1;case Aa.INVALID_ARGUMENT:case Aa.NOT_FOUND:case Aa.ALREADY_EXISTS:case Aa.PERMISSION_DENIED:case Aa.FAILED_PRECONDITION:case Aa.ABORTED:case Aa.OUT_OF_RANGE:case Aa.UNIMPLEMENTED:case Aa.DATA_LOSS:return!0}}function Vc(t){if(void 0===t)return _a("GRPC error has no .code"),Aa.UNKNOWN;switch(t){case Dc.OK:return Aa.OK;case Dc.CANCELLED:return Aa.CANCELLED;case Dc.UNKNOWN:return Aa.UNKNOWN;case Dc.DEADLINE_EXCEEDED:return Aa.DEADLINE_EXCEEDED;case Dc.RESOURCE_EXHAUSTED:return Aa.RESOURCE_EXHAUSTED;case Dc.INTERNAL:return Aa.INTERNAL;case Dc.UNAVAILABLE:return Aa.UNAVAILABLE;case Dc.UNAUTHENTICATED:return Aa.UNAUTHENTICATED;case Dc.INVALID_ARGUMENT:return Aa.INVALID_ARGUMENT;case Dc.NOT_FOUND:return Aa.NOT_FOUND;case Dc.ALREADY_EXISTS:return Aa.ALREADY_EXISTS;case Dc.PERMISSION_DENIED:return Aa.PERMISSION_DENIED;case Dc.FAILED_PRECONDITION:return Aa.FAILED_PRECONDITION;case Dc.ABORTED:return Aa.ABORTED;case Dc.OUT_OF_RANGE:return Aa.OUT_OF_RANGE;case Dc.UNIMPLEMENTED:return Aa.UNIMPLEMENTED;case Dc.DATA_LOSS:return Aa.DATA_LOSS;default:return xa()}}(Oc=Dc||(Dc={}))[Oc.OK=0]="OK",Oc[Oc.CANCELLED=1]="CANCELLED",Oc[Oc.UNKNOWN=2]="UNKNOWN",Oc[Oc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oc[Oc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oc[Oc.NOT_FOUND=5]="NOT_FOUND",Oc[Oc.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oc[Oc.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oc[Oc.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oc[Oc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oc[Oc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oc[Oc.ABORTED=10]="ABORTED",Oc[Oc.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oc[Oc.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oc[Oc.INTERNAL=13]="INTERNAL",Oc[Oc.UNAVAILABLE=14]="UNAVAILABLE",Oc[Oc.DATA_LOSS=15]="DATA_LOSS";var Uc=new Xo([4294967295,4294967295],0);function Bc(t){var e=(new TextEncoder).encode(t),n=new Wo;return n.update(e),new Uint8Array(n.digest())}function qc(t){var e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Xo([n,r],0),new Xo([i,o],0)]}var zc=function(){function t(e,n,r){if(da(this,t),this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Gc("Invalid padding: ".concat(n));if(r<0)throw new Gc("Invalid hash count: ".concat(r));if(e.length>0&&0===this.hashCount)throw new Gc("Invalid hash count: ".concat(r));if(0===e.length&&0!==n)throw new Gc("Invalid padding when bitmap length is 0: ".concat(n));this.Te=8*e.length-n,this.Ee=Xo.fromNumber(this.Te)}return pa(t,[{key:"de",value:function(t,e,n){var r=t.add(e.multiply(Xo.fromNumber(n)));return 1===r.compare(Uc)&&(r=new Xo([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ee).toNumber()}},{key:"Ae",value:function(t){return 0!=(this.bitmap[Math.floor(t/8)]&1<<t%8)}},{key:"mightContain",value:function(t){if(0===this.Te)return!1;for(var e=Jo(qc(Bc(t)),2),n=e[0],r=e[1],i=0;i<this.hashCount;i++){var o=this.de(n,r,i);if(!this.Ae(o))return!1}return!0}},{key:"insert",value:function(t){if(0!==this.Te)for(var e=Jo(qc(Bc(t)),2),n=e[0],r=e[1],i=0;i<this.hashCount;i++){var o=this.de(n,r,i);this.Re(o)}}},{key:"Re",value:function(t){var e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}],[{key:"create",value:function(e,n,r){var i=e%8==0?0:8-e%8,o=new t(new Uint8Array(Math.ceil(e/8)),i,n);return r.forEach((function(t){return o.insert(t)})),o}}]),t}(),Gc=function(t){function e(){var t;return da(this,e),(t=ia(this,e,arguments)).name="BloomFilterError",t}return ua(e,t),pa(e)}($o(Error)),Kc=function(){function t(e,n,r,i,o){da(this,t),this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}return pa(t,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(e,n,r){var i=new Map;return i.set(e,Hc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(Ka.min(),i,new _u(qa),Gs(),Zs())}}]),t}(),Hc=function(){function t(e,n,r,i,o){da(this,t),this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}return pa(t,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(e,n,r){return new t(r,n,Zs(),Zs(),Zs())}}]),t}(),Qc=pa((function t(e,n,r,i){da(this,t),this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i})),Wc=pa((function t(e,n){da(this,t),this.targetId=e,this.fe=n})),Xc=pa((function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Du.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;da(this,t),this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i})),Yc=function(){function t(){da(this,t),this.ge=0,this.pe=Zc(),this.ye=Du.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}return pa(t,[{key:"current",get:function(){return this.we}},{key:"resumeToken",get:function(){return this.ye}},{key:"be",get:function(){return 0!==this.ge}},{key:"De",get:function(){return this.Se}},{key:"Ce",value:function(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}},{key:"ve",value:function(){var t=Zs(),e=Zs(),n=Zs();return this.pe.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:xa()}})),new Hc(this.ye,this.we,t,e,n)}},{key:"Fe",value:function(){this.Se=!1,this.pe=Zc()}},{key:"Me",value:function(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}},{key:"xe",value:function(t){this.Se=!0,this.pe=this.pe.remove(t)}},{key:"Oe",value:function(){this.ge+=1}},{key:"Ne",value:function(){this.ge-=1,Ia(this.ge>=0)}},{key:"Be",value:function(){this.Se=!0,this.we=!0}}]),t}(),Jc=function(){function t(e){da(this,t),this.Le=e,this.ke=new Map,this.qe=Gs(),this.Qe=$c(),this.Ke=new _u(qa)}return pa(t,[{key:"$e",value:function(t){var e,n=ta(t.Ve);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.me&&t.me.isFoundDocument()?this.Ue(r,t.me):this.We(r,t.key,t.me)}}catch(t){n.e(t)}finally{n.f()}var i,o=ta(t.removedTargetIds);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.We(a,t.key,t.me)}}catch(t){o.e(t)}finally{o.f()}}},{key:"Ge",value:function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.ze(n);switch(t.state){case 0:e.je(n)&&r.Ce(t.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(t.resumeToken);break;case 2:r.Ne(),r.be||e.removeTarget(n);break;case 3:e.je(n)&&(r.Be(),r.Ce(t.resumeToken));break;case 4:e.je(n)&&(e.He(n),r.Ce(t.resumeToken));break;default:xa()}}))}},{key:"forEachTarget",value:function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach((function(t,r){n.je(r)&&e(r)}))}},{key:"Je",value:function(t){var e=t.targetId,n=t.fe.count,r=this.Ye(e);if(r){var i=r.target;if(As(i))if(0===n){var o=new Ya(i.path);this.We(e,o,rs.newNoDocument(o,Ka.min()))}else Ia(1===n);else{var a=this.Ze(e);if(a!==n){var u=this.Xe(t),s=u?this.et(u,t,a):1;if(0!==s){this.He(e);var c=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(e,c)}}}}}},{key:"Xe",value:function(t){var e=t.fe.unchangedNames;if(!e||!e.bits)return null;var n,r,i=e.bits,o=i.bitmap,a=void 0===o?"":o,u=i.padding,s=void 0===u?0:u,c=e.hashCount,l=void 0===c?0:c;try{n=Pu(a).toUint8Array()}catch(t){if(t instanceof Au)return Sa("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{r=new zc(n,s,l)}catch(t){return Sa(t instanceof Gc?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===r.Te?null:r}},{key:"et",value:function(t,e,n){return e.fe.count===n-this.rt(t,e.targetId)?0:2}},{key:"rt",value:function(t,e){var n=this,r=this.Le.getRemoteKeysForTarget(e),i=0;return r.forEach((function(r){var o=n.Le.nt(),a="projects/".concat(o.projectId,"/databases/").concat(o.database,"/documents/").concat(r.path.canonicalString());t.mightContain(a)||(n.We(e,r,null),i++)})),i}},{key:"it",value:function(t){var e=this,n=new Map;this.ke.forEach((function(r,i){var o=e.Ye(i);if(o){if(r.current&&As(o.target)){var a=new Ya(o.target.path);null!==e.qe.get(a)||e.st(i,a)||e.We(i,a,rs.newNoDocument(a,t))}r.De&&(n.set(i,r.ve()),r.Fe())}}));var r=Zs();this.Qe.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.Ye(t);return!n||"TargetPurposeLimboResolution"===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))})),this.qe.forEach((function(e,n){return n.setReadTime(t)}));var i=new Kc(t,n,this.Ke,this.qe,r);return this.qe=Gs(),this.Qe=$c(),this.Ke=new _u(qa),i}},{key:"Ue",value:function(t,e){if(this.je(t)){var n=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,n),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}}},{key:"We",value:function(t,e,n){if(this.je(t)){var r=this.ze(t);this.st(t,e)?r.Me(e,1):r.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),n&&(this.qe=this.qe.insert(e,n))}}},{key:"removeTarget",value:function(t){this.ke.delete(t)}},{key:"Ze",value:function(t){var e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}},{key:"Oe",value:function(t){this.ze(t).Oe()}},{key:"ze",value:function(t){var e=this.ke.get(t);return e||(e=new Yc,this.ke.set(t,e)),e}},{key:"ot",value:function(t){var e=this.Qe.get(t);return e||(e=new xu(qa),this.Qe=this.Qe.insert(t,e)),e}},{key:"je",value:function(t){var e=null!==this.Ye(t);return e||Ea("WatchChangeAggregator","Detected inactive target",t),e}},{key:"Ye",value:function(t){var e=this.ke.get(t);return e&&e.be?null:this.Le._t(t)}},{key:"He",value:function(t){var e=this;this.ke.set(t,new Yc),this.Le.getRemoteKeysForTarget(t).forEach((function(n){e.We(t,n,null)}))}},{key:"st",value:function(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}]),t}();function $c(){return new _u(Ya.comparator)}function Zc(){return new _u(Ya.comparator)}var tl={asc:"ASCENDING",desc:"DESCENDING"},el={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},nl={and:"AND",or:"OR"},rl=pa((function t(e,n){da(this,t),this.databaseId=e,this.useProto3Json=n}));function il(t,e){return t.useProto3Json||yu(e)?e:{value:e}}function ol(t,e){return t.useProto3Json?"".concat(new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+e.nanoseconds).slice(-9),"Z"):{seconds:""+e.seconds,nanos:e.nanoseconds}}function al(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function ul(t,e){return ol(t,e.toTimestamp())}function sl(t){return Ia(!!t),Ka.fromTimestamp(function(t){var e=Nu(t);return new Ga(e.seconds,e.nanos)}(t))}function cl(t,e){return ll(t,e).canonicalString()}function ll(t,e){var n=function(t){return new Qa(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function hl(t){var e=Qa.fromString(t);return Ia(Al(e)),e}function fl(t,e){return cl(t.databaseId,e.path)}function dl(t,e){var n=hl(e);if(n.get(1)!==t.databaseId.projectId)throw new Da(Aa.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Da(Aa.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ya(yl(n))}function vl(t,e){return cl(t.databaseId,e)}function pl(t){return new Qa(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function yl(t){return Ia(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function gl(t,e,n){return{name:fl(t,e),fields:n.value.mapValue.fields}}function ml(t,e){return{documents:[vl(t,e.path)]}}function wl(t,e){var n,r={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n=i,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n=i.popLast(),r.structuredQuery.from=[{collectionId:i.lastSegment()}]),r.parent=vl(t,n);var o=function(t){if(0!==t.length)return Il(hs.create(t,"and"))}(e.filters);o&&(r.structuredQuery.where=o);var a=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Tl(t.field),direction:El(t.dir)}}(t)}))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);var u=il(t,e.limit);return null!==u&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{ut:r,parent:n}}function kl(t){var e=function(t){var e=hl(t);return 4===e.length?Qa.emptyPath():yl(e)}(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Ia(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=function(t){var e=bl(t);return e instanceof hs&&ds(e)?e.getFilters():[e]}(n.where));var u=[];n.orderBy&&(u=function(t){return t.map((function(t){return function(t){return new us(xl(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}))}(n.orderBy));var s=null;n.limit&&(s=function(t){var e;return yu(e="object"==fa(t)?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=function(t){var e=!!t.before,n=t.values||[];return new is(n,e)}(n.startAt));var l=null;return n.endAt&&(l=function(t){var e=!t.before,n=t.values||[];return new is(n,e)}(n.endAt)),function(t,e,n,r,i,o,a,u){return new Ds(t,e,n,r,i,o,a,u)}(e,i,u,a,s,"F",c,l)}function bl(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=xl(t.unaryFilter.field);return ls.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=xl(t.unaryFilter.field);return ls.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=xl(t.unaryFilter.field);return ls.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=xl(t.unaryFilter.field);return ls.create(i,"!=",{nullValue:"NULL_VALUE"});default:return xa()}}(t):void 0!==t.fieldFilter?function(t){return ls.create(xl(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return xa()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return hs.create(t.compositeFilter.filters.map((function(t){return bl(t)})),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return xa()}}(t.compositeFilter.op))}(t):xa()}function El(t){return tl[t]}function _l(t){return el[t]}function Sl(t){return nl[t]}function Tl(t){return{fieldPath:t.canonicalString()}}function xl(t){return Xa.fromServerFormat(t.fieldPath)}function Il(t){return t instanceof ls?function(t){if("=="===t.op){if(Ju(t.value))return{unaryFilter:{field:Tl(t.field),op:"IS_NAN"}};if(Yu(t.value))return{unaryFilter:{field:Tl(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ju(t.value))return{unaryFilter:{field:Tl(t.field),op:"IS_NOT_NAN"}};if(Yu(t.value))return{unaryFilter:{field:Tl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Tl(t.field),op:_l(t.op),value:t.value}}}(t):t instanceof hs?function(t){var e=t.getFilters().map((function(t){return Il(t)}));return 1===e.length?e[0]:{compositeFilter:{op:Sl(t.op),filters:e}}}(t):xa()}function Cl(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function Al(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Dl=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ka.min(),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ka.min(),u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Du.EMPTY_BYTE_STRING,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;da(this,t),this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=s}return pa(t,[{key:"withSequenceNumber",value:function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}},{key:"withResumeToken",value:function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}},{key:"withExpectedCount",value:function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}},{key:"withLastLimboFreeSnapshotVersion",value:function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}]),t}(),Ol=pa((function t(e){da(this,t),this.ct=e}));function Nl(t){var e=kl({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Rs(e,e.limit,"L"):e}var Ll=function(){function t(){da(this,t)}return pa(t,[{key:"Pt",value:function(t,e){this.It(t,e),e.Tt()}},{key:"It",value:function(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(Lu(t.integerValue));else if("doubleValue"in t){var n=Lu(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),gu(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){var r=t.timestampValue;this.Et(e,20),"string"==typeof r?e.At(r):(e.At("".concat(r.seconds||"")),e.dt(r.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(Pu(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){var i=t.geoPointValue;this.Et(e,45),e.dt(i.latitude||0),e.dt(i.longitude||0)}else"mapValue"in t?ts(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):xa()}},{key:"Rt",value:function(t,e){this.Et(e,25),this.St(t,e)}},{key:"St",value:function(t,e){e.At(t)}},{key:"yt",value:function(t,e){var n=t.fields||{};this.Et(e,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var o=i[r];this.Rt(o,e),this.It(n[o],e)}}},{key:"wt",value:function(t,e){var n=t.values||[];this.Et(e,50);var r,i=ta(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.It(o,e)}}catch(t){i.e(t)}finally{i.f()}}},{key:"gt",value:function(t,e){var n=this;this.Et(e,37),Ya.fromName(t).path.forEach((function(t){n.Et(e,60),n.St(t,e)}))}},{key:"Et",value:function(t,e){t.dt(e)}},{key:"Vt",value:function(t){t.dt(2)}}]),t}();Ll.bt=new Ll;var Pl=function(){function t(){da(this,t),this._n=new Rl}return pa(t,[{key:"addToCollectionParentIndex",value:function(t,e){return this._n.add(e),ou.resolve()}},{key:"getCollectionParents",value:function(t,e){return ou.resolve(this._n.getEntries(e))}},{key:"addFieldIndex",value:function(t,e){return ou.resolve()}},{key:"deleteFieldIndex",value:function(t,e){return ou.resolve()}},{key:"deleteAllFieldIndexes",value:function(t){return ou.resolve()}},{key:"createTargetIndexes",value:function(t,e){return ou.resolve()}},{key:"getDocumentsMatchingTarget",value:function(t,e){return ou.resolve(null)}},{key:"getIndexType",value:function(t,e){return ou.resolve(0)}},{key:"getFieldIndexes",value:function(t,e){return ou.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(t){return ou.resolve(null)}},{key:"getMinOffset",value:function(t,e){return ou.resolve(Za.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(t,e){return ou.resolve(Za.min())}},{key:"updateCollectionGroup",value:function(t,e,n){return ou.resolve()}},{key:"updateIndexEntries",value:function(t,e){return ou.resolve()}}]),t}(),Rl=function(){function t(){da(this,t),this.index={}}return pa(t,[{key:"add",value:function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new xu(Qa.comparator),i=!r.has(n);return this.index[e]=r.add(n),i}},{key:"has",value:function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}},{key:"getEntries",value:function(t){return(this.index[t]||new xu(Qa.comparator)).toArray()}}]),t}();new Uint8Array(0);var Ml=function(){function t(e,n,r){da(this,t),this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return pa(t,null,[{key:"withCacheSize",value:function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),t}();Ml.DEFAULT_COLLECTION_PERCENTILE=10,Ml.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ml.DEFAULT=new Ml(41943040,Ml.DEFAULT_COLLECTION_PERCENTILE,Ml.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ml.DISABLED=new Ml(-1,0,0);var jl=function(){function t(e){da(this,t),this.On=e}return pa(t,[{key:"next",value:function(){return this.On+=2,this.On}}],[{key:"Nn",value:function(){return new t(0)}},{key:"Bn",value:function(){return new t(-1)}}]),t}(),Fl=function(){function t(){da(this,t),this.changes=new qs((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return pa(t,[{key:"addEntry",value:function(t){this.assertNotApplied(),this.changes.set(t.key,t)}},{key:"removeEntry",value:function(t,e){this.assertNotApplied(),this.changes.set(t,rs.newInvalidDocument(t).setReadTime(e))}},{key:"getEntry",value:function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?ou.resolve(n):this.getFromCache(t,e)}},{key:"getEntries",value:function(t,e){return this.getAllFromCache(t,e)}},{key:"apply",value:function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}},{key:"assertNotApplied",value:function(){}}]),t}(),Vl=pa((function t(e,n){da(this,t),this.overlayedDocument=e,this.mutatedFields=n})),Ul=function(){function t(e,n,r,i){da(this,t),this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return pa(t,[{key:"getDocument",value:function(t,e){var n=this,r=null;return this.documentOverlayCache.getOverlay(t,e).next((function(i){return r=i,n.remoteDocumentCache.getEntry(t,e)})).next((function(t){return null!==r&&Ec(r.mutation,t,Cu.empty(),Ga.now()),t}))}},{key:"getDocuments",value:function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next((function(e){return n.getLocalViewOfDocuments(t,e,Zs()).next((function(){return e}))}))}},{key:"getLocalViewOfDocuments",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Zs(),i=Ws();return this.populateOverlays(t,i,e).next((function(){return n.computeViews(t,e,i,r).next((function(t){var e=Hs();return t.forEach((function(t,n){e=e.insert(t,n.overlayedDocument)})),e}))}))}},{key:"getOverlayedDocuments",value:function(t,e){var n=this,r=Ws();return this.populateOverlays(t,r,e).next((function(){return n.computeViews(t,e,r,Zs())}))}},{key:"populateOverlays",value:function(t,e,n){var r=[];return n.forEach((function(t){e.has(t)||r.push(t)})),this.documentOverlayCache.getOverlays(t,r).next((function(t){t.forEach((function(t,n){e.set(t,n)}))}))}},{key:"computeViews",value:function(t,e,n,r){var i=Gs(),o=Ys(),a=Ys();return e.forEach((function(t,e){var a=n.get(e.key);r.has(e.key)&&(void 0===a||a.mutation instanceof xc)?i=i.insert(e.key,e):void 0!==a?(o.set(e.key,a.mutation.getFieldMask()),Ec(a.mutation,e,a.mutation.getFieldMask(),Ga.now())):o.set(e.key,Cu.empty())})),this.recalculateAndSaveOverlays(t,i).next((function(t){return t.forEach((function(t,e){return o.set(t,e)})),e.forEach((function(t,e){var n;return a.set(t,new Vl(e,null!==(n=o.get(t))&&void 0!==n?n:null))})),a}))}},{key:"recalculateAndSaveOverlays",value:function(t,e){var n=this,r=Ys(),i=new _u((function(t,e){return t-e})),o=Zs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){var n,o=ta(t);try{var a=function(){var t=n.value;t.keys().forEach((function(n){var o=e.get(n);if(null!==o){var a=r.get(n)||Cu.empty();a=t.applyToLocalView(o,a),r.set(n,a);var u=(i.get(t.batchId)||Zs()).add(n);i=i.insert(t.batchId,u)}}))};for(o.s();!(n=o.n()).done;)a()}catch(t){o.e(t)}finally{o.f()}})).next((function(){for(var a=[],u=i.getReverseIterator(),s=function(){var i=u.getNext(),s=i.key,c=i.value,l=Xs();c.forEach((function(t){if(!o.has(t)){var n=kc(e.get(t),r.get(t));null!==n&&l.set(t,n),o=o.add(t)}})),a.push(n.documentOverlayCache.saveOverlays(t,s,l))};u.hasNext();)s();return ou.waitFor(a)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next((function(e){return n.recalculateAndSaveOverlays(t,e)}))}},{key:"getDocumentsMatchingQuery",value:function(t,e,n,r){return function(t){return Ya.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,r):this.getDocumentsMatchingCollectionQuery(t,e,n,r)}},{key:"getNextDocuments",value:function(t,e,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,r).next((function(o){var a=r-o.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,r-o.size):ou.resolve(Ws()),u=-1,s=o;return a.next((function(e){return ou.forEach(e,(function(e,n){return u<n.largestBatchId&&(u=n.largestBatchId),o.get(e)?ou.resolve():i.remoteDocumentCache.getEntry(t,e).next((function(t){s=s.insert(e,t)}))})).next((function(){return i.populateOverlays(t,e,o)})).next((function(){return i.computeViews(t,s,e,Zs())})).next((function(t){return{batchId:u,changes:Qs(t)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(t,e){return this.getDocument(t,new Ya(e)).next((function(t){var e=Hs();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(t,e,n,r){var i=this,o=e.collectionGroup,a=Hs();return this.indexManager.getCollectionParents(t,o).next((function(u){return ou.forEach(u,(function(u){var s=function(t,e){return new Ds(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,u.child(o));return i.getDocumentsMatchingCollectionQuery(t,s,n,r).next((function(t){t.forEach((function(t,e){a=a.insert(t,e)}))}))})).next((function(){return a}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(t,e,n,r){var i,o=this;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((function(a){return i=a,o.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,i,r)})).next((function(t){i.forEach((function(e,n){var r=n.getKey();null===t.get(r)&&(t=t.insert(r,rs.newInvalidDocument(r)))}));var n=Hs();return t.forEach((function(t,r){var o=i.get(t);void 0!==o&&Ec(o.mutation,r,Cu.empty(),Ga.now()),Vs(e,r)&&(n=n.insert(t,r))})),n}))}}]),t}(),Bl=function(){function t(e){da(this,t),this.serializer=e,this.cr=new Map,this.lr=new Map}return pa(t,[{key:"getBundleMetadata",value:function(t,e){return ou.resolve(this.cr.get(e))}},{key:"saveBundleMetadata",value:function(t,e){return this.cr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:sl(t.createTime)}}(e)),ou.resolve()}},{key:"getNamedQuery",value:function(t,e){return ou.resolve(this.lr.get(e))}},{key:"saveNamedQuery",value:function(t,e){return this.lr.set(e.name,function(t){return{name:t.name,query:Nl(t.bundledQuery),readTime:sl(t.readTime)}}(e)),ou.resolve()}}]),t}(),ql=function(){function t(){da(this,t),this.overlays=new _u(Ya.comparator),this.hr=new Map}return pa(t,[{key:"getOverlay",value:function(t,e){return ou.resolve(this.overlays.get(e))}},{key:"getOverlays",value:function(t,e){var n=this,r=Ws();return ou.forEach(e,(function(e){return n.getOverlay(t,e).next((function(t){null!==t&&r.set(e,t)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(t,e,n){var r=this;return n.forEach((function(n,i){r.ht(t,e,i)})),ou.resolve()}},{key:"removeOverlaysForBatchId",value:function(t,e,n){var r=this,i=this.hr.get(n);return void 0!==i&&(i.forEach((function(t){return r.overlays=r.overlays.remove(t)})),this.hr.delete(n)),ou.resolve()}},{key:"getOverlaysForCollection",value:function(t,e,n){for(var r=Ws(),i=e.length+1,o=new Ya(e.child("")),a=this.overlays.getIteratorFrom(o);a.hasNext();){var u=a.getNext().value,s=u.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return ou.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(t,e,n,r){for(var i=new _u((function(t,e){return t-e})),o=this.overlays.getIterator();o.hasNext();){var a=o.getNext().value;if(a.getKey().getCollectionGroup()===e&&a.largestBatchId>n){var u=i.get(a.largestBatchId);null===u&&(u=Ws(),i=i.insert(a.largestBatchId,u)),u.set(a.getKey(),a)}}for(var s=Ws(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(t,e){return s.set(t,e)})),!(s.size()>=r)););return ou.resolve(s)}},{key:"ht",value:function(t,e,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new Mc(e,n));var o=this.hr.get(e);void 0===o&&(o=Zs(),this.hr.set(e,o)),this.hr.set(e,o.add(n.key))}}]),t}(),zl=function(){function t(){da(this,t),this.Pr=new xu(Gl.Ir),this.Tr=new xu(Gl.Er)}return pa(t,[{key:"isEmpty",value:function(){return this.Pr.isEmpty()}},{key:"addReference",value:function(t,e){var n=new Gl(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}},{key:"dr",value:function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))}},{key:"removeReference",value:function(t,e){this.Ar(new Gl(t,e))}},{key:"Rr",value:function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))}},{key:"Vr",value:function(t){var e=this,n=new Ya(new Qa([])),r=new Gl(n,t),i=new Gl(n,t+1),o=[];return this.Tr.forEachInRange([r,i],(function(t){e.Ar(t),o.push(t.key)})),o}},{key:"mr",value:function(){var t=this;this.Pr.forEach((function(e){return t.Ar(e)}))}},{key:"Ar",value:function(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}},{key:"gr",value:function(t){var e=new Ya(new Qa([])),n=new Gl(e,t),r=new Gl(e,t+1),i=Zs();return this.Tr.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i}},{key:"containsKey",value:function(t){var e=new Gl(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}]),t}(),Gl=function(){function t(e,n){da(this,t),this.key=e,this.pr=n}return pa(t,null,[{key:"Ir",value:function(t,e){return Ya.comparator(t.key,e.key)||qa(t.pr,e.pr)}},{key:"Er",value:function(t,e){return qa(t.pr,e.pr)||Ya.comparator(t.key,e.key)}}]),t}(),Kl=function(){function t(e,n){da(this,t),this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new xu(Gl.Ir)}return pa(t,[{key:"checkEmpty",value:function(t){return ou.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(t,e,n,r){var i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var o=new Pc(i,e,n,r);this.mutationQueue.push(o);var a,u=ta(r);try{for(u.s();!(a=u.n()).done;){var s=a.value;this.wr=this.wr.add(new Gl(s.key,i)),this.indexManager.addToCollectionParentIndex(t,s.key.path.popLast())}}catch(t){u.e(t)}finally{u.f()}return ou.resolve(o)}},{key:"lookupMutationBatch",value:function(t,e){return ou.resolve(this.Sr(e))}},{key:"getNextMutationBatchAfterBatchId",value:function(t,e){var n=e+1,r=this.br(n),i=r<0?0:r;return ou.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return ou.resolve(0===this.mutationQueue.length?-1:this.yr-1)}},{key:"getAllMutationBatches",value:function(t){return ou.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(t,e){var n=this,r=new Gl(e,0),i=new Gl(e,Number.POSITIVE_INFINITY),o=[];return this.wr.forEachInRange([r,i],(function(t){var e=n.Sr(t.pr);o.push(e)})),ou.resolve(o)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(t,e){var n=this,r=new xu(qa);return e.forEach((function(t){var e=new Gl(t,0),i=new Gl(t,Number.POSITIVE_INFINITY);n.wr.forEachInRange([e,i],(function(t){r=r.add(t.pr)}))})),ou.resolve(this.Dr(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(t,e){var n=e.path,r=n.length+1,i=n;Ya.isDocumentKey(i)||(i=i.child(""));var o=new Gl(new Ya(i),0),a=new xu(qa);return this.wr.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.pr)),!0)}),o),ou.resolve(this.Dr(a))}},{key:"Dr",value:function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Sr(t);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(t,e){var n=this;Ia(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();var r=this.wr;return ou.forEach(e.mutations,(function(i){var o=new Gl(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.wr=r}))}},{key:"Mn",value:function(t){}},{key:"containsKey",value:function(t,e){var n=new Gl(e,0),r=this.wr.firstAfterOrEqual(n);return ou.resolve(e.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(t){return this.mutationQueue.length,ou.resolve()}},{key:"Cr",value:function(t,e){return this.br(t)}},{key:"br",value:function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}},{key:"Sr",value:function(t){var e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}]),t}(),Hl=function(){function t(e){da(this,t),this.vr=e,this.docs=new _u(Ya.comparator),this.size=0}return pa(t,[{key:"setIndexManager",value:function(t){this.indexManager=t}},{key:"addEntry",value:function(t,e){var n=e.key,r=this.docs.get(n),i=r?r.size:0,o=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}},{key:"removeEntry",value:function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}},{key:"getEntry",value:function(t,e){var n=this.docs.get(e);return ou.resolve(n?n.document.mutableCopy():rs.newInvalidDocument(e))}},{key:"getEntries",value:function(t,e){var n=this,r=Gs();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.mutableCopy():rs.newInvalidDocument(t))})),ou.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(t,e,n,r){for(var i=Gs(),o=e.path,a=new Ya(o.child("")),u=this.docs.getIteratorFrom(a);u.hasNext();){var s=u.getNext(),c=s.key,l=s.value.document;if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||tu($a(l),n)<=0||(r.has(l.key)||Vs(e,l))&&(i=i.insert(l.key,l.mutableCopy()))}return ou.resolve(i)}},{key:"getAllFromCollectionGroup",value:function(t,e,n,r){xa()}},{key:"Fr",value:function(t,e){return ou.forEach(this.docs,(function(t){return e(t)}))}},{key:"newChangeBuffer",value:function(t){return new Ql(this)}},{key:"getSize",value:function(t){return ou.resolve(this.size)}}]),t}(),Ql=function(t){function e(t){var n;return da(this,e),(n=ia(this,e)).ar=t,n}return ua(e,t),pa(e,[{key:"applyChanges",value:function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(e.ar.addEntry(t,i)):e.ar.removeEntry(r)})),ou.waitFor(n)}},{key:"getFromCache",value:function(t,e){return this.ar.getEntry(t,e)}},{key:"getAllFromCache",value:function(t,e){return this.ar.getEntries(t,e)}}]),e}(Fl),Wl=function(){function t(e){da(this,t),this.persistence=e,this.Mr=new qs((function(t){return Is(t)}),Cs),this.lastRemoteSnapshotVersion=Ka.min(),this.highestTargetId=0,this.Or=0,this.Nr=new zl,this.targetCount=0,this.Br=jl.Nn()}return pa(t,[{key:"forEachTarget",value:function(t,e){return this.Mr.forEach((function(t,n){return e(n)})),ou.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(t){return ou.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(t){return ou.resolve(this.Or)}},{key:"allocateTargetId",value:function(t){return this.highestTargetId=this.Br.next(),ou.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),ou.resolve()}},{key:"qn",value:function(t){this.Mr.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Br=new jl(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}},{key:"addTargetData",value:function(t,e){return this.qn(e),this.targetCount+=1,ou.resolve()}},{key:"updateTargetData",value:function(t,e){return this.qn(e),ou.resolve()}},{key:"removeTargetData",value:function(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,ou.resolve()}},{key:"removeTargets",value:function(t,e,n){var r=this,i=0,o=[];return this.Mr.forEach((function(a,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.Mr.delete(a),o.push(r.removeMatchingKeysForTargetId(t,u.targetId)),i++)})),ou.waitFor(o).next((function(){return i}))}},{key:"getTargetCount",value:function(t){return ou.resolve(this.targetCount)}},{key:"getTargetData",value:function(t,e){var n=this.Mr.get(e)||null;return ou.resolve(n)}},{key:"addMatchingKeys",value:function(t,e,n){return this.Nr.dr(e,n),ou.resolve()}},{key:"removeMatchingKeys",value:function(t,e,n){this.Nr.Rr(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),ou.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(t,e){return this.Nr.Vr(e),ou.resolve()}},{key:"getMatchingKeysForTargetId",value:function(t,e){var n=this.Nr.gr(e);return ou.resolve(n)}},{key:"containsKey",value:function(t,e){return ou.resolve(this.Nr.containsKey(e))}}]),t}(),Xl=function(){function t(e,n){var r=this;da(this,t),this.Lr={},this.overlays={},this.kr=new pu(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Wl(this),this.indexManager=new Pl,this.remoteDocumentCache=new Hl((function(t){return r.referenceDelegate.Kr(t)})),this.serializer=new Ol(n),this.$r=new Bl(this.serializer)}return pa(t,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.qr=!1,Promise.resolve()}},{key:"started",get:function(){return this.qr}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(t){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(t){var e=this.overlays[t.toKey()];return e||(e=new ql,this.overlays[t.toKey()]=e),e}},{key:"getMutationQueue",value:function(t,e){var n=this.Lr[t.toKey()];return n||(n=new Kl(e,this.referenceDelegate),this.Lr[t.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Qr}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.$r}},{key:"runTransaction",value:function(t,e,n){var r=this;Ea("MemoryPersistence","Starting transaction:",t);var i=new Yl(this.kr.next());return this.referenceDelegate.Ur(),n(i).next((function(t){return r.referenceDelegate.Wr(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))}},{key:"Gr",value:function(t,e){return ou.or(Object.values(this.Lr).map((function(n){return function(){return n.containsKey(t,e)}})))}}]),t}(),Yl=function(t){function e(t){var n;return da(this,e),(n=ia(this,e)).currentSequenceNumber=t,n}return ua(e,t),pa(e)}(nu),Jl=function(){function t(e){da(this,t),this.persistence=e,this.zr=new zl,this.jr=null}return pa(t,[{key:"Jr",get:function(){if(this.jr)return this.jr;throw xa()}},{key:"addReference",value:function(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),ou.resolve()}},{key:"removeReference",value:function(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),ou.resolve()}},{key:"markPotentiallyOrphaned",value:function(t,e){return this.Jr.add(e.toString()),ou.resolve()}},{key:"removeTarget",value:function(t,e){var n=this;this.zr.Vr(e.targetId).forEach((function(t){return n.Jr.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.Jr.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))}},{key:"Ur",value:function(){this.jr=new Set}},{key:"Wr",value:function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ou.forEach(this.Jr,(function(r){var i=Ya.fromPath(r);return e.Yr(t,i).next((function(t){t||n.removeEntry(i,Ka.min())}))})).next((function(){return e.jr=null,n.apply(t)}))}},{key:"updateLimboDocument",value:function(t,e){var n=this;return this.Yr(t,e).next((function(t){t?n.Jr.delete(e.toString()):n.Jr.add(e.toString())}))}},{key:"Kr",value:function(t){return 0}},{key:"Yr",value:function(t,e){var n=this;return ou.or([function(){return ou.resolve(n.zr.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Gr(t,e)}])}}],[{key:"Hr",value:function(e){return new t(e)}}]),t}(),$l=function(){function t(e,n,r,i){da(this,t),this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}return pa(t,null,[{key:"Ki",value:function(e,n){var r,i=Zs(),o=Zs(),a=ta(n.docChanges);try{for(a.s();!(r=a.n()).done;){var u=r.value;switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:o=o.add(u.doc.key)}}}catch(t){a.e(t)}finally{a.f()}return new t(e,n.fromCache,i,o)}}]),t}(),Zl=function(){function t(){da(this,t),this._documentReadCount=0}return pa(t,[{key:"documentReadCount",get:function(){return this._documentReadCount}},{key:"incrementDocumentReadCount",value:function(t){this._documentReadCount+=t}}]),t}(),th=function(){function t(){da(this,t),this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=!function(){var t,e=null===(t=g())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()&&navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?8:uu.v(k())>0?6:4}return pa(t,[{key:"initialize",value:function(t,e){this.zi=t,this.indexManager=e,this.$i=!0}},{key:"getDocumentsMatchingQuery",value:function(t,e,n,r){var i=this,o={result:null};return this.ji(t,e).next((function(t){o.result=t})).next((function(){if(!o.result)return i.Hi(t,e,r,n).next((function(t){o.result=t}))})).next((function(){if(!o.result){var n=new Zl;return i.Ji(t,e,n).next((function(r){if(o.result=r,i.Ui)return i.Yi(t,e,n,r.size)}))}})).next((function(){return o.result}))}},{key:"Yi",value:function(t,e,n,r){return n.documentReadCount<this.Wi?(ba()<=W.DEBUG&&Ea("QueryEngine","SDK will not create cache indexes for query:",Fs(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),ou.resolve()):(ba()<=W.DEBUG&&Ea("QueryEngine","Query:",Fs(e),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(ba()<=W.DEBUG&&Ea("QueryEngine","The SDK decides to create cache indexes for query:",Fs(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ps(e))):ou.resolve())}},{key:"ji",value:function(t,e){var n=this;if(Ns(e))return ou.resolve(null);var r=Ps(e);return this.indexManager.getIndexType(t,r).next((function(i){return 0===i?null:(null!==e.limit&&1===i&&(e=Rs(e,null,"F"),r=Ps(e)),n.indexManager.getDocumentsMatchingTarget(t,r).next((function(i){var o=Zs.apply(void 0,ca(i));return n.zi.getDocuments(t,o).next((function(i){return n.indexManager.getMinOffset(t,r).next((function(r){var a=n.Zi(e,i);return n.Xi(e,a,o,r.readTime)?n.ji(t,Rs(e,null,"F")):n.es(t,a,e,r)}))}))})))}))}},{key:"Hi",value:function(t,e,n,r){var i=this;return Ns(e)||r.isEqual(Ka.min())?ou.resolve(null):this.zi.getDocuments(t,n).next((function(o){var a=i.Zi(e,o);return i.Xi(e,a,n,r)?ou.resolve(null):(ba()<=W.DEBUG&&Ea("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Fs(e)),i.es(t,a,e,function(t,e){var n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ka.fromTimestamp(1e9===r?new Ga(n+1,0):new Ga(n,r));return new Za(i,Ya.empty(),e)}(r,-1)).next((function(t){return t})))}))}},{key:"Zi",value:function(t,e){var n=new xu(Us(t));return e.forEach((function(e,r){Vs(t,r)&&(n=n.add(r))})),n}},{key:"Xi",value:function(t,e,n,r){if(null===t.limit)return!1;if(n.size!==e.size)return!0;var i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Ji",value:function(t,e,n){return ba()<=W.DEBUG&&Ea("QueryEngine","Using full collection scan to execute query:",Fs(e)),this.zi.getDocumentsMatchingQuery(t,e,Za.min(),n)}},{key:"es",value:function(t,e,n,r){return this.zi.getDocumentsMatchingQuery(t,n,r).next((function(t){return e.forEach((function(e){t=t.insert(e.key,e)})),t}))}}]),t}(),eh=function(){function t(e,n,r,i){da(this,t),this.persistence=e,this.ts=n,this.serializer=i,this.ns=new _u(qa),this.rs=new qs((function(t){return Is(t)}),Cs),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}return pa(t,[{key:"_s",value:function(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Ul(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.ns)}))}}]),t}();function nh(t,e){return rh.apply(this,arguments)}function rh(){return rh=ra(ea().mark((function t(e,n){var r;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Ca(e),t.next=3,r.persistence.runTransaction("Handle user change","readonly",(function(t){var e;return r.mutationQueue.getAllMutationBatches(t).next((function(i){return e=i,r._s(n),r.mutationQueue.getAllMutationBatches(t)})).next((function(n){var i,o=[],a=[],u=Zs(),s=ta(e);try{for(s.s();!(i=s.n()).done;){var c=i.value;o.push(c.batchId);var l,h=ta(c.mutations);try{for(h.s();!(l=h.n()).done;){var f=l.value;u=u.add(f.key)}}catch(t){h.e(t)}finally{h.f()}}}catch(t){s.e(t)}finally{s.f()}var d,v=ta(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;a.push(p.batchId);var y,g=ta(p.mutations);try{for(g.s();!(y=g.n()).done;){var m=y.value;u=u.add(m.key)}}catch(t){g.e(t)}finally{g.f()}}}catch(t){v.e(t)}finally{v.f()}return r.localDocuments.getDocuments(t,u).next((function(t){return{us:t,removedBatchIds:o,addedBatchIds:a}}))}))}));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),rh.apply(this,arguments)}function ih(t,e){var n=Ca(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),a=ou.resolve();return o.forEach((function(t){a=a.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);Ia(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),r.addEntry(e)))}))})),a.next((function(){return t.mutationQueue.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.mutationQueue.performConsistencyCheck(t)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(t,r,e.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){for(var e=Zs(),n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e))})).next((function(){return n.localDocuments.getDocuments(t,r)}))}))}function oh(t){var e=Ca(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.Qr.getLastRemoteSnapshotVersion(t)}))}function ah(t,e){var n=Ca(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;var a=[];e.targetChanges.forEach((function(o,u){var s=i.get(u);if(s){a.push(n.Qr.removeMatchingKeys(t,o.removedDocuments,u).next((function(){return n.Qr.addMatchingKeys(t,o.addedDocuments,u)})));var c=s.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(u)?c=c.withResumeToken(Du.EMPTY_BYTE_STRING,Ka.min()).withLastLimboFreeSnapshotVersion(Ka.min()):o.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(o.resumeToken,r)),i=i.insert(u,c),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,c,o)&&a.push(n.Qr.updateTargetData(t,c))}}));var u=Gs(),s=Zs();if(e.documentUpdates.forEach((function(r){e.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),a.push(function(t,e,n){var r=Zs(),i=Zs();return n.forEach((function(t){return r=r.add(t)})),e.getEntries(t,r).next((function(t){var r=Gs();return n.forEach((function(n,o){var a=t.get(n);o.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(n)),o.isNoDocument()&&o.version.isEqual(Ka.min())?(e.removeEntry(n,o.readTime),r=r.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(o),r=r.insert(n,o)):Ea("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)})),{cs:r,ls:i}}))}(t,o,e.documentUpdates).next((function(t){u=t.cs,s=t.ls}))),!r.isEqual(Ka.min())){var c=n.Qr.getLastRemoteSnapshotVersion(t).next((function(e){return n.Qr.setTargetsMetadata(t,t.currentSequenceNumber,r)}));a.push(c)}return ou.waitFor(a).next((function(){return o.apply(t)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(t,u,s)})).next((function(){return u}))})).then((function(t){return n.ns=i,t}))}function uh(t,e){var n=Ca(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e)}))}function sh(t,e){var n=Ca(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.Qr.getTargetData(t,e).next((function(i){return i?(r=i,ou.resolve(r)):n.Qr.allocateTargetId(t).next((function(i){return r=new Dl(e,i,"TargetPurposeListen",t.currentSequenceNumber),n.Qr.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.ns.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ns=n.ns.insert(t.targetId,t),n.rs.set(e,t.targetId)),t}))}function ch(t,e,n){return lh.apply(this,arguments)}function lh(){return lh=ra(ea().mark((function t(e,n,r){var i,o,a;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=Ca(e),o=i.ns.get(n),a=r?"readwrite":"readwrite-primary",t.prev=1,t.t0=r,t.t0){t.next=6;break}return t.next=6,i.persistence.runTransaction("Release target",a,(function(t){return i.persistence.referenceDelegate.removeTarget(t,o)}));case 6:t.next=13;break;case 8:if(t.prev=8,t.t1=t.catch(1),lu(t.t1)){t.next=12;break}throw t.t1;case 12:Ea("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(t.t1));case 13:i.ns=i.ns.remove(n),i.rs.delete(o.target);case 14:case"end":return t.stop()}}),t,null,[[1,8]])}))),lh.apply(this,arguments)}function hh(t,e,n){var r=Ca(t),i=Ka.min(),o=Zs();return r.persistence.runTransaction("Execute query","readwrite",(function(t){return function(t,e,n){var r=Ca(t),i=r.rs.get(n);return void 0!==i?ou.resolve(r.ns.get(i)):r.Qr.getTargetData(e,n)}(r,t,Ps(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.ts.getDocumentsMatchingQuery(t,e,n?i:Ka.min(),n?o:Zs())})).next((function(t){return function(t,e,n){var r=t.ss.get(e)||Ka.min();n.forEach((function(t,e){e.readTime.compareTo(r)>0&&(r=e.readTime)})),t.ss.set(e,r)}(r,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,hs:o}}))}))}var fh=function(){function t(){da(this,t),this.activeTargetIds=tc}return pa(t,[{key:"As",value:function(t){this.activeTargetIds=this.activeTargetIds.add(t)}},{key:"Rs",value:function(t){this.activeTargetIds=this.activeTargetIds.delete(t)}},{key:"ds",value:function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}]),t}(),dh=function(){function t(){da(this,t),this.no=new fh,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return pa(t,[{key:"addPendingMutation",value:function(t){}},{key:"updateMutationState",value:function(t,e,n){}},{key:"addLocalQueryTarget",value:function(t){return this.no.As(t),this.ro[t]||"not-current"}},{key:"updateQueryState",value:function(t,e,n){this.ro[t]=e}},{key:"removeLocalQueryTarget",value:function(t){this.no.Rs(t)}},{key:"isLocalQueryTarget",value:function(t){return this.no.activeTargetIds.has(t)}},{key:"clearQueryState",value:function(t){delete this.ro[t]}},{key:"getAllActiveQueryTargets",value:function(){return this.no.activeTargetIds}},{key:"isActiveQueryTarget",value:function(t){return this.no.activeTargetIds.has(t)}},{key:"start",value:function(){return this.no=new fh,Promise.resolve()}},{key:"handleUserChange",value:function(t,e,n){}},{key:"setOnlineState",value:function(t){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(t){}},{key:"notifyBundleLoaded",value:function(t){}}]),t}(),vh=function(){function t(){da(this,t)}return pa(t,[{key:"io",value:function(t){}},{key:"shutdown",value:function(){}}]),t}(),ph=function(){function t(){var e=this;da(this,t),this.so=function(){return e.oo()},this._o=function(){return e.ao()},this.uo=[],this.co()}return pa(t,[{key:"io",value:function(t){this.uo.push(t)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}},{key:"co",value:function(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}},{key:"oo",value:function(){Ea("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var t,e=ta(this.uo);try{for(e.s();!(t=e.n()).done;)(0,t.value)(0)}catch(t){e.e(t)}finally{e.f()}}},{key:"ao",value:function(){Ea("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var t,e=ta(this.uo);try{for(e.s();!(t=e.n()).done;)(0,t.value)(1)}catch(t){e.e(t)}finally{e.f()}}}],[{key:"D",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),t}(),yh=null;function gh(){return null===yh?yh=268435456+Math.round(2147483648*Math.random()):yh++,"0x"+yh.toString(16)}var mh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},wh=function(){function t(e){da(this,t),this.lo=e.lo,this.ho=e.ho}return pa(t,[{key:"Po",value:function(t){this.Io=t}},{key:"To",value:function(t){this.Eo=t}},{key:"onMessage",value:function(t){this.Ao=t}},{key:"close",value:function(){this.ho()}},{key:"send",value:function(t){this.lo(t)}},{key:"Ro",value:function(){this.Io()}},{key:"Vo",value:function(t){this.Eo(t)}},{key:"mo",value:function(t){this.Ao(t)}}]),t}(),kh="WebChannelConnection",bh=function(t){function e(t){var n;return da(this,e),(n=ia(this,e,[t])).forceLongPolling=t.forceLongPolling,n.autoDetectLongPolling=t.autoDetectLongPolling,n.useFetchStreams=t.useFetchStreams,n.longPollingOptions=t.longPollingOptions,n}return ua(e,t),pa(e,[{key:"Co",value:function(t,e,n,r){var i=gh();return new Promise((function(o,a){var u=new Qo;u.setWithCredentials(!0),u.listenOnce(zo.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case qo.NO_ERROR:var e=u.getResponseJson();Ea(kh,"XHR for RPC '".concat(t,"' ").concat(i," received:"),JSON.stringify(e)),o(e);break;case qo.TIMEOUT:Ea(kh,"RPC '".concat(t,"' ").concat(i," timed out")),a(new Da(Aa.DEADLINE_EXCEEDED,"Request time out"));break;case qo.HTTP_ERROR:var n=u.getStatus();if(Ea(kh,"RPC '".concat(t,"' ").concat(i," failed with status:"),n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson();Array.isArray(r)&&(r=r[0]);var s=null==r?void 0:r.error;if(s&&s.status&&s.message){var c=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Aa).indexOf(e)>=0?e:Aa.UNKNOWN}(s.status);a(new Da(c,s.message))}else a(new Da(Aa.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new Da(Aa.UNAVAILABLE,"Connection failed."));break;default:xa()}}finally{Ea(kh,"RPC '".concat(t,"' ").concat(i," completed."))}}));var s=JSON.stringify(r);Ea(kh,"RPC '".concat(t,"' ").concat(i," sending request:"),r),u.send(e,"POST",s,n,15)}))}},{key:"Fo",value:function(t,e,n){var r=gh(),i=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Uo(),a=Bo(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},s=this.longPollingOptions.timeoutSeconds;void 0!==s&&(u.longPollingTimeout=Math.round(1e3*s)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Do(u.initMessageHeaders,e,n),u.encodeInitMessageHeaders=!0;var c=i.join("");Ea(kh,"Creating RPC '".concat(t,"' stream ").concat(r,": ").concat(c),u);var l=o.createWebChannel(c,u),h=!1,f=!1,d=new wh({lo:function(e){f?Ea(kh,"Not sending because RPC '".concat(t,"' stream ").concat(r," is closed:"),e):(h||(Ea(kh,"Opening RPC '".concat(t,"' stream ").concat(r," transport.")),l.open(),h=!0),Ea(kh,"RPC '".concat(t,"' stream ").concat(r," sending:"),e),l.send(e))},ho:function(){return l.close()}}),v=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return v(l,Ho.EventType.OPEN,(function(){f||Ea(kh,"RPC '".concat(t,"' stream ").concat(r," transport opened."))})),v(l,Ho.EventType.CLOSE,(function(){f||(f=!0,Ea(kh,"RPC '".concat(t,"' stream ").concat(r," transport closed")),d.Vo())})),v(l,Ho.EventType.ERROR,(function(e){f||(f=!0,Sa(kh,"RPC '".concat(t,"' stream ").concat(r," transport errored:"),e),d.Vo(new Da(Aa.UNAVAILABLE,"The operation could not be completed")))})),v(l,Ho.EventType.MESSAGE,(function(e){var n;if(!f){var i=e.data[0];Ia(!!i);var o=i,a=o.error||(null===(n=o[0])||void 0===n?void 0:n.error);if(a){Ea(kh,"RPC '".concat(t,"' stream ").concat(r," received error:"),a);var u=a.status,s=function(t){var e=Dc[t];if(void 0!==e)return Vc(e)}(u),c=a.message;void 0===s&&(s=Aa.INTERNAL,c="Unknown error status: "+u+" with message "+a.message),f=!0,d.Vo(new Da(s,c)),l.close()}else Ea(kh,"RPC '".concat(t,"' stream ").concat(r," received:"),i),d.mo(i)}})),v(a,Go.STAT_EVENT,(function(e){e.stat===Ko.PROXY?Ea(kh,"RPC '".concat(t,"' stream ").concat(r," detected buffering proxy")):e.stat===Ko.NOPROXY&&Ea(kh,"RPC '".concat(t,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((function(){d.Ro()}),0),d}}]),e}(function(){function t(e){da(this,t),this.databaseInfo=e,this.databaseId=e.databaseId;var n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.fo=n+"://"+e.host,this.po="projects/".concat(r,"/databases/").concat(i),this.yo="(default)"===this.databaseId.database?"project_id=".concat(r):"project_id=".concat(r,"&database_id=").concat(i)}return pa(t,[{key:"wo",get:function(){return!1}},{key:"So",value:function(t,e,n,r,i){var o=gh(),a=this.bo(t,e.toUriEncodedString());Ea("RestConnection","Sending RPC '".concat(t,"' ").concat(o,":"),a,n);var u={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(u,r,i),this.Co(t,a,u,n).then((function(e){return Ea("RestConnection","Received RPC '".concat(t,"' ").concat(o,": "),e),e}),(function(e){throw Sa("RestConnection","RPC '".concat(t,"' ").concat(o," failed with error: "),e,"url: ",a,"request:",n),e}))}},{key:"vo",value:function(t,e,n,r,i,o){return this.So(t,e,n,r,i)}},{key:"Do",value:function(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+wa,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((function(e,n){return t[n]=e})),n&&n.headers.forEach((function(e,n){return t[n]=e}))}},{key:"bo",value:function(t,e){var n=mh[t];return"".concat(this.fo,"/v1/").concat(e,":").concat(n)}},{key:"terminate",value:function(){}}]),t}());function Eh(){return"undefined"!=typeof document?document:null}function _h(t){return new rl(t,!0)}var Sh=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;da(this,t),this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=o,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}return pa(t,[{key:"reset",value:function(){this.No=0}},{key:"ko",value:function(){this.No=this.Oo}},{key:"qo",value:function(t){var e=this;this.cancel();var n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),i=Math.max(0,n-r);i>0&&Ea("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.No," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,(function(){return e.Lo=Date.now(),t()})),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}},{key:"Ko",value:function(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}},{key:"cancel",value:function(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}},{key:"Qo",value:function(){return(Math.random()-.5)*this.No}}]),t}(),Th=function(){function t(e,n,r,i,o,a,u,s){da(this,t),this.oi=e,this.$o=r,this.Uo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=s,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Sh(e,n)}var e,n,r;return pa(t,[{key:"Ho",value:function(){return 1===this.state||5===this.state||this.Jo()}},{key:"Jo",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Yo()}},{key:"stop",value:(r=ra(ea().mark((function t(){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=this.Ho(),!t.t0){t.next=4;break}return t.next=4,this.close(0);case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"Zo",value:function(){this.state=0,this.jo.reset()}},{key:"Xo",value:function(){var t=this;this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(function(){return t.e_()})))}},{key:"t_",value:function(t){this.n_(),this.stream.send(t)}},{key:"e_",value:(n=ra(ea().mark((function t(){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.Jo()){t.next=2;break}return t.abrupt("return",this.close(0));case 2:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"n_",value:function(){this.Go&&(this.Go.cancel(),this.Go=null)}},{key:"r_",value:function(){this.zo&&(this.zo.cancel(),this.zo=null)}},{key:"close",value:(e=ra(ea().mark((function t(e,n){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==e?this.jo.reset():n&&n.code===Aa.RESOURCE_EXHAUSTED?(_a(n.toString()),_a("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===Aa.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,t.next=9,this.listener.To(n);case 9:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"i_",value:function(){}},{key:"auth",value:function(){var t=this;this.state=1;var e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(e){var r=Jo(e,2),i=r[0],o=r[1];t.Wo===n&&t.o_(i,o)}),(function(n){e((function(){var e=new Da(Aa.UNKNOWN,"Fetching auth token failed: "+n.message);return t.__(e)}))}))}},{key:"o_",value:function(t,e){var n=this,r=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po((function(){r((function(){return n.state=2,n.zo=n.oi.enqueueAfterDelay(n.Uo,1e4,(function(){return n.Jo()&&(n.state=3),Promise.resolve()})),n.listener.Po()}))})),this.stream.To((function(t){r((function(){return n.__(t)}))})),this.stream.onMessage((function(t){r((function(){return n.onMessage(t)}))}))}},{key:"Yo",value:function(){var t=this;this.state=5,this.jo.qo(ra(ea().mark((function e(){return ea().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.state=0,t.start();case 1:case"end":return e.stop()}}),e)}))))}},{key:"__",value:function(t){return Ea("PersistentStream","close with error: ".concat(t)),this.stream=null,this.close(4,t)}},{key:"s_",value:function(t){var e=this;return function(n){e.oi.enqueueAndForget((function(){return e.Wo===t?n():(Ea("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),t}(),xh=function(t){function e(t,n,r,i,o,a){var u;return da(this,e),(u=ia(this,e,[t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a])).serializer=o,u}return ua(e,t),pa(e,[{key:"a_",value:function(t,e){return this.connection.Fo("Listen",t,e)}},{key:"onMessage",value:function(t){this.jo.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:xa()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.useProto3Json?(Ia(void 0===e||"string"==typeof e),Du.fromBase64String(e||"")):(Ia(void 0===e||e instanceof Uint8Array),Du.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(t){var e=void 0===t.code?Aa.UNKNOWN:Vc(t.code);return new Da(e,t.message||"")}(a);n=new Xc(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;var s=e.documentChange;s.document,s.document.name,s.document.updateTime;var c=dl(t,s.document.name),l=sl(s.document.updateTime),h=s.document.createTime?sl(s.document.createTime):Ka.min(),f=new es({mapValue:{fields:s.document.fields}}),d=rs.newFoundDocument(c,l,h,f),v=s.targetIds||[],p=s.removedTargetIds||[];n=new Qc(v,p,d.key,d)}else if("documentDelete"in e){e.documentDelete;var y=e.documentDelete;y.document;var g=dl(t,y.document),m=y.readTime?sl(y.readTime):Ka.min(),w=rs.newNoDocument(g,m),k=y.removedTargetIds||[];n=new Qc([],k,w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=dl(t,b.document),_=b.removedTargetIds||[];n=new Qc([],_,E,null)}else{if(!("filter"in e))return xa();e.filter;var S=e.filter;S.targetId;var T=S.count,x=void 0===T?0:T,I=S.unchangedNames,C=new jc(x,I),A=S.targetId;n=new Wc(A,C)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ka.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Ka.min():e.readTime?sl(e.readTime):Ka.min()}(t);return this.listener.u_(e,n)}},{key:"c_",value:function(t){var e={};e.database=pl(this.serializer),e.addTarget=function(t,e){var n,r=e.target;if((n=As(r)?{documents:ml(t,r)}:{query:wl(t,r).ut}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=al(t,e.resumeToken);var i=il(t,e.expectedCount);null!==i&&(n.expectedCount=i)}else if(e.snapshotVersion.compareTo(Ka.min())>0){n.readTime=ol(t,e.snapshotVersion.toTimestamp());var o=il(t,e.expectedCount);null!==o&&(n.expectedCount=o)}return n}(this.serializer,t);var n=function(t,e){var n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xa()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.t_(e)}},{key:"l_",value:function(t){var e={};e.database=pl(this.serializer),e.removeTarget=t,this.t_(e)}}]),e}(Th),Ih=function(t){function e(t,n,r,i,o,a){var u;return da(this,e),(u=ia(this,e,[t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a])).serializer=o,u.h_=!1,u}return ua(e,t),pa(e,[{key:"P_",get:function(){return this.h_}},{key:"start",value:function(){this.h_=!1,this.lastStreamToken=void 0,Yo(aa(e.prototype),"start",this).call(this)}},{key:"i_",value:function(){this.h_&&this.I_([])}},{key:"a_",value:function(t,e){return this.connection.Fo("Write",t,e)}},{key:"onMessage",value:function(t){if(Ia(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();var e=function(t,e){return t&&t.length>0?(Ia(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?sl(t.updateTime):sl(e);return n.isEqual(Ka.min())&&(n=sl(e)),new yc(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=sl(t.commitTime);return this.listener.T_(n,e)}return Ia(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}},{key:"d_",value:function(){var t={};t.database=pl(this.serializer),this.t_(t)}},{key:"I_",value:function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return function(t,e){var n;if(e instanceof Tc)n={update:gl(t,e.key,e.value)};else if(e instanceof Nc)n={delete:fl(t,e.key)};else if(e instanceof xc)n={update:gl(t,e.key,e.data),updateMask:Cl(e.fieldMask)};else{if(!(e instanceof Lc))return xa();n={verify:fl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof sc)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof cc)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof hc)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof dc)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw xa()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ul(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:xa()}(t,e.precondition)),n}(e.serializer,t)}))};this.t_(n)}}]),e}(Th),Ch=function(t){function e(t,n,r,i){var o;return da(this,e),(o=ia(this,e)).authCredentials=t,o.appCheckCredentials=n,o.connection=r,o.serializer=i,o.A_=!1,o}return ua(e,t),pa(e,[{key:"R_",value:function(){if(this.A_)throw new Da(Aa.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"So",value:function(t,e,n,r){var i=this;return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(o){var a=Jo(o,2),u=a[0],s=a[1];return i.connection.So(t,ll(e,n),r,u,s)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Aa.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),t):new Da(Aa.UNKNOWN,t.toString())}))}},{key:"vo",value:function(t,e,n,r,i){var o=this;return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var u=Jo(a,2),s=u[0],c=u[1];return o.connection.vo(t,ll(e,n),r,s,c,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Aa.UNAUTHENTICATED&&(o.authCredentials.invalidateToken(),o.appCheckCredentials.invalidateToken()),t):new Da(Aa.UNKNOWN,t.toString())}))}},{key:"terminate",value:function(){this.A_=!0,this.connection.terminate()}}]),e}(pa((function t(){da(this,t)}))),Ah=function(){function t(e,n){da(this,t),this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}return pa(t,[{key:"p_",value:function(){var t=this;0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.f_=null,t.w_("Backend didn't respond within 10 seconds."),t.y_("Offline"),Promise.resolve()})))}},{key:"S_",value:function(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_("Connection failed 1 times. Most recent error: ".concat(t.toString())),this.y_("Offline")))}},{key:"set",value:function(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}},{key:"y_",value:function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}},{key:"w_",value:function(t){var e="Could not reach Cloud Firestore backend. ".concat(t,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.g_?(_a(e),this.g_=!1):Ea("OnlineStateTracker",e)}},{key:"b_",value:function(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}]),t}(),Dh=pa((function t(e,n,r,i,o){var a=this;da(this,t),this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=o,this.M_.io((function(t){r.enqueueAndForget(ra(ea().mark((function t(){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=Bh(a),!t.t0){t.next=5;break}return Ea("RemoteStore","Restarting streams for network reachability change."),t.next=5,function(){var t=ra(ea().mark((function t(e){var n;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=Ca(e)).v_.add(4),t.next=4,Lh(n);case 4:return n.x_.set("Unknown"),n.v_.delete(4),t.next=8,Oh(n);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(a);case 5:case"end":return t.stop()}}),t)}))))})),this.x_=new Ah(r,i)}));function Oh(t){return Nh.apply(this,arguments)}function Nh(){return(Nh=ra(ea().mark((function t(e){var n,r,i;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Bh(e)){t.next=18;break}n=ta(e.F_),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=10;break}return i=r.value,t.next=8,i(!0);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[2,12,15,18]])})))).apply(this,arguments)}function Lh(t){return Ph.apply(this,arguments)}function Ph(){return(Ph=ra(ea().mark((function t(e){var n,r,i;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=ta(e.F_),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=9;break}return i=r.value,t.next=7,i(!1);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,11,14,17]])})))).apply(this,arguments)}function Rh(t,e){var n=Ca(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),Uh(n)?Vh(n):gf(n).Jo()&&jh(n,e))}function Mh(t,e){var n=Ca(t),r=gf(n);n.C_.delete(e),r.Jo()&&Fh(n,e),0===n.C_.size&&(r.Jo()?r.Xo():Bh(n)&&n.x_.set("Unknown"))}function jh(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ka.min())>0){var n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}gf(t).c_(e)}function Fh(t,e){t.O_.Oe(e),gf(t).l_(e)}function Vh(t){t.O_=new Jc({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},_t:function(e){return t.C_.get(e)||null},nt:function(){return t.datastore.serializer.databaseId}}),gf(t).start(),t.x_.p_()}function Uh(t){return Bh(t)&&!gf(t).Ho()&&t.C_.size>0}function Bh(t){return 0===Ca(t).v_.size}function qh(t){t.O_=void 0}function zh(t){return Gh.apply(this,arguments)}function Gh(){return(Gh=ra(ea().mark((function t(e){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.C_.forEach((function(t,n){jh(e,t)}));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Kh(t,e){return Hh.apply(this,arguments)}function Hh(){return(Hh=ra(ea().mark((function t(e,n){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:qh(e),Uh(e)?(e.x_.S_(n),Vh(e)):e.x_.set("Unknown");case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Qh(t,e,n){return Wh.apply(this,arguments)}function Wh(){return Wh=ra(ea().mark((function t(e,n,r){var i;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.x_.set("Online"),!(n instanceof Xc&&2===n.state&&n.cause)){t.next=13;break}return t.prev=1,t.next=4,function(){var t=ra(ea().mark((function t(e,n){var r,i,o,a;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.cause,i=ta(n.targetIds),t.prev=2,i.s();case 4:if((o=i.n()).done){t.next=14;break}if(a=o.value,t.t0=e.C_.has(a),!t.t0){t.next=12;break}return t.next=10,e.remoteSyncer.rejectListen(a,r);case 10:e.C_.delete(a),e.O_.removeTarget(a);case 12:t.next=4;break;case 14:t.next=19;break;case 16:t.prev=16,t.t1=t.catch(2),i.e(t.t1);case 19:return t.prev=19,i.f(),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[2,16,19,22]])})));return function(e,n){return t.apply(this,arguments)}}()(e,n);case 4:t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(1),Ea("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),t.t0),t.next=11,Xh(e,t.t0);case 11:case 22:t.next=29;break;case 13:if(n instanceof Qc?e.O_.$e(n):n instanceof Wc?e.O_.Je(n):e.O_.Ge(n),r.isEqual(Ka.min())){t.next=29;break}return t.prev=14,t.next=17,oh(e.localStore);case 17:if(i=t.sent,t.t1=r.compareTo(i)>=0,!t.t1){t.next=22;break}return t.next=22,function(t,e){var n=t.O_.it(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.C_.get(r);i&&t.C_.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e,n){var r=t.C_.get(e);if(r){t.C_.set(e,r.withResumeToken(Du.EMPTY_BYTE_STRING,r.snapshotVersion)),Fh(t,e);var i=new Dl(r.target,e,n,r.sequenceNumber);jh(t,i)}})),t.remoteSyncer.applyRemoteEvent(n)}(e,r);case 24:return t.prev=24,t.t2=t.catch(14),Ea("RemoteStore","Failed to raise snapshot:",t.t2),t.next=29,Xh(e,t.t2);case 29:case"end":return t.stop()}}),t,null,[[1,6],[14,24]])}))),Wh.apply(this,arguments)}function Xh(t,e,n){return Yh.apply(this,arguments)}function Yh(){return(Yh=ra(ea().mark((function t(e,n,r){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(lu(n)){t.next=2;break}throw n;case 2:return e.v_.add(1),t.next=5,Lh(e);case 5:e.x_.set("Offline"),r||(r=function(){return oh(e.localStore)}),e.asyncQueue.enqueueRetryable(ra(ea().mark((function t(){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ea("RemoteStore","Retrying IndexedDB access"),t.next=3,r();case 3:return e.v_.delete(1),t.next=6,Oh(e);case 6:case"end":return t.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Jh(t,e){return e().catch((function(n){return Xh(t,n,e)}))}function $h(t){return Zh.apply(this,arguments)}function Zh(){return Zh=ra(ea().mark((function t(e){var n,r,i,o;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Ca(e),r=mf(n),i=n.D_.length>0?n.D_[n.D_.length-1].batchId:-1;case 2:if(!tf(n)){t.next=19;break}return t.prev=3,t.next=6,uh(n.localStore,i);case 6:if(null!==(o=t.sent)){t.next=10;break}return 0===n.D_.length&&r.Xo(),t.abrupt("break",19);case 10:i=o.batchId,ef(n,o),t.next=17;break;case 13:return t.prev=13,t.t0=t.catch(3),t.next=17,Xh(n,t.t0);case 17:t.next=2;break;case 19:nf(n)&&rf(n);case 20:case"end":return t.stop()}}),t,null,[[3,13]])}))),Zh.apply(this,arguments)}function tf(t){return Bh(t)&&t.D_.length<10}function ef(t,e){t.D_.push(e);var n=mf(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function nf(t){return Bh(t)&&!mf(t).Ho()&&t.D_.length>0}function rf(t){mf(t).start()}function of(t){return af.apply(this,arguments)}function af(){return(af=ra(ea().mark((function t(e){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:mf(e).d_();case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function uf(t){return sf.apply(this,arguments)}function sf(){return(sf=ra(ea().mark((function t(e){var n,r,i,o;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=mf(e),r=ta(e.D_);try{for(r.s();!(i=r.n()).done;)o=i.value,n.I_(o.mutations)}catch(t){r.e(t)}finally{r.f()}case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function cf(t,e,n){return lf.apply(this,arguments)}function lf(){return lf=ra(ea().mark((function t(e,n,r){var i,o;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.D_.shift(),o=Rc.from(i,n,r),t.next=3,Jh(e,(function(){return e.remoteSyncer.applySuccessfulWrite(o)}));case 3:return t.next=5,$h(e);case 5:case"end":return t.stop()}}),t)}))),lf.apply(this,arguments)}function hf(t,e){return ff.apply(this,arguments)}function ff(){return ff=ra(ea().mark((function t(e,n){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n&&mf(e).P_,!t.t0){t.next=4;break}return t.next=4,function(){var t=ra(ea().mark((function t(e,n){var r;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!function(t){return Fc(t)&&t!==Aa.ABORTED}(n.code)){t.next=7;break}return r=e.D_.shift(),mf(e).Zo(),t.next=5,Jh(e,(function(){return e.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return t.next=7,$h(e);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(e,n);case 4:nf(e)&&rf(e);case 5:case"end":return t.stop()}}),t)}))),ff.apply(this,arguments)}function df(t,e){return vf.apply(this,arguments)}function vf(){return vf=ra(ea().mark((function t(e,n){var r,i;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=Ca(e)).asyncQueue.verifyOperationInProgress(),Ea("RemoteStore","RemoteStore received new credentials"),i=Bh(r),r.v_.add(3),t.next=6,Lh(r);case 6:return i&&r.x_.set("Unknown"),t.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.v_.delete(3),t.next=12,Oh(r);case 12:case"end":return t.stop()}}),t)}))),vf.apply(this,arguments)}function pf(t,e){return yf.apply(this,arguments)}function yf(){return(yf=ra(ea().mark((function t(e,n){var r;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Ca(e),!n){t.next=7;break}return r.v_.delete(2),t.next=5,Oh(r);case 5:t.next=13;break;case 7:if(t.t0=n,t.t0){t.next=13;break}return r.v_.add(2),t.next=12,Lh(r);case 12:r.x_.set("Unknown");case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function gf(t){return t.N_||(t.N_=function(t,e,n){var r=Ca(t);return r.R_(),new xh(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{Po:zh.bind(null,t),To:Kh.bind(null,t),u_:Qh.bind(null,t)}),t.F_.push(function(){var e=ra(ea().mark((function e(n){return ea().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}t.N_.Zo(),Uh(t)?Vh(t):t.x_.set("Unknown"),e.next=7;break;case 4:return e.next=6,t.N_.stop();case 6:qh(t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),t.N_}function mf(t){return t.B_||(t.B_=function(t,e,n){var r=Ca(t);return r.R_(),new Ih(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{Po:of.bind(null,t),To:hf.bind(null,t),E_:uf.bind(null,t),T_:cf.bind(null,t)}),t.F_.push(function(){var e=ra(ea().mark((function e(n){return ea().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=6;break}return t.B_.Zo(),e.next=4,$h(t);case 4:e.next=9;break;case 6:return e.next=8,t.B_.stop();case 8:t.D_.length>0&&(Ea("RemoteStore","Stopping write stream with ".concat(t.D_.length," pending writes")),t.D_=[]);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),t.B_}var wf=function(){function t(e,n,r,i,o){da(this,t),this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Oa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return pa(t,[{key:"promise",get:function(){return this.deferred.promise}},{key:"start",value:function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Da(Aa.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}},{key:"handleDelayElapsed",value:function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a}}]),t}();function kf(t,e){if(_a("AsyncQueue","".concat(e,": ").concat(t)),lu(t))return new Da(Aa.UNAVAILABLE,"".concat(e,": ").concat(t));throw t}var bf=function(){function t(e){da(this,t),this.comparator=e?function(t,n){return e(t,n)||Ya.comparator(t.key,n.key)}:function(t,e){return Ya.comparator(t.key,e.key)},this.keyedMap=Hs(),this.sortedSet=new _u(this.comparator)}return pa(t,[{key:"has",value:function(t){return null!=this.keyedMap.get(t)}},{key:"get",value:function(t){return this.keyedMap.get(t)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))}},{key:"add",value:function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}},{key:"delete",value:function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}},{key:"toString",value:function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}},{key:"copy",value:function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}],[{key:"emptySet",value:function(e){return new t(e.comparator)}}]),t}(),Ef=function(){function t(){da(this,t),this.L_=new _u(Ya.comparator)}return pa(t,[{key:"track",value:function(t){var e=t.doc.key,n=this.L_.get(e);n?0!==t.type&&3===n.type?this.L_=this.L_.insert(e,t):3===t.type&&1!==n.type?this.L_=this.L_.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.L_=this.L_.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.L_=this.L_.remove(e):1===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):xa():this.L_=this.L_.insert(e,t)}},{key:"k_",value:function(){var t=[];return this.L_.inorderTraversal((function(e,n){t.push(n)})),t}}]),t}(),_f=function(){function t(e,n,r,i,o,a,u,s,c){da(this,t),this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=s,this.hasCachedResults=c}return pa(t,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ms(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(e,n,r,i,o){var a=[];return n.forEach((function(t){a.push({type:0,doc:t})})),new t(e,n,bf.emptySet(n),a,r,i,!0,!1,o)}}]),t}(),Sf=pa((function t(){da(this,t),this.q_=void 0,this.Q_=[]})),Tf=pa((function t(){da(this,t),this.queries=new qs((function(t){return js(t)}),Ms),this.onlineState="Unknown",this.K_=new Set}));function xf(t,e){return If.apply(this,arguments)}function If(){return If=ra(ea().mark((function t(e,n){var r,i,o,a,u;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Ca(e),i=n.query,o=!1,(a=r.queries.get(i))||(o=!0,a=new Sf),!o){t.next=13;break}return t.prev=3,t.next=6,r.onListen(i);case 6:a.q_=t.sent,t.next=13;break;case 9:return t.prev=9,t.t0=t.catch(3),u=kf(t.t0,"Initialization of query '".concat(Fs(n.query),"' failed")),t.abrupt("return",void n.onError(u));case 13:r.queries.set(i,a),a.Q_.push(n),n.U_(r.onlineState),a.q_&&n.W_(a.q_)&&Nf(r);case 14:case"end":return t.stop()}}),t,null,[[3,9]])}))),If.apply(this,arguments)}function Cf(t,e){return Af.apply(this,arguments)}function Af(){return Af=ra(ea().mark((function t(e,n){var r,i,o,a,u;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Ca(e),i=n.query,o=!1,(a=r.queries.get(i))&&(u=a.Q_.indexOf(n))>=0&&(a.Q_.splice(u,1),o=0===a.Q_.length),!o){t.next=6;break}return t.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return t.stop()}}),t)}))),Af.apply(this,arguments)}function Df(t,e){var n,r=Ca(t),i=!1,o=ta(e);try{for(o.s();!(n=o.n()).done;){var a=n.value,u=a.query,s=r.queries.get(u);if(s){var c,l=ta(s.Q_);try{for(l.s();!(c=l.n()).done;)c.value.W_(a)&&(i=!0)}catch(t){l.e(t)}finally{l.f()}s.q_=a}}}catch(t){o.e(t)}finally{o.f()}i&&Nf(r)}function Of(t,e,n){var r=Ca(t),i=r.queries.get(e);if(i){var o,a=ta(i.Q_);try{for(a.s();!(o=a.n()).done;)o.value.onError(n)}catch(t){a.e(t)}finally{a.f()}}r.queries.delete(e)}function Nf(t){t.K_.forEach((function(t){t.next()}))}var Lf=function(){function t(e,n,r){da(this,t),this.query=e,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}return pa(t,[{key:"W_",value:function(t){if(!this.options.includeMetadataChanges){var e,n=[],r=ta(t.docChanges);try{for(r.s();!(e=r.n()).done;){var i=e.value;3!==i.type&&n.push(i)}}catch(t){r.e(t)}finally{r.f()}t=new _f(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}var o=!1;return this.z_?this.H_(t)&&(this.G_.next(t),o=!0):this.J_(t,this.onlineState)&&(this.Y_(t),o=!0),this.j_=t,o}},{key:"onError",value:function(t){this.G_.error(t)}},{key:"U_",value:function(t){this.onlineState=t;var e=!1;return this.j_&&!this.z_&&this.J_(this.j_,t)&&(this.Y_(this.j_),e=!0),e}},{key:"J_",value:function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return(!this.options.Z_||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}},{key:"H_",value:function(t){if(t.docChanges.length>0)return!0;var e=this.j_&&this.j_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}},{key:"Y_",value:function(t){t=_f.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.z_=!0,this.G_.next(t)}}]),t}(),Pf=pa((function t(e){da(this,t),this.key=e})),Rf=pa((function t(e){da(this,t),this.key=e})),Mf=function(){function t(e,n){da(this,t),this.query=e,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=Zs(),this.mutatedKeys=Zs(),this.ua=Us(e),this.ca=new bf(this.ua)}return pa(t,[{key:"la",get:function(){return this.oa}},{key:"ha",value:function(t,e){var n=this,r=e?e.Pa:new Ef,i=e?e.ca:this.ca,o=e?e.mutatedKeys:this.mutatedKeys,a=i,u=!1,s="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=Vs(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),v=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),v=!0):n.Ia(l,h)||(r.track({type:2,doc:h}),v=!0,(s&&n.ua(h,s)>0||c&&n.ua(h,c)<0)&&(u=!0)):!l&&h?(r.track({type:0,doc:h}),v=!0):l&&!h&&(r.track({type:1,doc:l}),v=!0,(s||c)&&(u=!0)),v&&(h?(a=a.add(h),o=d?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),null!==this.query.limit)for(;a.size>this.query.limit;){var l="F"===this.query.limitType?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{ca:a,Pa:r,Xi:u,mutatedKeys:o}}},{key:"Ia",value:function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}},{key:"applyChanges",value:function(t,e,n,r){var i=this,o=this.ca;this.ca=t.ca,this.mutatedKeys=t.mutatedKeys;var a=t.Pa.k_();a.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xa()}};return n(t)-n(e)}(t.type,e.type)||i.ua(t.doc,e.doc)})),this.Ta(n),r=null!=r&&r;var u=e&&!r?this.Ea():[],s=0===this.aa.size&&this.current&&!r?1:0,c=s!==this._a;return this._a=s,0!==a.length||c?{snapshot:new _f(this.query,t.ca,o,a,t.mutatedKeys,0===s,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),da:u}:{da:u}}},{key:"U_",value:function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new Ef,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}},{key:"Aa",value:function(t){return!this.oa.has(t)&&!!this.ca.has(t)&&!this.ca.get(t).hasLocalMutations}},{key:"Ta",value:function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.oa=e.oa.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.oa=e.oa.delete(t)})),this.current=t.current)}},{key:"Ea",value:function(){var t=this;if(!this.current)return[];var e=this.aa;this.aa=Zs(),this.ca.forEach((function(e){t.Aa(e.key)&&(t.aa=t.aa.add(e.key))}));var n=[];return e.forEach((function(e){t.aa.has(e)||n.push(new Rf(e))})),this.aa.forEach((function(t){e.has(t)||n.push(new Pf(t))})),n}},{key:"Ra",value:function(t){this.oa=t.hs,this.aa=Zs();var e=this.ha(t.documents);return this.applyChanges(e,!0)}},{key:"Va",value:function(){return _f.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,0===this._a,this.hasCachedResults)}}]),t}(),jf=pa((function t(e,n,r){da(this,t),this.query=e,this.targetId=n,this.view=r})),Ff=pa((function t(e){da(this,t),this.key=e,this.ma=!1})),Vf=function(){function t(e,n,r,i,o,a){da(this,t),this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.fa={},this.ga=new qs((function(t){return js(t)}),Ms),this.pa=new Map,this.ya=new Set,this.wa=new _u(Ya.comparator),this.Sa=new Map,this.ba=new zl,this.Da={},this.Ca=new Map,this.va=jl.Bn(),this.onlineState="Unknown",this.Fa=void 0}return pa(t,[{key:"isPrimaryClient",get:function(){return!0===this.Fa}}]),t}();function Uf(t,e){return Bf.apply(this,arguments)}function Bf(){return Bf=ra(ea().mark((function t(e,n){var r,i,o,a,u,s;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=pd(e),!(a=r.ga.get(n))){t.next=6;break}i=a.targetId,r.sharedClientState.addLocalQueryTarget(i),o=a.view.Va(),t.next=15;break;case 6:return t.next=8,sh(r.localStore,Ps(n));case 8:return u=t.sent,s=r.sharedClientState.addLocalQueryTarget(u.targetId),i=u.targetId,t.next=13,qf(r,n,i,"current"===s,u.resumeToken);case 13:o=t.sent,r.isPrimaryClient&&Rh(r.remoteStore,u);case 15:return t.abrupt("return",o);case 16:case"end":return t.stop()}}),t)}))),Bf.apply(this,arguments)}function qf(t,e,n,r,i){return zf.apply(this,arguments)}function zf(){return zf=ra(ea().mark((function t(e,n,r,i,o){var a,u,s,c,l,h;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.Ma=function(t,n,r){return(i=ra(ea().mark((function t(e,n,r,i){var o,a,u,s;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.view.ha(r),t.t0=o.Xi,!t.t0){t.next=6;break}return t.next=5,hh(e.localStore,n.query,!1).then((function(t){var e=t.documents;return n.view.ha(e,o)}));case 5:o=t.sent;case 6:return a=i&&i.targetChanges.get(n.targetId),u=i&&null!=i.targetMismatches.get(n.targetId),s=n.view.applyChanges(o,e.isPrimaryClient,a,u),t.abrupt("return",(ud(e,n.targetId,s.da),s.snapshot));case 8:case"end":return t.stop()}}),t)}))),function(t,e,n,r){return i.apply(this,arguments)})(e,t,n,r);var i},t.next=3,hh(e.localStore,n,!0);case 3:return a=t.sent,u=new Mf(n,a.hs),s=u.ha(a.documents),c=Hc.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==e.onlineState,o),l=u.applyChanges(s,e.isPrimaryClient,c),ud(e,r,l.da),h=new jf(n,r,u),t.abrupt("return",(e.ga.set(n,h),e.pa.has(r)?e.pa.get(r).push(n):e.pa.set(r,[n]),l.snapshot));case 11:case"end":return t.stop()}}),t)}))),zf.apply(this,arguments)}function Gf(t,e){return Kf.apply(this,arguments)}function Kf(){return Kf=ra(ea().mark((function t(e,n){var r,i,o;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Ca(e),i=r.ga.get(n),!((o=r.pa.get(i.targetId)).length>1)){t.next=3;break}return t.abrupt("return",(r.pa.set(i.targetId,o.filter((function(t){return!Ms(t,n)}))),void r.ga.delete(n)));case 3:if(!r.isPrimaryClient){t.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),t.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),t.t0){t.next=9;break}return t.next=9,ch(r.localStore,i.targetId,!1).then((function(){r.sharedClientState.clearQueryState(i.targetId),Mh(r.remoteStore,i.targetId),od(r,i.targetId)})).catch(ru);case 9:t.next=14;break;case 11:return od(r,i.targetId),t.next=14,ch(r.localStore,i.targetId,!0);case 14:case"end":return t.stop()}}),t)}))),Kf.apply(this,arguments)}function Hf(t,e,n){return Qf.apply(this,arguments)}function Qf(){return Qf=ra(ea().mark((function t(e,n,r){var i,o,a;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=yd(e),t.prev=1,t.next=4,function(t,e){var n,r,i=Ca(t),o=Ga.now(),a=e.reduce((function(t,e){return t.add(e.key)}),Zs());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(t){var u=Gs(),s=Zs();return i.os.getEntries(t,a).next((function(t){(u=t).forEach((function(t,e){e.isValidDocument()||(s=s.add(t))}))})).next((function(){return i.localDocuments.getOverlayedDocuments(t,u)})).next((function(r){n=r;var a,u=[],s=ta(e);try{for(s.s();!(a=s.n()).done;){var c=a.value,l=_c(c,n.get(c.key).overlayedDocument);null!=l&&u.push(new xc(c.key,l,ns(l.value.mapValue),gc.exists(!0)))}}catch(t){s.e(t)}finally{s.f()}return i.mutationQueue.addMutationBatch(t,o,u,e)})).next((function(e){r=e;var o=e.applyToLocalDocumentSet(n,s);return i.documentOverlayCache.saveOverlays(t,e.batchId,o)}))})).then((function(){return{batchId:r.batchId,changes:Qs(n)}}))}(i.localStore,n);case 4:return o=t.sent,i.sharedClientState.addPendingMutation(o.batchId),function(t,e,n){var r=t.Da[t.currentUser.toKey()];r||(r=new _u(qa)),r=r.insert(e,n),t.Da[t.currentUser.toKey()]=r}(i,o.batchId,r),t.next=9,ld(i,o.changes);case 9:return t.next=11,$h(i.remoteStore);case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),a=kf(t.t0,"Failed to persist write"),r.reject(a);case 17:case"end":return t.stop()}}),t,null,[[1,13]])}))),Qf.apply(this,arguments)}function Wf(t,e){return Xf.apply(this,arguments)}function Xf(){return Xf=ra(ea().mark((function t(e,n){var r,i;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Ca(e),t.prev=1,t.next=4,ah(r.localStore,n);case 4:return i=t.sent,n.targetChanges.forEach((function(t,e){var n=r.Sa.get(e);n&&(Ia(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?n.ma=!0:t.modifiedDocuments.size>0?Ia(n.ma):t.removedDocuments.size>0&&(Ia(n.ma),n.ma=!1))})),t.next=8,ld(r,i,n);case 8:t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(1),t.next=14,ru(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,10]])}))),Xf.apply(this,arguments)}function Yf(t,e,n){var r=Ca(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.ga.forEach((function(t,n){var r=n.view.U_(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Ca(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){var i,o=ta(n.Q_);try{for(o.s();!(i=o.n()).done;)i.value.U_(e)&&(r=!0)}catch(t){o.e(t)}finally{o.f()}})),r&&Nf(n)}(r.eventManager,e),i.length&&r.fa.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Jf(t,e,n){return $f.apply(this,arguments)}function $f(){return $f=ra(ea().mark((function t(e,n,r){var i,o,a,u,s,c;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=Ca(e)).sharedClientState.updateQueryState(n,"rejected",r),o=i.Sa.get(n),!(a=o&&o.key)){t.next=14;break}return u=(u=new _u(Ya.comparator)).insert(a,rs.newNoDocument(a,Ka.min())),s=Zs().add(a),c=new Kc(Ka.min(),new Map,new _u(qa),u,s),t.next=9,Wf(i,c);case 9:i.wa=i.wa.remove(a),i.Sa.delete(n),cd(i),t.next=16;break;case 14:return t.next=16,ch(i.localStore,n,!1).then((function(){return od(i,n,r)})).catch(ru);case 16:case"end":return t.stop()}}),t)}))),$f.apply(this,arguments)}function Zf(t,e){return td.apply(this,arguments)}function td(){return td=ra(ea().mark((function t(e,n){var r,i,o;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Ca(e),i=n.batch.batchId,t.prev=1,t.next=4,ih(r.localStore,n);case 4:return o=t.sent,id(r,i,null),rd(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),t.next=10,ld(r,o);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(1),t.next=16,ru(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,12]])}))),td.apply(this,arguments)}function ed(t,e,n){return nd.apply(this,arguments)}function nd(){return nd=ra(ea().mark((function t(e,n,r){var i,o;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Ca(e),t.prev=1,t.next=4,function(t,e){var n=Ca(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.mutationQueue.lookupMutationBatch(t,e).next((function(e){return Ia(null!==e),r=e.keys(),n.mutationQueue.removeMutationBatch(t,e)})).next((function(){return n.mutationQueue.performConsistencyCheck(t)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(t,r,e)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,r)})).next((function(){return n.localDocuments.getDocuments(t,r)}))}))}(i.localStore,n);case 4:return o=t.sent,id(i,n,r),rd(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),t.next=10,ld(i,o);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(1),t.next=16,ru(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,12]])}))),nd.apply(this,arguments)}function rd(t,e){(t.Ca.get(e)||[]).forEach((function(t){t.resolve()})),t.Ca.delete(e)}function id(t,e,n){var r=Ca(t),i=r.Da[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Da[r.currentUser.toKey()]=i}}function od(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.sharedClientState.removeLocalQueryTarget(e);var r,i=ta(t.pa.get(e));try{for(i.s();!(r=i.n()).done;){var o=r.value;t.ga.delete(o),n&&t.fa.xa(o,n)}}catch(t){i.e(t)}finally{i.f()}t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach((function(e){t.ba.containsKey(e)||ad(t,e)}))}function ad(t,e){t.ya.delete(e.path.canonicalString());var n=t.wa.get(e);null!==n&&(Mh(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),cd(t))}function ud(t,e,n){var r,i=ta(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;o instanceof Pf?(t.ba.addReference(o.key,e),sd(t,o)):o instanceof Rf?(Ea("SyncEngine","Document no longer in limbo: "+o.key),t.ba.removeReference(o.key,e),t.ba.containsKey(o.key)||ad(t,o.key)):xa()}}catch(t){i.e(t)}finally{i.f()}}function sd(t,e){var n=e.key,r=n.path.canonicalString();t.wa.get(n)||t.ya.has(r)||(Ea("SyncEngine","New document in limbo: "+n),t.ya.add(r),cd(t))}function cd(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){var e=t.ya.values().next().value;t.ya.delete(e);var n=new Ya(Qa.fromString(e)),r=t.va.next();t.Sa.set(r,new Ff(n)),t.wa=t.wa.insert(n,r),Rh(t.remoteStore,new Dl(Ps(Os(n.path)),r,"TargetPurposeLimboResolution",pu._e))}}function ld(t,e,n){return hd.apply(this,arguments)}function hd(){return hd=ra(ea().mark((function t(e,n,r){var i,o,a,u;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=Ca(e),o=[],a=[],u=[],t.t0=i.ga.isEmpty(),t.t0){t.next=9;break}return i.ga.forEach((function(t,e){u.push(i.Ma(e,n,r).then((function(t){if((t||r)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(e.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){o.push(t);var n=$l.Ki(e.targetId,t);a.push(n)}})))})),t.next=6,Promise.all(u);case 6:return i.fa.u_(o),t.next=9,function(){var t=ra(ea().mark((function t(e,n){var r,i,o,a,u,s,c,l;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Ca(e),t.prev=1,t.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return ou.forEach(n,(function(e){return ou.forEach(e.qi,(function(n){return r.persistence.referenceDelegate.addReference(t,e.targetId,n)})).next((function(){return ou.forEach(e.Qi,(function(n){return r.persistence.referenceDelegate.removeReference(t,e.targetId,n)}))}))}))}));case 4:t.next=11;break;case 6:if(t.prev=6,t.t0=t.catch(1),lu(t.t0)){t.next=10;break}throw t.t0;case 10:Ea("LocalStore","Failed to update sequence numbers: "+t.t0);case 11:i=ta(n);try{for(i.s();!(o=i.n()).done;)a=o.value,u=a.targetId,a.fromCache||(s=r.ns.get(u),c=s.snapshotVersion,l=s.withLastLimboFreeSnapshotVersion(c),r.ns=r.ns.insert(u,l))}catch(t){i.e(t)}finally{i.f()}case 13:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(e,n){return t.apply(this,arguments)}}()(i.localStore,a);case 9:case"end":return t.stop()}}),t)}))),hd.apply(this,arguments)}function fd(t,e){return dd.apply(this,arguments)}function dd(){return(dd=ra(ea().mark((function t(e,n){var r,i;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=Ca(e)).currentUser.isEqual(n)){t.next=11;break}return Ea("SyncEngine","User change. New user:",n.toKey()),t.next=5,nh(r.localStore,n);case 5:return i=t.sent,r.currentUser=n,function(t,e){t.Ca.forEach((function(t){t.forEach((function(t){t.reject(new Da(Aa.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ca.clear()}(r),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),t.next=11,ld(r,i.us);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function vd(t,e){var n=Ca(t),r=n.Sa.get(e);if(r&&r.ma)return Zs().add(r.key);var i=Zs(),o=n.pa.get(e);if(!o)return i;var a,u=ta(o);try{for(u.s();!(a=u.n()).done;){var s=a.value,c=n.ga.get(s);i=i.unionWith(c.view.la)}}catch(t){u.e(t)}finally{u.f()}return i}function pd(t){var e=Ca(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Wf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vd.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Jf.bind(null,e),e.fa.u_=Df.bind(null,e.eventManager),e.fa.xa=Of.bind(null,e.eventManager),e}function yd(t){var e=Ca(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Zf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ed.bind(null,e),e}var gd=function(){function t(){da(this,t),this.synchronizeTabs=!1}var e,n;return pa(t,[{key:"initialize",value:(n=ra(ea().mark((function t(e){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.serializer=_h(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),t.next=5,this.persistence.start();case 5:this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"createGarbageCollectionScheduler",value:function(t,e){return null}},{key:"createIndexBackfillerScheduler",value:function(t,e){return null}},{key:"createLocalStore",value:function(t){return function(t,e,n,r){return new eh(t,e,n,r)}(this.persistence,new th,t.initialUser,this.serializer)}},{key:"createPersistence",value:function(t){return new Xl(Jl.Hr,this.serializer)}},{key:"createSharedClientState",value:function(t){return new dh}},{key:"terminate",value:(e=ra(ea().mark((function t(){var e,n;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(n=this.indexBackfillerScheduler)||void 0===n||n.stop(),this.sharedClientState.shutdown(),t.next=5,this.persistence.shutdown();case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}(),md=function(){function t(){da(this,t)}var e,n;return pa(t,[{key:"initialize",value:(n=ra(ea().mark((function t(e,n){var r=this;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=this.localStore,t.t0){t.next=12;break}return this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Yf(r.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=fd.bind(null,this.syncEngine),t.next=12,pf(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"createEventManager",value:function(t){return new Tf}},{key:"createDatastore",value:function(t){var e=_h(t.databaseInfo.databaseId),n=function(t){return new bh(t)}(t.databaseInfo);return function(t,e,n,r){return new Ch(t,e,n,r)}(t.authCredentials,t.appCheckCredentials,n,e)}},{key:"createRemoteStore",value:function(t){var e=this;return function(t,n,r,i,o){return new Dh(t,n,r,(function(t){return Yf(e.syncEngine,t,0)}),o)}(this.localStore,this.datastore,t.asyncQueue,0,ph.D()?new ph:new vh)}},{key:"createSyncEngine",value:function(t,e){return function(t,e,n,r,i,o,a){var u=new Vf(t,e,n,r,i,o);return a&&(u.Fa=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}},{key:"terminate",value:(e=ra(ea().mark((function t(){var e;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){var t=ra(ea().mark((function t(e){var n;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Ca(e),Ea("RemoteStore","RemoteStore shutting down."),n.v_.add(5),t.next=5,Lh(n);case 5:n.M_.shutdown(),n.x_.set("Unknown");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(this.remoteStore);case 2:null===(e=this.datastore)||void 0===e||e.terminate();case 3:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}(),wd=function(){function t(e){da(this,t),this.observer=e,this.muted=!1}return pa(t,[{key:"next",value:function(t){this.observer.next&&this.Ba(this.observer.next,t)}},{key:"error",value:function(t){this.observer.error?this.Ba(this.observer.error,t):_a("Uncaught Error in snapshot listener:",t.toString())}},{key:"La",value:function(){this.muted=!0}},{key:"Ba",value:function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)}}]),t}(),kd=function(){function t(e,n,r,i){var o=this;da(this,t),this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ma.UNAUTHENTICATED,this.clientId=Ba.newId(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var t=ra(ea().mark((function t(e){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ea("FirestoreClient","Received user=",e.uid),t.next=3,o.authCredentialListener(e);case 3:o.user=e;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.appCheckCredentials.start(r,(function(t){return Ea("FirestoreClient","Received new app check token=",t),o.appCheckCredentialListener(t,o.user)}))}return pa(t,[{key:"configuration",get:function(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}},{key:"setCredentialChangeListener",value:function(t){this.authCredentialListener=t}},{key:"setAppCheckTokenChangeListener",value:function(t){this.appCheckCredentialListener=t}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Da(Aa.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Oa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(ra(ea().mark((function n(){var r;return ea().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=t._onlineComponents,!n.t0){n.next=5;break}return n.next=5,t._onlineComponents.terminate();case 5:if(n.t1=t._offlineComponents,!n.t1){n.next=9;break}return n.next=9,t._offlineComponents.terminate();case 9:t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=kf(n.t2,"Failed to shutdown persistence"),e.reject(r);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))),e.promise}}]),t}();function bd(t,e){return Ed.apply(this,arguments)}function Ed(){return Ed=ra(ea().mark((function t(e,n){var r,i;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.asyncQueue.verifyOperationInProgress(),Ea("FirestoreClient","Initializing OfflineComponentProvider"),r=e.configuration,t.next=4,n.initialize(r);case 4:i=r.initialUser,e.setCredentialChangeListener(function(){var t=ra(ea().mark((function t(e){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=i.isEqual(e),t.t0){t.next=5;break}return t.next=4,nh(n.localStore,e);case 4:i=e;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return e.terminate()})),e._offlineComponents=n;case 6:case"end":return t.stop()}}),t)}))),Ed.apply(this,arguments)}function _d(t,e){return Sd.apply(this,arguments)}function Sd(){return(Sd=ra(ea().mark((function t(e,n){var r;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.asyncQueue.verifyOperationInProgress(),t.next=3,xd(e);case 3:return r=t.sent,Ea("FirestoreClient","Initializing OnlineComponentProvider"),t.next=7,n.initialize(r,e.configuration);case 7:e.setCredentialChangeListener((function(t){return df(n.remoteStore,t)})),e.setAppCheckTokenChangeListener((function(t,e){return df(n.remoteStore,e)})),e._onlineComponents=n;case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Td(t){return"FirebaseError"===t.name?t.code===Aa.FAILED_PRECONDITION||t.code===Aa.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}function xd(t){return Id.apply(this,arguments)}function Id(){return(Id=ra(ea().mark((function t(e){var n;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e._offlineComponents){t.next=21;break}if(!e._uninitializedComponentsProvider){t.next=18;break}return Ea("FirestoreClient","Using user provided OfflineComponentProvider"),t.prev=3,t.next=6,bd(e,e._uninitializedComponentsProvider._offline);case 6:t.next=16;break;case 8:if(t.prev=8,t.t0=t.catch(3),Td(n=t.t0)){t.next=13;break}throw n;case 13:return Sa("Error using user provided cache. Falling back to memory cache: "+n),t.next=16,bd(e,new gd);case 16:t.next=21;break;case 18:return Ea("FirestoreClient","Using default OfflineComponentProvider"),t.next=21,bd(e,new gd);case 21:return t.abrupt("return",e._offlineComponents);case 22:case"end":return t.stop()}}),t,null,[[3,8]])})))).apply(this,arguments)}function Cd(t){return Ad.apply(this,arguments)}function Ad(){return(Ad=ra(ea().mark((function t(e){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e._onlineComponents,t.t0){t.next=11;break}if(!e._uninitializedComponentsProvider){t.next=8;break}return Ea("FirestoreClient","Using user provided OnlineComponentProvider"),t.next=6,_d(e,e._uninitializedComponentsProvider._online);case 6:t.next=11;break;case 8:return Ea("FirestoreClient","Using default OnlineComponentProvider"),t.next=11,_d(e,new md);case 11:return t.abrupt("return",e._onlineComponents);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Dd(t){return Cd(t).then((function(t){return t.syncEngine}))}function Od(t){return Nd.apply(this,arguments)}function Nd(){return(Nd=ra(ea().mark((function t(e){var n,r;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Cd(e);case 2:return n=t.sent,r=n.eventManager,t.abrupt("return",(r.onListen=Uf.bind(null,n.syncEngine),r.onUnlisten=Gf.bind(null,n.syncEngine),r));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ld(t){var e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}var Pd=new Map;function Rd(t,e,n){if(!n)throw new Da(Aa.INVALID_ARGUMENT,"Function ".concat(t,"() cannot be called with an empty ").concat(e,"."))}function Md(t){if(!Ya.isDocumentKey(t))throw new Da(Aa.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(t," has ").concat(t.length,"."))}function jd(t){if(Ya.isDocumentKey(t))throw new Da(Aa.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(t," has ").concat(t.length,"."))}function Fd(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t="".concat(t.substring(0,20),"...")),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==fa(t)){if(t instanceof Array)return"an array";var e=function(t){return t.constructor?t.constructor.name:null}(t);return e?"a custom ".concat(e," object"):"an object"}return"function"==typeof t?"a function":xa()}function Vd(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Da(Aa.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Fd(t);throw new Da(Aa.INVALID_ARGUMENT,"Expected type '".concat(e.name,"', but it was: ").concat(n))}return t}var Ud=function(){function t(e){var n,r;if(da(this,t),void 0===e.host){if(void 0!==e.ssl)throw new Da(Aa.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(n=e.ssl)||void 0===n||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Da(Aa.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(t,e,n,r){if(!0===e&&!0===r)throw new Da(Aa.INVALID_ARGUMENT,"".concat("experimentalForceLongPolling"," and ").concat("experimentalAutoDetectLongPolling"," cannot be used together."))})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ld(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new Da(Aa.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (must not be NaN)"));if(t.timeoutSeconds<5)throw new Da(Aa.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (minimum allowed value is 5)"));if(t.timeoutSeconds>30)throw new Da(Aa.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}return pa(t,[{key:"isEqual",value:function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}]),t}(),Bd=function(){function t(e,n,r,i){da(this,t),this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ud({}),this._settingsFrozen=!1}return pa(t,[{key:"app",get:function(){if(!this._app)throw new Da(Aa.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(t){if(this._settingsFrozen)throw new Da(Aa.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ud(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new La;switch(t.type){case"firstParty":return new ja(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Da(Aa.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return this,(t=Pd.get(this))&&(Ea("ComponentProvider","Removing Datastore"),Pd.delete(this),t.terminate()),Promise.resolve();var t}}]),t}();function qd(t,e,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=(t=Vd(t,Bd))._getSettings(),a="".concat(e,":").concat(n);if("firestore.googleapis.com"!==o.host&&o.host!==a&&Sa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),i.mockUserToken){var u,s;if("string"==typeof i.mockUserToken)u=i.mockUserToken,s=ma.MOCK_USER;else{u=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[y(JSON.stringify({alg:"none",type:"JWT"})),y(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);var c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new Da(Aa.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new ma(c)}t._authCredentials=new Pa(new Na(u,s))}}var zd=function(){function t(e,n,r){da(this,t),this.converter=n,this._query=r,this.type="query",this.firestore=e}return pa(t,[{key:"withConverter",value:function(e){return new t(this.firestore,e,this._query)}}]),t}(),Gd=function(){function t(e,n,r){da(this,t),this.converter=n,this._key=r,this.type="document",this.firestore=e}return pa(t,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new Kd(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(e){return new t(this.firestore,e,this._key)}}]),t}(),Kd=function(t){function e(t,n,r){var i;return da(this,e),(i=ia(this,e,[t,n,Os(r)]))._path=r,i.type="collection",i}return ua(e,t),pa(e,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Gd(this.firestore,null,new Ya(t))}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._path)}}]),e}(zd),Hd=function(){function t(){var e=this;da(this,t),this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new Sh(this,"async_queue_retry"),this._u=function(){var t=Eh();t&&Ea("AsyncQueue","Visibility state changed to "+t.visibilityState),e.jo.Ko()};var n=Eh();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this._u)}var e,n;return pa(t,[{key:"isShuttingDown",get:function(){return this.tu}},{key:"enqueueAndForget",value:function(t){this.enqueue(t)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(t){this.au(),this.uu(t)}},{key:"enterRestrictedMode",value:function(t){if(!this.tu){this.tu=!0,this.su=t||!1;var e=Eh();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this._u)}}},{key:"enqueue",value:function(t){var e=this;if(this.au(),this.tu)return new Promise((function(){}));var n=new Oa;return this.uu((function(){return e.tu&&e.su?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(t){var e=this;this.enqueueAndForget((function(){return e.eu.push(t),e.cu()}))}},{key:"cu",value:(n=ra(ea().mark((function t(){var e=this;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===this.eu.length){t.next=14;break}return t.prev=1,t.next=4,this.eu[0]();case 4:this.eu.shift(),this.jo.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),lu(t.t0)){t.next=12;break}throw t.t0;case 12:Ea("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:this.eu.length>0&&this.jo.qo((function(){return e.cu()}));case 14:case"end":return t.stop()}}),t,this,[[1,8]])}))),function(){return n.apply(this,arguments)})},{key:"uu",value:function(t){var e=this,n=this.Xa.then((function(){return e.iu=!0,t().catch((function(t){e.ru=t,e.iu=!1;var n=function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw _a("INTERNAL UNHANDLED ERROR: ",n),t})).then((function(t){return e.iu=!1,t}))}));return this.Xa=n,n}},{key:"enqueueAfterDelay",value:function(t,e,n){var r=this;this.au(),this.ou.indexOf(t)>-1&&(e=0);var i=wf.createAndSchedule(this,t,e,n,(function(t){return r.lu(t)}));return this.nu.push(i),i}},{key:"au",value:function(){this.ru&&xa()}},{key:"verifyOperationInProgress",value:function(){}},{key:"hu",value:(e=ra(ea().mark((function t(){var e;return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.Xa,t.next=3,e;case 3:if(e!==this.Xa){t.next=0;break}case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"Pu",value:function(t){var e,n=ta(this.nu);try{for(n.s();!(e=n.n()).done;)if(e.value.timerId===t)return!0}catch(t){n.e(t)}finally{n.f()}return!1}},{key:"Iu",value:function(t){var e=this;return this.hu().then((function(){e.nu.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));var n,r=ta(e.nu);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==t&&i.timerId===t)break}}catch(t){r.e(t)}finally{r.f()}return e.hu()}))}},{key:"Tu",value:function(t){this.ou.push(t)}},{key:"lu",value:function(t){var e=this.nu.indexOf(t);this.nu.splice(e,1)}}]),t}(),Qd=function(t){function e(t,n,r,i){var o;return da(this,e),(o=ia(this,e,[t,n,r,i])).type="firestore",o._queue=new Hd,o._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]",o}return ua(e,t),pa(e,[{key:"_terminate",value:function(){return this._firestoreClient||Xd(this),this._firestoreClient.terminate()}}]),e}(Bd);function Wd(t){return t._firestoreClient||Xd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Xd(t){var e,n,r,i=t._freezeSettings(),o=function(t,e,n,r){return new Fu(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Ld(r.experimentalLongPollingOptions),r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new kd(t._authCredentials,t._appCheckCredentials,t._queue,o),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var Yd=function(){function t(e){da(this,t),this._byteString=e}return pa(t,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(t){return this._byteString.isEqual(t._byteString)}}],[{key:"fromBase64String",value:function(e){try{return new t(Du.fromBase64String(e))}catch(e){throw new Da(Aa.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}},{key:"fromUint8Array",value:function(e){return new t(Du.fromUint8Array(e))}}]),t}(),Jd=function(){function t(){da(this,t);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new Da(Aa.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xa(n)}return pa(t,[{key:"isEqual",value:function(t){return this._internalPath.isEqual(t._internalPath)}}]),t}(),$d=pa((function t(e){da(this,t),this._methodName=e})),Zd=function(){function t(e,n){if(da(this,t),!isFinite(e)||e<-90||e>90)throw new Da(Aa.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Da(Aa.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}return pa(t,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(t){return this._lat===t._lat&&this._long===t._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(t){return qa(this._lat,t._lat)||qa(this._long,t._long)}}]),t}(),tv=/^__.*__$/,ev=function(){function t(e,n,r){da(this,t),this.data=e,this.fieldMask=n,this.fieldTransforms=r}return pa(t,[{key:"toMutation",value:function(t,e){return null!==this.fieldMask?new xc(t,this.data,this.fieldMask,e,this.fieldTransforms):new Tc(t,this.data,e,this.fieldTransforms)}}]),t}();function nv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xa()}}var rv=function(){function t(e,n,r,i,o,a){da(this,t),this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===o&&this.Eu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}return pa(t,[{key:"path",get:function(){return this.settings.path}},{key:"du",get:function(){return this.settings.du}},{key:"Au",value:function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"Ru",value:function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Au({path:n,Vu:!1});return r.mu(t),r}},{key:"fu",value:function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Au({path:n,Vu:!1});return r.Eu(),r}},{key:"gu",value:function(t){return this.Au({path:void 0,Vu:!0})}},{key:"pu",value:function(t){return vv(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}},{key:"contains",value:function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))}},{key:"Eu",value:function(){if(this.path)for(var t=0;t<this.path.length;t++)this.mu(this.path.get(t))}},{key:"mu",value:function(t){if(0===t.length)throw this.pu("Document fields must not be empty");if(nv(this.du)&&tv.test(t))throw this.pu('Document fields cannot begin and end with "__"')}}]),t}(),iv=function(){function t(e,n,r){da(this,t),this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||_h(e)}return pa(t,[{key:"Su",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new rv({du:t,methodName:e,wu:n,path:Xa.emptyPath(),Vu:!1,yu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}]),t}();function ov(t){var e=t._freezeSettings(),n=_h(t._databaseId);return new iv(t._databaseId,!!e.ignoreUndefinedProperties,n)}function av(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=t.Su(o.merge||o.mergeFields?2:0,e,n,i);lv("Data must be an object, but it was:",a,r);var u,s,c=sv(r,a);if(o.merge)u=new Cu(a.fieldMask),s=a.fieldTransforms;else if(o.mergeFields){var l,h=[],f=ta(o.mergeFields);try{for(f.s();!(l=f.n()).done;){var d=hv(e,l.value,n);if(!a.contains(d))throw new Da(Aa.INVALID_ARGUMENT,"Field '".concat(d,"' is specified in your field mask but missing from your input data."));pv(h,d)||h.push(d)}}catch(t){f.e(t)}finally{f.f()}u=new Cu(h),s=a.fieldTransforms.filter((function(t){return u.covers(t.field)}))}else u=null,s=a.fieldTransforms;return new ev(new es(c),u,s)}function uv(t,e){if(cv(t=I(t)))return lv("Unsupported field value:",e,t),sv(t,e);if(t instanceof $d)return function(t,e){if(!nv(e.du))throw e.pu("".concat(t._methodName,"() can only be used with update() and set()"));if(!e.path)throw e.pu("".concat(t._methodName,"() is not currently supported inside arrays"));var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&4!==e.du)throw e.pu("Nested arrays are not supported");return function(t,e){var n,r=[],i=0,o=ta(t);try{for(o.s();!(n=o.n()).done;){var a=uv(n.value,e.gu(i));null==a&&(a={nullValue:"NULL_VALUE"}),r.push(a),i++}}catch(t){o.e(t)}finally{o.f()}return{arrayValue:{values:r}}}(t,e)}return function(t,e){if(null===(t=I(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return rc(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ga.fromDate(t);return{timestampValue:ol(e.serializer,n)}}if(t instanceof Ga){var r=new Ga(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ol(e.serializer,r)}}if(t instanceof Zd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Yd)return{bytesValue:al(e.serializer,t._byteString)};if(t instanceof Gd){var i=e.databaseId,o=t.firestore._databaseId;if(!o.isEqual(i))throw e.pu("Document reference is for database ".concat(o.projectId,"/").concat(o.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:cl(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.pu("Unsupported field value: ".concat(Fd(t)))}(t,e)}function sv(t,e){var n={};return Eu(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bu(t,(function(t,r){var i=uv(r,e.Ru(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function cv(t){return!("object"!=fa(t)||null===t||t instanceof Array||t instanceof Date||t instanceof Ga||t instanceof Zd||t instanceof Yd||t instanceof Gd||t instanceof $d)}function lv(t,e,n){if(!cv(n)||!function(t){return"object"==fa(t)&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Fd(n);throw"an object"===r?e.pu(t+" a custom object"):e.pu(t+" "+r)}}function hv(t,e,n){if((e=I(e))instanceof Jd)return e._internalPath;if("string"==typeof e)return dv(t,e);throw vv("Field path arguments must be of type string or ",t,!1,void 0,n)}var fv=new RegExp("[~\\*/\\[\\]]");function dv(t,e,n){if(e.search(fv)>=0)throw vv("Invalid field path (".concat(e,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,n);try{return Zo(Jd,ca(e.split(".")))._internalPath}catch(r){throw vv("Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,n)}}function vv(t,e,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,u="Function ".concat(e,"() called with invalid data");n&&(u+=" (via `toFirestore()`)"),u+=". ";var s="";return(o||a)&&(s+=" (found",o&&(s+=" in field ".concat(r)),a&&(s+=" in document ".concat(i)),s+=")"),new Da(Aa.INVALID_ARGUMENT,u+t+s)}function pv(t,e){return t.some((function(t){return t.isEqual(e)}))}var yv=function(){function t(e,n,r,i,o){da(this,t),this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=o}return pa(t,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new Gd(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var t=new gv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(t){if(this._document){var e=this._document.data.field(mv("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}]),t}(),gv=function(t){function e(){return da(this,e),ia(this,e,arguments)}return ua(e,t),pa(e,[{key:"data",value:function(){return Yo(aa(e.prototype),"data",this).call(this)}}]),e}(yv);function mv(t,e){return"string"==typeof e?dv(t,e):e instanceof Jd?e._internalPath:e._delegate._internalPath}var wv=function(){function t(){da(this,t)}return pa(t,[{key:"convertValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Bu(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Lu(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Pu(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw xa()}}},{key:"convertObject",value:function(t,e){return this.convertObjectMap(t.fields,e)}},{key:"convertObjectMap",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",r={};return bu(t,(function(t,i){r[t]=e.convertValue(i,n)})),r}},{key:"convertGeoPoint",value:function(t){return new Zd(Lu(t.latitude),Lu(t.longitude))}},{key:"convertArray",value:function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))}},{key:"convertServerTimestamp",value:function(t,e){switch(e){case"previous":var n=Mu(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ju(t));default:return null}}},{key:"convertTimestamp",value:function(t){var e=Nu(t);return new Ga(e.seconds,e.nanos)}},{key:"convertDocumentKey",value:function(t,e){var n=Qa.fromString(t);Ia(Al(n));var r=new Vu(n.get(1),n.get(3)),i=new Ya(n.popFirst(5));return r.isEqual(e)||_a("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(e.projectId,"/").concat(e.database,") instead.")),i}}]),t}();var kv=function(){function t(e,n){da(this,t),this.hasPendingWrites=e,this.fromCache=n}return pa(t,[{key:"isEqual",value:function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}]),t}(),bv=function(t){function e(t,n,r,i,o,a){var u;return da(this,e),(u=ia(this,e,[t,n,r,i,a]))._firestore=t,u._firestoreImpl=t,u.metadata=o,u}return ua(e,t),pa(e,[{key:"exists",value:function(){return Yo(aa(e.prototype),"exists",this).call(this)}},{key:"data",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var e=new Ev(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(mv("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}]),e}(yv),Ev=function(t){function e(){return da(this,e),ia(this,e,arguments)}return ua(e,t),pa(e,[{key:"data",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Yo(aa(e.prototype),"data",this).call(this,t)}}]),e}(bv),_v=function(){function t(e,n,r,i){da(this,t),this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new kv(i.hasPendingWrites,i.fromCache),this.query=r}return pa(t,[{key:"docs",get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Ev(n._firestore,n._userDataWriter,r.key,r,new kv(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var t=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Da(Aa.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){var r=new Ev(t._firestore,t._userDataWriter,e.doc.key,e.doc,new kv(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Ev(t._firestore,t._userDataWriter,e.doc.key,e.doc,new kv(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Sv(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),t}();function Sv(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xa()}}var Tv=function(t){function e(t){var n;return da(this,e),(n=ia(this,e)).firestore=t,n}return ua(e,t),pa(e,[{key:"convertBytes",value:function(t){return new Yd(t)}},{key:"convertReference",value:function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Gd(this.firestore,null,e)}}]),e}(wv);function xv(t,e){var n=Vd(t.firestore,Qd),r=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(t=I(t),1===arguments.length&&(e=Ba.newId()),Rd("doc","path",e),t instanceof Bd){var o=Qa.fromString.apply(Qa,[e].concat(r));return Md(o),new Gd(t,null,new Ya(o))}if(!(t instanceof Gd||t instanceof Kd))throw new Da(Aa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var a=t._path.child(Qa.fromString.apply(Qa,[e].concat(r)));return Md(a),new Gd(t.firestore,t instanceof Kd?t.converter:null,new Ya(a))}(t),i=function(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}(t.converter,e);return function(t,e){return function(t,e){var n=new Oa;return t.asyncQueue.enqueueAndForget(ra(ea().mark((function r(){return ea().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=Hf,r.next=3,Dd(t);case 3:return r.t1=r.sent,r.t2=e,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(Wd(t),e)}(n,[av(ov(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,gc.exists(!1))]).then((function(){return r}))}function Iv(t){return Iv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iv(t)}function Cv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Av(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Cv(Object(n),!0).forEach((function(e){var r,i,o,a;r=t,i=e,o=n[e],a=function(t,e){if("object"!=Iv(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Iv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i),(i="symbol"==Iv(a)?a:String(a))in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}new WeakMap,function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];wa="10.8.0",Wt(new U("firestore",(function(t,n){var r=n.instanceIdentifier,i=n.options,o=t.getProvider("app").getImmediate(),a=new Qd(new Ra(t.getProvider("auth-internal")),new Va(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Da(Aa.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vu(t.options.projectId,e)}(o,r),o);return i=Object.assign({useFetchStreams:e},i),a._setSettings(i),a}),"PUBLIC").setMultipleInstances(!0)),Zt(ga,"4.4.2",t),Zt(ga,"4.4.2","esm2017")}();var Dv=["AST","BRD","BLM","BLU","DNC","DRK","DRG","GNB","MCH","MNK","NIN","PLD","RPR","RDM","SGE","SAM","SCH","SMN","WAR","WHM"],Ov=function(){var t={};return Dv.forEach((function(e){for(var n=0,r=Dv;n<r.length;n++){var i=r[n];if(i!==e)for(var o=0,a=["","_W","_WRO","_L","_LRO","_D"];o<a.length;o++){var u=a[o];t["".concat(e).concat(u)]=0,t["".concat(e,"V").concat(i).concat(u)]=0}}})),t},Nv=n(376);function Lv(t){return Lv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lv(t)}function Pv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Rv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pv(Object(n),!0).forEach((function(e){var r,i,o,a;r=t,i=e,o=n[e],a=function(t,e){if("object"!=Lv(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Lv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i),(i="symbol"==Lv(a)?a:String(a))in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}$t({apiKey:"AIzaSyDhTlQWHRKNVFaAAu8E4WTBdD8pdVsmyYU",authDomain:"lfc-website-31dd4.firebaseapp.com",projectId:"lfc-website-31dd4",storageBucket:"lfc-website-31dd4.appspot.com",messagingSenderId:"1082810451787",appId:"1:1082810451787:web:3c2467e3ae8a4ad8f8cace"});var Mv=function(t,e){var n,r,i,o="object"==fa(t)?t:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zt,e=Kt.get(t);if(!e&&t===zt&&m())return $t();if(!e)throw Yt.create("no-app",{appName:t});return e}(),a=(n=o,r="firestore",i=n.container.getProvider("heartbeat").getImmediate({optional:!0}),i&&i.triggerHeartbeat(),n.container.getProvider(r)).getImmediate({identifier:"(default)"});if(!a._initialized){var u=function(t){var e=function(t){var e,n;return null===(n=null===(e=g())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]}(t);if(e){var n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error("Invalid host ".concat(e," with no separate hostname and port!"));var r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]}}("firestore");u&&qd.apply(void 0,[a].concat(ca(u)))}return a}(),jv=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(t=I(t),Rd("collection","path",e),t instanceof Bd){var o=Qa.fromString.apply(Qa,[e].concat(r));return jd(o),new Kd(t,null,o)}if(!(t instanceof Gd||t instanceof Kd))throw new Da(Aa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var a=t._path.child(Qa.fromString.apply(Qa,[e].concat(r)));return jd(a),new Kd(t.firestore,null,a)}(Mv,"Fighters");(function(t){t=Vd(t,zd);var e=Vd(t.firestore,Qd),n=Wd(e),r=new Tv(e);return function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new Da(Aa.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query),function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Oa;return t.asyncQueue.enqueueAndForget(ra(ea().mark((function i(){return ea().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(t,e,n,r,i){var o=new wd({next:function(n){e.enqueueAndForget((function(){return Cf(t,a)})),n.fromCache&&"server"===r.source?i.reject(new Da(Aa.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),a=new Lf(n,o,{includeMetadataChanges:!0,Z_:!0});return xf(t,a)},i.next=3,Od(t);case 3:return i.t1=i.sent,i.t2=t.asyncQueue,i.t3=e,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}(n,t._query).then((function(n){return new _v(e,r,t,n)}))})(jv).then((function(t){var e=t.docs.map((function(t){return Rv(Rv({},t.data()),{},{id:t.id})}));(0,Nv.y)(e,1,15)})).catch((function(t){console.log(t.message)}));var Fv=document.querySelector(".add");Fv&&Fv.addEventListener("submit",(function(t){t.preventDefault();var e=Fv.name.value,n=Fv.nickname.value,r=Fv.img1.value,i=Fv.img2.value,o=Fv.img3.value,a=Fv.datacenter.value,u=Fv.world.value;!function(t,e,n,r,i,o,a,u){var s,c=new Date;if(-120!==c.getTimezoneOffset()){var l={formattedDate:(s=new Date(c.getTime()+60*c.getTimezoneOffset()*1e3+72e5)).toLocaleDateString("en-GB"),formattedTime:s.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1})},h=Av({regdate:l.formattedDate,regtime:l.formattedTime,name:e,nickname:n,img1:r,img2:i,img3:o,datacenter:a,world:u,rank:0,points:0,totalfights:0,wins:0,losses:0,draws:0},Ov());xv(t,h).then((function(){console.log("Document added successfully:",h)})).catch((function(t){console.error("Error adding document:",t)}))}else{var f=Ov(),d=Av({regdate:c.toLocaleDateString("en-GB"),regtime:c.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1}),name:e,nickname:n,img1:r,img2:i,img3:o,datacenter:a,world:u,rank:0,points:100,totalfights:0,wins:0,losses:0,draws:0},f);xv(t,d).then((function(){console.log("Document added successfully:",d)})).catch((function(t){console.error("Error adding document:",t)}))}}(jv,e,n,r,i,o,a,u)}))})()})();
//# sourceMappingURL=index.bundle.js.map